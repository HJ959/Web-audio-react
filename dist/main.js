/*! For license information please see main.js.LICENSE.txt */(()=>{var t={228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i;},t.exports.__esModule=!0,t.exports.default=t.exports;},858:t=>{t.exports=function(t){if(Array.isArray(t))return t;},t.exports.__esModule=!0,t.exports.default=t.exports;},575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function");},t.exports.__esModule=!0,t.exports.default=t.exports;},913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i);}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;},t.exports.__esModule=!0,t.exports.default=t.exports;},884:t=>{t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t;}finally{try{o||null==n.return||n.return();}finally{if(a)throw r;}}return s;}},t.exports.__esModule=!0,t.exports.default=t.exports;},521:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");},t.exports.__esModule=!0,t.exports.default=t.exports;},38:(t,e,n)=>{var i=n(858),r=n(884),s=n(379),o=n(521);t.exports=function(t,e){return i(t)||r(t,e)||s(t,e)||o();},t.exports.__esModule=!0,t.exports.default=t.exports;},379:(t,e,n)=>{var i=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0;}},t.exports.__esModule=!0,t.exports.default=t.exports;},718:t=>{"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1;}function s(t,e,i,s,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,s||t,o),h=n?n+e:e;return t._events[h]?t._events[h].fn?t._events[h]=[t._events[h],a]:t._events[h].push(a):(t._events[h]=a,t._eventsCount++),t;}function o(t,e){0==--t._eventsCount?t._events=new i():delete t._events[e];}function a(){this._events=new i(),this._eventsCount=0;}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r;},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,o=new Array(s);r<s;r++)o[r]=i[r].fn;return o;},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0;},a.prototype.emit=function(t,e,i,r,s,o){var a=n?n+t:t;if(!this._events[a])return!1;var h,u,l=this._events[a],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,r),!0;case 5:return l.fn.call(l.context,e,i,r,s),!0;case 6:return l.fn.call(l.context,e,i,r,s,o),!0;}for(u=1,h=new Array(c-1);u<c;u++)h[u-1]=arguments[u];l.fn.apply(l.context,h);}else{var d,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,r);break;default:if(!h)for(d=1,h=new Array(c-1);d<c;d++)h[d-1]=arguments[d];l[u].fn.apply(l[u].context,h);}}return!0;},a.prototype.on=function(t,e,n){return s(this,t,e,n,!1);},a.prototype.once=function(t,e,n){return s(this,t,e,n,!0);},a.prototype.removeListener=function(t,e,i,r){var s=n?n+t:t;if(!this._events[s])return this;if(!e)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==e||r&&!a.once||i&&a.context!==i||o(this,s);else{for(var h=0,u=[],l=a.length;h<l;h++)(a[h].fn!==e||r&&!a[h].once||i&&a[h].context!==i)&&u.push(a[h]);u.length?this._events[s]=1===u.length?u[0]:u:o(this,s);}return this;},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i(),this._eventsCount=0),this;},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a;},382:function(t,e,n){!function(t,e,n,i){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t};}var s=r(e),o=r(n),a=r(i),h=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t};},u=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t};},l=function(t,e){return{startTime:e,type:"setValue",value:t};},c=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t};},d=function(t,e,n){var i=n.startTime,r=n.target,s=n.timeConstant;return r+(e-r)*Math.exp((i-t)/s);},p=function(t){return"exponentialRampToValue"===t.type;},f=function(t){return"linearRampToValue"===t.type;},_=function(t){return p(t)||f(t);},m=function(t){return"setValue"===t.type;},g=function(t){return"setValueCurve"===t.type;},v=function t(e,n,i,r){var s=e[n];return void 0===s?r:_(s)||m(s)?s.value:g(s)?s.values[s.values.length-1]:d(i,t(e,n-1,s.startTime,r),s);},y=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:_(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,r)];},T=function(t){return"cancelAndHold"===t.type;},E=function(t){return"cancelScheduledValues"===t.type;},b=function(t){return T(t)||E(t)?t.cancelTime:p(t)||f(t)?t.endTime:t.startTime;},x=function(t,e,n,i){var r=i.endTime,s=i.value;return n===s?s:0<n&&0<s||n<0&&s<0?n*Math.pow(s/n,(t-e)/(r-e)):0;},A=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n);},R=function(t,e){var n=e.duration,i=e.startTime,r=e.values;return function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i];}(r,(t-i)/n*(r.length-1));},O=function(t){return"setTarget"===t.type;},S=function(t){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t;}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]();}},{key:"add",value:function(t){var e=b(t);if(T(t)||E(t)){var n=this._automationEvents.findIndex(function(n){return E(t)&&g(n)?n.startTime+n.duration>=e:b(n)>=e;}),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),T(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&_(i)){if(O(r))throw new Error("The internal list is malformed.");var s=g(r)?r.startTime+r.duration:b(r),o=g(r)?r.values[r.values.length-1]:r.value,a=p(i)?x(e,s,o,i):A(e,s,o,i),d=p(i)?h(a,e,this._currenTime):u(a,e,this._currenTime);this._automationEvents.push(d);}void 0!==r&&O(r)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==r&&g(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=c(new Float32Array([6,7]),r.startTime,e-r.startTime));}}else{var m=this._automationEvents.findIndex(function(t){return b(t)>e;}),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&b(v)+v.duration>e)return!1;var y=p(t)?h(t.value,t.endTime,this._currenTime):f(t)?u(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>b(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y);}}return!0;}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex(function(e){return b(e)>t;});if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];O(i)&&n.unshift(l(v(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n;}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex(function(e){return b(e)>t;}),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&O(r)&&(void 0===n||!_(n)||n.insertTime>t))return d(t,v(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&m(r)&&(void 0===n||!_(n)))return r.value;if(void 0!==r&&g(r)&&(void 0===n||!_(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?R(t,r):r.values[r.values.length-1];if(void 0!==r&&_(r)&&(void 0===n||!_(n)))return r.value;if(void 0!==n&&p(n)){var o=y(this._automationEvents,i,r,n,this._defaultValue),a=s.default(o,2),h=a[0],u=a[1];return x(t,h,u,n);}if(void 0!==n&&f(n)){var l=y(this._automationEvents,i,r,n,this._defaultValue),c=s.default(l,2),T=c[0],E=c[1];return A(t,T,E,n);}return this._defaultValue;}}]),e;}(Symbol.iterator);t.AutomationEventList=S,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"};},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"};},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t};},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t};},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"};},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=c,Object.defineProperty(t,"__esModule",{value:!0});}(e,n(38),n(575),n(913));},150:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(81),r=n.n(i),s=n(645),o=n.n(s)()(r());o.push([t.id,"* { margin: 0; padding: 0;}\r\n\r\nbody, html { height:100%; }\r\n\r\ncanvas {\r\n    position:absolute;\r\n    width:100%;\r\n    height:100%;\r\n}",""]);const a=o;},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n;}).join("");},e.i=function(t,n,i,r,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0);}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);i&&o[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),n&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=n):l[2]=n),r&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=r):l[4]="".concat(r)),e.push(l));}},e;};},81:t=>{"use strict";t.exports=function(t){return t[1];};},187:t=>{"use strict";function e(t,e,s){s=s||2;var o,a,h,c,d,f,_,m=e&&e.length,g=m?e[0]*s:t.length,v=n(t,0,g,s,!0),y=[];if(!v||v.next===v.prev)return y;if(m&&(v=function(t,e,r,s){var o,a,h,c=[];for(o=0,a=e.length;o<a;o++)(h=n(t,e[o]*s,o<a-1?e[o+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),c.push(p(h));for(c.sort(u),o=0;o<c.length;o++)r=i(r=l(c[o],r),r.next);return r;}(t,e,v,s)),t.length>80*s){o=h=t[0],a=c=t[1];for(var T=s;T<g;T+=s)(d=t[T])<o&&(o=d),(f=t[T+1])<a&&(a=f),d>h&&(h=d),f>c&&(c=f);_=0!==(_=Math.max(h-o,c-a))?1/_:0;}return r(v,y,s,o,a,_),y;}function n(t,e,n,i,r){var s,o;if(r===O(t,e,n,i)>0)for(s=e;s<n;s+=i)o=x(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=x(s,t[s],t[s+1],o);return o&&g(o,o.next)&&(A(o),o=o.next),o;}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!g(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(A(i),(i=e=i.prev)===i.next)break;n=!0;}}while(n||i!==e);return e;}function r(t,e,n,u,l,c,p){if(t){!p&&c&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,s,o,a,h,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(h=u;a>0||h>0&&i;)0!==a&&(0===h||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,h--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i;}s.nextZ=null,u*=2;}while(o>1);}(r);}(t,u,l,c);for(var f,_,m=t;t.prev!==t.next;)if(f=t.prev,_=t.next,c?o(t,u,l,c):s(t))e.push(f.i/n),e.push(t.i/n),e.push(_.i/n),A(t),t=_.next,m=_.next;else if((t=_)===m){p?1===p?r(t=a(i(t),e,n),e,n,u,l,c,2):2===p&&h(t,e,n,u,l,c):r(i(t),e,n,u,l,c,1);break;}}}function s(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(f(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&m(r.prev,r,r.next)>=0)return!1;r=r.next;}return!0;}function o(t,e,n,i){var r=t.prev,s=t,o=t.next;if(m(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,h=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,c=d(a,h,e,n,i),p=d(u,l,e,n,i),_=t.prevZ,g=t.nextZ;_&&_.z>=c&&g&&g.z<=p;){if(_!==t.prev&&_!==t.next&&f(r.x,r.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,g!==t.prev&&g!==t.next&&f(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ;}for(;_&&_.z>=c;){if(_!==t.prev&&_!==t.next&&f(r.x,r.y,s.x,s.y,o.x,o.y,_.x,_.y)&&m(_.prev,_,_.next)>=0)return!1;_=_.prevZ;}for(;g&&g.z<=p;){if(g!==t.prev&&g!==t.next&&f(r.x,r.y,s.x,s.y,o.x,o.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.nextZ;}return!0;}function a(t,e,n){var r=t;do{var s=r.prev,o=r.next.next;!g(s,o)&&v(s,r,r.next,o)&&E(s,o)&&E(o,s)&&(e.push(s.i/n),e.push(r.i/n),e.push(o.i/n),A(r),A(r.next),r=t=o),r=r.next;}while(r!==t);return i(r);}function h(t,e,n,s,o,a){var h=t;do{for(var u=h.next.next;u!==h.prev;){if(h.i!==u.i&&_(h,u)){var l=b(h,u);return h=i(h,h.next),l=i(l,l.next),r(h,e,n,s,o,a),void r(l,e,n,s,o,a);}u=u.next;}h=h.next;}while(h!==t);}function u(t,e){return t.x-e.x;}function l(t,e){var n=function(t,e){var n,i=e,r=t.x,s=t.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next;}n=i.x<i.next.x?i:i.next;}}i=i.next;}while(i!==e);if(!n)return null;if(r===o)return n;var h,u=n,l=n.x,d=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=l&&r!==i.x&&f(s<d?r:o,s,l,d,s<d?o:r,s,i.x,i.y)&&(h=Math.abs(s-i.y)/(r-i.x),E(i,t)&&(h<p||h===p&&(i.x>n.x||i.x===n.x&&c(n,i)))&&(n=i,p=h)),i=i.next;}while(i!==u);return n;}(t,e);if(!n)return e;var r=b(n,t),s=i(n,n.next);return i(r,r.next),e===n?s:e;}function c(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0;}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1;}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;}while(e!==t);return n;}function f(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0;}function _(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next;}while(n!==t);return!1;}(t,e)&&(E(t,e)&&E(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;}while(n!==t);return i;}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||g(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0);}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y);}function g(t,e){return t.x===e.x&&t.y===e.y;}function v(t,e,n,i){var r=T(m(t,e,n)),s=T(m(t,e,i)),o=T(m(n,i,t)),a=T(m(n,i,e));return r!==s&&o!==a||!(0!==r||!y(t,n,e))||!(0!==s||!y(t,i,e))||!(0!==o||!y(n,t,i))||!(0!==a||!y(n,e,i));}function y(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y);}function T(t){return t>0?1:t<0?-1:0;}function E(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0;}function b(t,e){var n=new R(t.i,t.x,t.y),i=new R(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i;}function x(t,e,n,i){var r=new R(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r;}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ);}function R(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}function O(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r;}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(O(t,0,s,n));if(r)for(var a=0,h=e.length;a<h;a++){var u=e[a]*n,l=a<h-1?e[a+1]*n:t.length;o-=Math.abs(O(t,u,l,n));}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*n,p=i[a+1]*n,f=i[a+2]*n;c+=Math.abs((t[d]-t[f])*(t[p+1]-t[d+1])-(t[d]-t[p])*(t[f+1]-t[d+1]));}return 0===o&&0===c?0:Math.abs((c-o)/o);},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i));}return n;};},418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function r(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t);}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t];}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(t){i[t]=t;}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("");}catch(t){return!1;}}()?Object.assign:function(t,s){for(var o,a,h=r(t),u=1;u<arguments.length;u++){for(var l in o=Object(arguments[u]))n.call(o,l)&&(h[l]=o[l]);if(e){a=e(o);for(var c=0;c<a.length;c++)i.call(o,a[c])&&(h[a[c]]=o[a[c]]);}}return h;};},587:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e);}t.exports=function(t,n,i,r){n=n||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var o=/\+/g;t=t.split(n);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var h=t.length;a>0&&h>a&&(h=a);for(var u=0;u<h;++u){var l,c,d,p,f=t[u].replace(o,"%20"),_=f.indexOf(i);_>=0?(l=f.substr(0,_),c=f.substr(_+1)):(l=f,c=""),d=decodeURIComponent(l),p=decodeURIComponent(c),e(s,d)?Array.isArray(s[d])?s[d].push(p):s[d]=[s[d],p]:s[d]=p;}return s;};},361:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return"";}};t.exports=function(t,n,i,r){return n=n||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(r){var s=encodeURIComponent(e(r))+i;return Array.isArray(t[r])?t[r].map(function(t){return s+encodeURIComponent(e(t));}).join(n):s+encodeURIComponent(e(t[r]));}).join(n):r?encodeURIComponent(e(r))+i+encodeURIComponent(e(t)):"";};},673:(t,e,n)=>{"use strict";e.decode=e.parse=n(587),e.encode=e.stringify=n(361);},994:t=>{"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break;}return n;}function i(t,i){for(var s={},o=[],a=0;a<t.length;a++){var h=t[a],u=i.base?h[0]+i.base:h[0],l=s[u]||0,c="".concat(u," ").concat(l);s[u]=l+1;var d=n(c),p={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=r(p,i);i.byIndex=a,e.splice(a,0,{identifier:c,updater:f,references:1});}o.push(c);}return o;}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e);}else n.remove();};}t.exports=function(t,r){var s=i(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--;}for(var h=i(t,r),u=0;u<s.length;u++){var l=n(s[u]);0===e[l].references&&(e[l].updater(),e.splice(l,1));}s=h;};};},569:t=>{"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head;}catch(t){n=null;}e[t]=n;}return e[t];}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n);};},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e;};},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e);};},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(i,t,e.options);}(e,t,n);},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);}(e);}};};},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t));}};},511:function(t,e,n){var i;t=n.nmd(t),function(r){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof n.g&&n.g;s.global!==s&&s.window!==s&&s.self;var o,a=2147483647,h=36,u=/^xn--/,l=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function _(t){throw RangeError(d[t]);}function m(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i;}function g(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+m((t=t.replace(c,".")).split("."),e).join(".");}function v(t){for(var e,n,i=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i;}function y(t){return m(t,function(t){var e="";return t>65535&&(e+=f((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+f(t);}).join("");}function T(t,e){return t+22+75*(t<26)-((0!=e)<<5);}function E(t,e,n){var i=0;for(t=n?p(t/700):t>>1,t+=p(t/e);t>455;i+=h)t=p(t/35);return p(i+36*t/(t+38));}function b(t){var e,n,i,r,s,o,u,l,c,d,f,m=[],g=t.length,v=0,T=128,b=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&_("not-basic"),m.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<g;){for(s=v,o=1,u=h;r>=g&&_("invalid-input"),((l=(f=t.charCodeAt(r++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:h)>=h||l>p((a-v)/o))&&_("overflow"),v+=l*o,!(l<(c=u<=b?1:u>=b+26?26:u-b));u+=h)o>p(a/(d=h-c))&&_("overflow"),o*=d;b=E(v-s,e=m.length+1,0==s),p(v/e)>a-T&&_("overflow"),T+=p(v/e),v%=e,m.splice(v++,0,T);}return y(m);}function x(t){var e,n,i,r,s,o,u,l,c,d,m,g,y,b,x,A=[];for(g=(t=v(t)).length,e=128,n=0,s=72,o=0;o<g;++o)(m=t[o])<128&&A.push(f(m));for(i=r=A.length,r&&A.push("-");i<g;){for(u=a,o=0;o<g;++o)(m=t[o])>=e&&m<u&&(u=m);for(u-e>p((a-n)/(y=i+1))&&_("overflow"),n+=(u-e)*y,e=u,o=0;o<g;++o)if((m=t[o])<e&&++n>a&&_("overflow"),m==e){for(l=n,c=h;!(l<(d=c<=s?1:c>=s+26?26:c-s));c+=h)x=l-d,b=h-d,A.push(f(T(d+x%b,0))),l=p(x/b);A.push(f(T(l,0))),s=E(n,y,i==r),n=0,++i;}++n,++e;}return A.join("");}o={version:"1.3.2",ucs2:{decode:v,encode:y},decode:b,encode:x,toASCII:function(t){return g(t,function(t){return l.test(t)?"xn--"+x(t):t;});},toUnicode:function(t){return g(t,function(t){return u.test(t)?b(t.slice(4).toLowerCase()):t;});}},void 0===(i=function(){return o;}.call(e,n,e,t))||(t.exports=i);}();},310:(t,e,n)=>{"use strict";var i=n(511),r=n(502);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null;}e.Qc=y,e.DB=function(t,e){return y(t,!1,!0).resolve(e);},e.WU=function(t){return r.isString(t)&&(t=y(t)),t instanceof s?t.format():s.prototype.format.call(t);};var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),c=["%","/","?",";","#"].concat(l),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(673);function y(t,e,n){if(t&&r.isObject(t)&&t instanceof s)return t;var i=new s();return i.parse(t,e,n),i;}s.prototype.parse=function(t,e,n){if(!r.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",u=t.split(a);u[0]=u[0].replace(/\\/g,"/");var y=t=u.join(a);if(y=y.trim(),!n&&1===t.split("#").length){var T=h.exec(y);if(T)return this.path=y,this.href=y,this.pathname=T[1],T[2]?(this.search=T[2],this.query=e?v.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this;}var E=o.exec(y);if(E){var b=(E=E[0]).toLowerCase();this.protocol=b,y=y.substr(E.length);}if(n||E||y.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===y.substr(0,2);!x||E&&m[E]||(y=y.substr(2),this.slashes=!0);}if(!m[E]&&(x||E&&!g[E])){for(var A,R,O=-1,S=0;S<d.length;S++)-1!==(I=y.indexOf(d[S]))&&(-1===O||I<O)&&(O=I);for(-1!==(R=-1===O?y.lastIndexOf("@"):y.lastIndexOf("@",O))&&(A=y.slice(0,R),y=y.slice(R+1),this.auth=decodeURIComponent(A)),O=-1,S=0;S<c.length;S++){var I;-1!==(I=y.indexOf(c[S]))&&(-1===O||I<O)&&(O=I);}-1===O&&(O=y.length),this.host=y.slice(0,O),y=y.slice(O),this.parseHost(),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w)for(var C=this.hostname.split(/\./),N=(S=0,C.length);S<N;S++){var M=C[S];if(M&&!M.match(p)){for(var P="",D=0,L=M.length;D<L;D++)M.charCodeAt(D)>127?P+="x":P+=M[D];if(!P.match(p)){var F=C.slice(0,S),U=C.slice(S+1),B=M.match(f);B&&(F.push(B[1]),U.unshift(B[2])),U.length&&(y="/"+U.join(".")+y),this.hostname=F.join(".");break;}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=i.toASCII(this.hostname));var G=this.port?":"+this.port:"",k=this.hostname||"";this.host=k+G,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y));}if(!_[b])for(S=0,N=l.length;S<N;S++){var X=l[S];if(-1!==y.indexOf(X)){var V=encodeURIComponent(X);V===X&&(V=escape(X)),y=y.split(X).join(V);}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var j=y.indexOf("?");if(-1!==j?(this.search=y.substr(j),this.query=y.substr(j+1),e&&(this.query=v.parse(this.query)),y=y.slice(0,j)):e&&(this.search="",this.query={}),y&&(this.pathname=y),g[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var Y=this.search||"";this.path=G+Y;}return this.href=this.format(),this;},s.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=v.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),e+s+(n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t);}))+(a=a.replace("#","%23"))+i;},s.prototype.resolve=function(t){return this.resolveObject(y(t,!1,!0)).format();},s.prototype.resolveObject=function(t){if(r.isString(t)){var e=new s();e.parse(t,!1,!0),t=e;}for(var n=new s(),i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a];}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var h=Object.keys(t),u=0;u<h.length;u++){var l=h[u];"protocol"!==l&&(n[l]=t[l]);}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;}if(t.protocol&&t.protocol!==n.protocol){if(!g[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var p=c[d];n[p]=t[p];}return n.href=n.format(),n;}if(n.protocol=t.protocol,t.host||m[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/");}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var _=n.pathname||"",v=n.search||"";n.path=_+v;}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n;}var y=n.pathname&&"/"===n.pathname.charAt(0),T=t.host||t.pathname&&"/"===t.pathname.charAt(0),E=T||y||n.host&&t.pathname,b=E,x=n.pathname&&n.pathname.split("/")||[],A=(f=t.pathname&&t.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===x[0]?x[0]=n.host:x.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),E=E&&(""===f[0]||""===x[0])),T)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,x=f;else if(f.length)x||(x=[]),x.pop(),x=x.concat(f),n.search=t.search,n.query=t.query;else if(!r.isNullOrUndefined(t.search))return A&&(n.hostname=n.host=x.shift(),(w=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=w.shift(),n.host=n.hostname=w.shift())),n.search=t.search,n.query=t.query,r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var R=x.slice(-1)[0],O=(n.host||t.host||x.length>1)&&("."===R||".."===R)||""===R,S=0,I=x.length;I>=0;I--)"."===(R=x[I])?x.splice(I,1):".."===R?(x.splice(I,1),S++):S&&(x.splice(I,1),S--);if(!E&&!b)for(;S--;S)x.unshift("..");!E||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),O&&"/"!==x.join("/").substr(-1)&&x.push("");var w,C=""===x[0]||x[0]&&"/"===x[0].charAt(0);return A&&(n.hostname=n.host=C?"":x.length?x.shift():"",(w=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=w.shift(),n.host=n.hostname=w.shift())),(E=E||n.host&&x.length)&&!C&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null),r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n;},s.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t);};},502:t=>{"use strict";t.exports={isString:function(t){return"string"==typeof t;},isObject:function(t){return"object"==typeof t&&null!==t;},isNull:function(t){return null===t;},isNullOrUndefined:function(t){return null==t;}};}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports;}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e;},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]});},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")();}catch(t){if("object"==typeof window)return window;}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.nc=void 0,(()=>{"use strict";var t=n(382);const e=new WeakSet(),i=new WeakMap(),r=new WeakMap(),s=new WeakMap(),o=new WeakMap(),a=new WeakMap(),h=new WeakMap(),u=new WeakMap(),l=new WeakMap(),c=new WeakMap(),d={construct:()=>d},p=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,f=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(p);for(;null!==r;){const t=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(s),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(p);}return[n.join(";"),i];},_=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.");},m=t=>{if(!(t=>{try{new new Proxy(t,d)();}catch{return!1;}return!0;})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.");},g=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n;},v=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i;},y=(t,e,n,i)=>{const r=g(t,e),s=v(r,t=>t[0]===n&&t[1]===i);return 0===r.size&&t.delete(e),s;},T=t=>g(h,t),E=t=>{if(e.has(t))throw new Error("The AudioNode is already stored.");e.add(t),T(t).forEach(t=>t(!0));},b=t=>"port"in t,x=t=>{if(!e.has(t))throw new Error("The AudioNode is not stored.");e.delete(t),T(t).forEach(t=>t(!1));},A=(t,e)=>{!b(t)&&e.every(t=>0===t.size)&&x(t);},R={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},O=(t,e)=>t.context===e,S=t=>{try{t.copyToChannel(new Float32Array(1),0,-1);}catch{return!1;}return!0;},I=()=>new DOMException("","IndexSizeError"),w=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n);}catch(t){if(12===t.code)throw I();throw t;}});},C={numberOfChannels:1},N=-34028234663852886e22,M=-N,P=t=>e.has(t),D={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},L=t=>g(i,t),F=t=>g(s,t),U=(t,e)=>{const{activeInputs:n}=L(t);n.forEach(n=>n.forEach(([n])=>{e.includes(t)||U(n,[...e,t]);}));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:b(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=F(t);void 0!==n&&n.activeInputs.forEach(([t])=>U(t,e));}P(t)&&x(t);},B=t=>{U(t.destination,[]);},G=t=>"context"in t,k=t=>G(t[0]),X=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.");}return t.add(e),!0;},V=(t,e,[n,i],r)=>{X(t,[e,n,i],t=>t[0]===e&&t[1]===n,r);},H=(t,[e,n,i],r)=>{const s=t.get(e);void 0===s?t.set(e,new Set([[n,i]])):X(s,[n,i],t=>t[0]===n,r);},j=t=>"inputs"in t,Y=(t,e,n,i)=>{if(j(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0];}return t.connect(e,n,i),[e,n,i];},W=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null;},z=(t,e)=>{if(!T(t).delete(e))throw new Error("Missing the expected event listener.");},q=(t,e,n)=>{const i=g(t,e),r=v(i,t=>t[0]===n);return 0===i.size&&t.delete(e),r;},Z=(t,e,n,i)=>{j(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i);},K=t=>g(r,t),$=t=>g(o,t),Q=t=>u.has(t),J=t=>!e.has(t),tt=(t,e)=>new Promise(n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),r=t.createBuffer(1,2,44100),s=r.getChannelData(0);s[0]=1,s[1]=1;const o=t.createBufferSource();o.buffer=r,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const r=i.inputBuffer.getChannelData(0);Array.prototype.some.call(r,t=>1===t)?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination);},o.start();}}),et=(t,e)=>{const n=new Map();for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1);}n.forEach((t,n)=>e(n,t));},nt=t=>"context"in t,it=t=>{const e=new Map();var n,i;t.connect=(i=t.connect.bind(t),(t,n=0,r=0)=>{const s=nt(t)?i(t,n,r):i(t,n),o=e.get(t);return void 0===o?e.set(t,[{input:r,output:n}]):o.every(t=>t.input!==r||t.output!==n)&&o.push({input:r,output:n}),s;}),t.disconnect=(n=t.disconnect,(i,r,s)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const r=n.filter(t=>t.output!==i);0===r.length?e.delete(t):e.set(t,r);}else if(e.has(i))if(void 0===r)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter(t=>t.output!==r&&(t.input!==s||void 0===s));0===n.length?e.delete(i):e.set(i,n);}}for(const[n,i]of e)i.forEach(e=>{nt(n)?t.connect(n,e.output,e.input):t.connect(n,e.output);});});},rt=(t,e,n,i,r)=>{const[s,o]=((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=L(e),o=W(r[i],t,n);return null===o?[y(s,t,n,i)[2],!1]:[o[2],!0];})(t,n,i,r);if(null!==s&&(z(t,s),!o||e||Q(t)||Z(K(t),K(n),i,r)),P(n)){const{activeInputs:t}=L(n);A(n,t);}},st=(t,e,n,i)=>{const[r,s]=((t,e,n)=>{const{activeInputs:i,passiveInputs:r}=F(e),s=W(i,t,n);return null===s?[q(r,t,n)[1],!1]:[s[2],!0];})(t,n,i);null!==r&&(z(t,r),!s||e||Q(t)||K(t).disconnect($(n),i));};class ot{constructor(t){this._map=new Map(t);}get size(){return this._map.size;}entries(){return this._map.entries();}forEach(t,e=null){return this._map.forEach((n,i)=>t.call(e,n,i,this));}get(t){return this._map.get(t);}has(t){return this._map.has(t);}keys(){return this._map.keys();}values(){return this._map.values();}}const at={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function ht(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(0===e[n].byteLength)e[n]=s.slice(r,r+128);else{const t=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t);}}}const ut=(t,e,n,i,r)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r);},lt=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],r="number"==typeof e?e:e[i];for(let e=0;e<r;e+=1)t.push(new Float32Array(128));n.push(t);}return n;},ct=async(t,e,n,i,r,s,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,h=i.channelCount*i.numberOfInputs,u=r.reduce((t,e)=>t+e,0),l=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===s)throw new Error("Missing the processor constructor.");const d=L(t),p=await((t,e)=>{const n=g(c,t),i=K(e);return g(n,i);})(n,t),f=lt(i.numberOfInputs,i.channelCount),_=lt(i.numberOfOutputs,r),m=Array.from(t.parameters.keys()).reduce((t,e)=>({...t,[e]:new Float32Array(128)}),{});for(let u=0;u<a;u+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)ht(e,f[t],n,n,u);void 0!==s.parameterDescriptors&&null!==e&&s.parameterDescriptors.forEach(({name:t},n)=>{ht(e,m,t,h+n,u);});for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<r[t];e+=1)0===_[t][e].byteLength&&(_[t][e]=new Float32Array(128));try{const t=f.map((t,e)=>0===d.activeInputs[e].size?[]:t),e=o(u/n.sampleRate,n.sampleRate,()=>p.process(t,_,m));if(null!==l)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<r[t];n+=1)ut(l,_[t],n,e+n,u);e+=r[t];}if(!e)break;}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break;}}return l;},dt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},pt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ft={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},_t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},mt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},gt=t=>{const{port1:e,port2:n}=new MessageChannel();return new Promise(i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i();};n.onmessage=()=>r();try{e.postMessage(t,[t]);}finally{r();}});},vt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},yt=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i;},Tt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Et={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},bt=()=>new DOMException("","InvalidStateError"),xt=()=>new DOMException("","InvalidAccessError"),At={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Rt=(t,e,n,i,r,s,o,a,h,u,l)=>{const c=u.length;let d=a;for(let a=0;a<c;a+=1){let c=n[0]*u[a];for(let e=1;e<r;e+=1){const i=d-e&h-1;c+=n[e]*s[i],c-=t[e]*o[i];}for(let t=r;t<i;t+=1)c+=n[t]*s[d-t&h-1];for(let n=r;n<e;n+=1)c-=t[n]*o[d-n&h-1];s[d]=u[a],o[d]=c,d=d+1&h-1,l[a]=c;}return d;},Ot={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},St=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return void 0!==n&&(n.catch(()=>{}),!0);}catch{}return!1;},It=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i);},wt=(t,e)=>{It(t,e,"channelCount"),It(t,e,"channelCountMode"),It(t,e,"channelInterpretation");},Ct=t=>"function"==typeof t.getFloatTimeDomainData,Nt=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i);},Mt=t=>{var e;t.start=(e=t.start,(n=0,i=0,r)=>{if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r);});},Pt=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n);});},Dt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Lt=(t,e)=>{const n=t.createBiquadFilter();return wt(n,e),Nt(n,e,"Q"),Nt(n,e,"detune"),Nt(n,e,"frequency"),Nt(n,e,"gain"),It(n,e,"type"),n;},Ft=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return wt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw bt();}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw bt();}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw bt();}});})(n),n;},Ut=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Bt=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return wt(n,e),Nt(n,e,"delayTime"),n;},Gt=(t,e)=>{const n=t.createGain();return wt(n,e),Nt(n,e,"gain"),n;};function kt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n];}function Xt(t,e){let n=[0,0];for(let s=t.length-1;s>=0;s-=1)r=e,n=[(i=n)[0]*r[0]-i[1]*r[1],i[0]*r[1]+i[1]*r[0]],n[0]+=t[s];var i,r;return n;}const Vt=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Ht=()=>new DOMException("","NotSupportedError"),jt={numberOfChannels:1},Yt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Wt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},zt={disableNormalization:!1},qt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Zt=()=>new DOMException("","UnknownError"),Kt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},$t=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),Qt=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0;},Jt=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:o}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(o)});},te=(t,e,n)=>{try{t.setValueAtTime(e,n);}catch(i){if(9!==i.code)throw i;te(t,e,n+1e-7);}},ee=t=>{const e=t.createOscillator();try{e.start(-1);}catch(t){return t instanceof RangeError;}return!1;},ne=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0;}catch{return!1;}},ie=t=>{const e=t.createOscillator();try{e.stop(-1);}catch(t){return t instanceof RangeError;}return!1;},re=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=t.disconnect,()=>{r.call(t,n),t.removeEventListener("ended",i);});var r;t.addEventListener("ended",i),Ut(t,n),t.stop=(e=>{let i=!1;return(r=0)=>{if(i)try{e.call(t,r);}catch{n.gain.setValueAtTime(0,r);}else e.call(t,r),i=!0;};})(t.stop);},se=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n);},oe=(t=>(e,n,[i,r,s],o)=>{t(e[r],[n,i,s],t=>t[0]===n&&t[1]===i,o);})(X),ae=(t=>(e,n,[i,r,s],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[r,n,s]])):t(a,[r,n,s],t=>t[0]===r&&t[1]===n,o);})(X),he=(t=>(e,n,i,r)=>t(e[r],t=>t[0]===n&&t[1]===i))(v),ue=new WeakMap(),le=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0;})(ue),ce=(de=new Map(),pe=new WeakMap(),(t,e)=>{const n=pe.get(t);if(void 0!==n)return n;const i=de.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(de.set(t,n),n.catch(()=>!1).then(e=>(de.delete(t),pe.set(t,e),e))):(pe.set(t,n),n);}catch{return pe.set(t,!1),!1;}});var de,pe;const fe="undefined"==typeof window?null:window,_e=((t,e)=>(n,i)=>{const r=n.createAnalyser();if(wt(r,i),!(i.maxDecibels>i.minDecibels))throw e();return It(r,i,"fftSize"),It(r,i,"maxDecibels"),It(r,i,"minDecibels"),It(r,i,"smoothingTimeConstant"),t(Ct,()=>Ct(r))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e;};})(r),r;})(ce,I),me=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer;})(L),ge=((t,e,n)=>async(i,r,s)=>{const o=t(i);await Promise.all(o.activeInputs.map((t,o)=>Array.from(t).map(async([t,a])=>{const h=e(t),u=await h.render(t,r),l=i.context.destination;n(t)||i===l&&n(i)||u.connect(s,a,o);})).reduce((t,e)=>[...t,...e],[]));})(L,me,Q),ve=((t,e,n)=>()=>{const i=new WeakMap();return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!O(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(s,e);}return i.set(s,o),await n(r,s,o),o;})(r,s);}};})(_e,K,ge),ye=(Te=a,t=>{const e=Te.get(t);if(void 0===e)throw bt();return e;});var Te;const Ee=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(fe),be=(t=>e=>null!==t&&e instanceof t)(Ee),xe=new WeakMap(),Ae=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap();}addEventListener(e,n,i){if(null!==n){let r=this._listeners.get(n);void 0===r&&(r=t(this,n),"function"==typeof n&&this._listeners.set(n,r)),this._nativeEventTarget.addEventListener(e,r,i);}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t);}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n);}})(se),Re=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(fe),Oe=(t=>e=>null!==t&&e instanceof t)(Re),Se=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(fe),Ie=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(fe),we=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(fe),Ce=((t,e,n,i,s,o,a,u,l,c,d,p,f,_,m,g)=>class extends c{constructor(e,i,s,o){super(s),this._context=e,this._nativeAudioNode=s;const a=d(e);p(a)&&!0!==n(tt,()=>tt(a,g))&&it(s),r.set(this,s),h.set(this,new Set()),"closed"!==e.state&&i&&E(this),t(this,o,s);}get channelCount(){return this._nativeAudioNode.channelCount;}set channelCount(t){this._nativeAudioNode.channelCount=t;}get channelCountMode(){return this._nativeAudioNode.channelCountMode;}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t;}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation;}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t;}get context(){return this._context;}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs;}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs;}connect(t,n=0,r=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();const h=d(this._context),u=m(h);if(f(t)||_(t))throw o();if(G(t)){const s=K(t);try{const e=Y(this._nativeAudioNode,s,n,r),i=J(this);(u||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&J(t)&&E(t);}catch(t){if(12===t.code)throw o();throw t;}if(e(this,t,n,r,u)){const e=l([this],t);et(e,i(u));}return t;}const c=$(t);if("playbackRate"===c.name&&1024===c.maxValue)throw a();try{this._nativeAudioNode.connect(c,n),(u||J(this))&&this._nativeAudioNode.disconnect(c,n);}catch(t){if(12===t.code)throw o();throw t;}if(((t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=F(e),{outputs:o}=L(t),a=T(t),h=o=>{const a=K(t),h=$(e);if(o){const e=q(s,t,n);V(r,t,e,!1),i||Q(t)||a.connect(h,n);}else{const e=((t,e,n)=>v(t,t=>t[0]===e&&t[1]===n))(r,t,n);H(s,e,!1),i||Q(t)||a.disconnect(h,n);}};return!!X(o,[e,n],t=>t[0]===e&&t[1]===n,!0)&&(a.add(h),P(t)?V(r,t,[n,h],!0):H(s,[t,n,h],!0),!0);})(this,t,n,u)){const e=l([this],t);et(e,i(u));}}disconnect(t,e,n){let i;const r=d(this._context),a=m(r);if(void 0===t)i=((t,e)=>{const n=L(t),i=[];for(const r of n.outputs)k(r)?rt(t,e,...r):st(t,e,...r),i.push(r[0]);return n.outputs.clear(),i;})(this,a);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=((t,e,n)=>{const i=L(t),r=[];for(const s of i.outputs)s[1]===n&&(k(s)?rt(t,e,...s):st(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r;})(this,a,t);}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(G(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(i=((t,e,n,i,r)=>{const s=L(t);return Array.from(s.outputs).filter(t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==r&&t[2]!==r)).map(n=>(k(n)?rt(t,e,...n):st(t,e,...n),s.outputs.delete(n),n[0]));})(this,a,t,e,n),0===i.length)throw o();}for(const t of i){const e=l([this],t);et(e,u);}}})((Ne=i,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set());Ne.set(t,{activeInputs:i,outputs:new Set(),passiveInputs:new WeakMap(),renderer:e});}),((t,e,n,i,r,s,o,a,h,u,l,c,d)=>{const p=new WeakMap();return(f,_,m,g,v)=>{const{activeInputs:T,passiveInputs:b}=s(_),{outputs:x}=s(f),R=a(f),O=s=>{const a=h(_),u=h(f);if(s){const e=y(b,f,m,g);t(T,f,e,!1),v||c(f)||n(u,a,m,g),d(_)&&E(_);}else{const t=i(T,f,m,g);e(b,g,t,!1),v||c(f)||r(u,a,m,g);const n=o(_);if(0===n)l(_)&&A(_,T);else{const t=p.get(_);void 0!==t&&clearTimeout(t),p.set(_,setTimeout(()=>{l(_)&&A(_,T);},1e3*n));}}};return!!u(x,[_,m,g],t=>t[0]===_&&t[1]===m&&t[2]===g,!0)&&(R.add(O),l(f)?t(T,f,[m,g,O],!0):e(b,g,[f,m,O],!0),!0);};})(oe,ae,Y,he,Z,L,le,T,K,X,P,Q,J),ce,((t,e,n,i,r,s)=>o=>(a,h)=>{const u=t.get(a);if(void 0===u){if(!o&&s(a)){const t=i(a),{outputs:s}=n(a);for(const n of s)if(k(n)){const r=i(n[0]);e(t,r,n[1],n[2]);}else{const e=r(n[0]);t.disconnect(e,n[1]);}}t.set(a,h);}else t.set(a,u+h);})(u,Z,L,K,$,P),I,xt,Ht,((t,e,n,i,r,s,o,a)=>(h,u)=>{const l=e.get(h);if(void 0===l)throw new Error("Missing the expected cycle count.");const c=s(h.context),d=a(c);if(l===u){if(e.delete(h),!d&&o(h)){const e=i(h),{outputs:s}=n(h);for(const n of s)if(k(n)){const r=i(n[0]);t(e,r,n[1],n[2]);}else{const t=r(n[0]);e.connect(t,n[1]);}}}else e.set(h,l-u);})(Y,u,L,K,$,ye,P,be),((t,e,n)=>function i(r,s){const o=G(s)?s:n(t,s);if((t=>"delayTime"in t)(o))return[];if(r[0]===o)return[r];if(r.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(t=>i([...r,o],t[0])).reduce((t,e)=>t.concat(e),[]);})(xe,L,g),Ae,ye,Oe,Se,Ie,be,we);var Ne;const Me=((t,e,n,i,r,s)=>class extends t{constructor(t,n){const o=r(t),a={...R,...n},h=i(o,a);super(t,!1,h,s(o)?e():null),this._nativeAnalyserNode=h;}get fftSize(){return this._nativeAnalyserNode.fftSize;}set fftSize(t){this._nativeAnalyserNode.fftSize=t;}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount;}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels;}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n();}get minDecibels(){return this._nativeAnalyserNode.minDecibels;}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n();}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant;}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t;}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t);}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t);}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t);}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t);}})(Ce,ve,I,_e,ye,be),Pe=new WeakSet(),De=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(fe),Le=(Fe=new Uint32Array(1),t=>(Fe[0]=t,Fe[0]));var Fe;const Ue=((t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const h=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<h&&t<l;t+=1)i[t]=u[t+o];},n.copyToChannel=(i,r,s=0)=>{const o=t(s),a=t(r);if(a>=n.numberOfChannels)throw e();const h=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<h&&t<l;t+=1)u[t+o]=i[t];};})(Le,I),Be=(t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o);})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const o=t(s),a=t(r);if(o<e.length)return n.call(e,i,a,o);})(e.copyToChannel);})(Le),Ge=((t,e,n,i,r,s,o,a)=>{let h=null;return class u{constructor(u){if(null===r)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:c,sampleRate:d}={...C,...u};null===h&&(h=new r(1,1,44100));const p=null!==i&&e(s,s)?new i({length:l,numberOfChannels:c,sampleRate:d}):h.createBuffer(c,l,d);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(o(p),w(p)):e(S,()=>S(p))||a(p),t.add(p),p;}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e);}};})(Pe,ce,Ht,De,Ee,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100});}catch{return!1;}return!0;})(De),Ue,Be),ke=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect();};n.addEventListener("ended",r);})(Gt),Xe=((t,e,n)=>async(i,r,s)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map(async([e,i])=>{const o=t(e),a=await o.render(e,r);n(e)||a.connect(s,i);}));})(me,F,Q),Ve=(t=>(e,n,i)=>t(n,e,i))(Xe),He=((t,e,n,i,r,s,o,a,h,u,l)=>(h,c)=>{const d=h.createBufferSource();return wt(d,c),Nt(d,c,"playbackRate"),It(d,c,"buffer"),It(d,c,"loop"),It(d,c,"loopEnd"),It(d,c,"loopStart"),e(n,()=>n(h))||(t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw bt();e.call(t,i,r,s),n=!0;};})(t.start);})(d),e(i,()=>i(h))||(t=>{t.start=(e=t.start,(n=0,i=0,r)=>{const s=t.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,r);});var e;})(d),e(r,()=>r(h))||u(d,h),e(s,()=>s(h))||Mt(d),e(o,()=>o(h))||l(d,h),e(a,()=>a(h))||Pt(d),t(h,d),d;})(ke,ce,t=>{const e=t.createBufferSource();e.start();try{e.start();}catch{return!0;}return!1;},t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1);}catch{return!1;}return!0;},t=>{const e=t.createBufferSource();e.start();try{e.stop();}catch{return!1;}return!0;},ee,ne,ie,0,(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",t=>()=>{const n=t.call(e);return n===i?null:n;},t=>n=>t.call(e,null===n?i:n));})(Jt),re),je=((t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer;})(F),Xe),Ye=((t,e,n,i,r)=>()=>{const s=new WeakMap();let o=null,a=null;return{set start(t){o=t;},set stop(t){a=t;},render(h,u){const l=s.get(u);return void 0!==l?Promise.resolve(l):(async(h,u)=>{let l=n(h);const c=O(l,u);if(!c){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(u,t),null!==o&&l.start(...o),null!==a&&l.stop(a);}return s.set(u,l),c?await t(u,h.playbackRate,l.playbackRate):await i(u,h.playbackRate,l.playbackRate),await r(h,u,l),l;})(h,u);}};})(Ve,He,K,je,ge),We=((e,n,i,r,s,o,a,h,u,l,c,d,p)=>(r,f,_,m=null,g=null)=>{const v=new t.AutomationEventList(_.defaultValue),y=f?(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t);}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t);}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:r}=n;e.setTargetAtTime(i,t,r);}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t);}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:r}=n;e.setValueCurveAtTime(r,i,t);}}}}))(v):null,T={get defaultValue(){return _.defaultValue;},get maxValue(){return null===m?_.maxValue:m;},get minValue(){return null===g?_.minValue:g;},get value(){return _.value;},set value(t){_.value=t,T.setValueAtTime(t,r.context.currentTime);},cancelAndHoldAtTime(t){if("function"==typeof _.cancelAndHoldAtTime)null===y&&v.flush(r.context.currentTime),v.add(s(t)),_.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(r.context.currentTime),v.add(s(t));const n=Array.from(v).pop();_.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?_.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?_.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?_.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&_.setValueCurveAtTime(n.values,n.startTime,n.duration));}return T;},cancelScheduledValues:t=>(null===y&&v.flush(r.context.currentTime),v.add(o(t)),_.cancelScheduledValues(t),T),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError();if(!Number.isFinite(e)||e<0)throw new RangeError();return null===y&&v.flush(r.context.currentTime),v.add(a(t,e)),_.exponentialRampToValueAtTime(t,e),T;},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(r.context.currentTime),v.add(h(t,e)),_.linearRampToValueAtTime(t,e),T),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(r.context.currentTime),v.add(u(t,e,n)),_.setTargetAtTime(t,e,n),T),setValueAtTime:(t,e)=>(null===y&&v.flush(r.context.currentTime),v.add(l(t,e)),_.setValueAtTime(t,e),T),setValueCurveAtTime(t,e,n){const i=t instanceof Float32Array?t:new Float32Array(t);if(null!==d&&"webkitAudioContext"===d.name){const t=e+n,s=r.context.sampleRate,o=Math.ceil(e*s),a=Math.floor(t*s),h=a-o,u=new Float32Array(h);for(let t=0;t<h;t+=1){const r=(i.length-1)/n*((o+t)/s-e),a=Math.floor(r),h=Math.ceil(r);u[t]=a===h?i[a]:(1-(r-a))*i[a]+(1-(h-r))*i[h];}null===y&&v.flush(r.context.currentTime),v.add(c(u,e,n)),_.setValueCurveAtTime(u,e,n);const l=a/s;l<t&&p(T,u[u.length-1],l),p(T,i[i.length-1],t);}else null===y&&v.flush(r.context.currentTime),v.add(c(i,e,n)),_.setValueCurveAtTime(i,e,n);return T;}};return i.set(T,_),n.set(T,r),e(T,y),T;})((ze=s,(t,e)=>{ze.set(t,{activeInputs:new Set(),passiveInputs:new WeakMap(),renderer:e});}),xe,o,0,t.createCancelAndHoldAutomationEvent,t.createCancelScheduledValuesAutomationEvent,t.createExponentialRampToValueAutomationEvent,t.createLinearRampToValueAutomationEvent,t.createSetTargetAutomationEvent,t.createSetValueAutomationEvent,t.createSetValueCurveAutomationEvent,Re,te);var ze;const qe=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const a=s(t),h={...D,...i},u=r(a,h),l=o(a),c=l?e():null;super(t,!1,u,c),this._audioBufferSourceNodeRenderer=c,this._isBufferNullified=!1,this._isBufferSet=null!==h.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,M,N);}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer;}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0;}}get loop(){return this._nativeAudioBufferSourceNode.loop;}set loop(t){this._nativeAudioBufferSourceNode.loop=t;}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd;}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t;}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart;}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t;}get onended(){return this._onended;}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n;}get playbackRate(){return this._playbackRate;}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){E(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),P(this)&&x(this);};this._nativeAudioBufferSourceNode.addEventListener("ended",t);}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t);}})(Ce,Ye,We,bt,He,ye,be,se),Ze=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,e){const n=s(t),i=o(n),h=r(n,e,i);super(t,!1,h,i?(t=>{const e=new WeakMap();return{render(n,i){const r=e.get(i);return void 0!==r?Promise.resolve(r):(async(n,i)=>{const r=i.destination;return e.set(i,r),await t(n,i,r),r;})(n,i);}};})(a):null),this._isNodeOfNativeOfflineAudioContext=i,this._nativeAudioDestinationNode=h;}get channelCount(){return this._nativeAudioDestinationNode.channelCount;}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t;}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode;}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t;}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount;}})(Ce,0,I,bt,((t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i;}catch{}r&&"explicit"!==s.channelCountMode&&(s.channelCountMode="explicit"),0===s.maxChannelCount&&Object.defineProperty(s,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",t=>()=>t.call(o),t=>e=>{t.call(o,e);try{s.channelCount=e;}catch(t){if(e>s.maxChannelCount)throw t;}}),e(o,"channelCountMode",t=>()=>t.call(o),t=>e=>{t.call(o,e),s.channelCountMode=e;}),e(o,"channelInterpretation",t=>()=>t.call(o),t=>e=>{t.call(o,e),s.channelInterpretation=e;}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o;})(Gt,Jt),ye,be,ge),Ke=((t,e,n,i,r)=>()=>{const s=new WeakMap();return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=O(h,a);if(!u){const t={Q:h.Q.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,gain:h.gain.value,type:h.type};h=e(a,t);}return s.set(a,h),u?(await t(a,o.Q,h.Q),await t(a,o.detune,h.detune),await t(a,o.frequency,h.frequency),await t(a,o.gain,h.gain)):(await i(a,o.Q,h.Q),await i(a,o.detune,h.detune),await i(a,o.frequency,h.frequency),await i(a,o.gain,h.gain)),await r(o,a,h),h;})(o,a);}};})(Ve,Lt,K,je,ge),$e=(t=>(e,n)=>t.set(e,n))(ue),Qe=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,i){const h=s(t),u={...dt,...i},l=r(h,u),c=o(h);super(t,!1,l,c?n():null),this._Q=e(this,c,l.Q,M,N),this._detune=e(this,c,l.detune,1200*Math.log2(M),-1200*Math.log2(M)),this._frequency=e(this,c,l.frequency,t.sampleRate/2,0),this._gain=e(this,c,l.gain,40*Math.log10(M),N),this._nativeBiquadFilterNode=l,a(this,1);}get detune(){return this._detune;}get frequency(){return this._frequency;}get gain(){return this._gain;}get Q(){return this._Q;}get type(){return this._nativeBiquadFilterNode.type;}set type(t){this._nativeBiquadFilterNode.type=t;}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n);}catch(t){if(11===t.code)throw i();throw t;}if(t.length!==e.length||e.length!==n.length)throw i();}})(Ce,We,Ke,xt,Lt,ye,be,$e),Je=((t,e)=>(n,i,r)=>{const s=new Set();return n.connect=(a=n.connect,(r,o=0,h=0)=>{const u=0===s.size;if(e(r))return a.call(n,r,o,h),t(s,[r,o,h],t=>t[0]===r&&t[1]===o&&t[2]===h,!0),u&&i(),r;a.call(n,r,o),t(s,[r,o],t=>t[0]===r&&t[1]===o,!0),u&&i();}),n.disconnect=(o=n.disconnect,(t,i,a)=>{const h=s.size>0;if(void 0===t)o.apply(n),s.clear();else if("number"==typeof t){o.call(n,t);for(const e of s)e[1]===t&&s.delete(e);}else{e(t)?o.call(n,t,i,a):o.call(n,t,i);for(const e of s)e[0]!==t||void 0!==i&&e[1]!==i||void 0!==a&&e[2]!==a||s.delete(e);}const u=0===s.size;h&&u&&r();}),n;var o,a;})(X,Se),tn=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t();}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t();}});const r=n.createBufferSource();e(i,()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)r.connect(i,0,e);},()=>r.disconnect(i));})(bt,Je),en=((t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,r),wt(r,i),r;})(Re,tn),nn=((t,e,n)=>()=>{const i=new WeakMap();return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!O(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(s,e);}return i.set(s,o),await n(r,s,o),o;})(r,s);}};})(en,K,ge),rn=((t,e,n,i,r)=>class extends t{constructor(t,s){const o=i(t),a={...pt,...s};super(t,!1,n(o,a),r(o)?e():null);}})(Ce,nn,en,ye,be),sn=((t,e,n)=>()=>{const i=new WeakMap();return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!O(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(s,e);}return i.set(s,o),await n(r,s,o),o;})(r,s);}};})(Ft,K,ge),on=((t,e,n,i,r,s)=>class extends t{constructor(t,s){const o=i(t),a=(t=>({...t,channelCount:t.numberOfOutputs}))({...ft,...s});super(t,!1,n(o,a),r(o)?e():null);}})(Ce,sn,Ft,ye,be),an=((t,e,n,i)=>(r,{offset:s,...o})=>{const a=r.createBuffer(1,2,44100),h=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(r,{...o,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,h.buffer=a,h.loop=!0;const c={get bufferSize(){},get channelCount(){return u.channelCount;},set channelCount(t){u.channelCount=t;},get channelCountMode(){return u.channelCountMode;},set channelCountMode(t){u.channelCountMode=t;},get channelInterpretation(){return u.channelInterpretation;},set channelInterpretation(t){u.channelInterpretation=t;},get context(){return u.context;},get inputs(){return[];},get numberOfInputs(){return h.numberOfInputs;},get numberOfOutputs(){return u.numberOfOutputs;},get offset(){return u.gain;},get onended(){return h.onended;},set onended(t){h.onended=t;},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2]),start(t=0){h.start.call(h,t);},stop(t=0){h.stop.call(h,t);}};return t(r,h),i(Ut(c,u),()=>h.connect(u),()=>h.disconnect(u));})(ke,He,Gt,Je),hn=((t,e,n,i,r)=>(s,o)=>{if(void 0===s.createConstantSource)return n(s,o);const a=s.createConstantSource();return wt(a,o),Nt(a,o,"offset"),e(i,()=>i(s))||Mt(a),e(r,()=>r(s))||Pt(a),t(s,a),a;})(ke,ce,an,ee,ie),un=((t,e,n,i,r)=>()=>{const s=new WeakMap();let o=null,a=null;return{set start(t){o=t;},set stop(t){a=t;},render(h,u){const l=s.get(u);return void 0!==l?Promise.resolve(l):(async(h,u)=>{let l=n(h);const c=O(l,u);if(!c){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(u,t),null!==o&&l.start(o),null!==a&&l.stop(a);}return s.set(u,l),c?await t(u,h.offset,l.offset):await i(u,h.offset,l.offset),await r(h,u,l),l;})(h,u);}};})(Ve,hn,K,je,ge),ln=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),h={..._t,...o},u=i(a,h),l=s(a),c=l?n():null;super(t,!1,u,c),this._constantSourceNodeRenderer=c,this._nativeConstantSourceNode=u,this._offset=e(this,l,u.offset,M,N),this._onended=null;}get offset(){return this._offset;}get onended(){return this._onended;}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n;}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){E(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),P(this)&&x(this);};this._nativeConstantSourceNode.addEventListener("ended",t);}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t);}})(Ce,We,un,hn,ye,be,se),cn=((t,e)=>(n,i)=>{const r=n.createConvolver();if(wt(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),It(r,i,"buffer"),i.channelCount>2)throw t();if(e(r,"channelCount",t=>()=>t.call(r),e=>n=>{if(n>2)throw t();return e.call(r,n);}),"max"===i.channelCountMode)throw t();return e(r,"channelCountMode",t=>()=>t.call(r),e=>n=>{if("max"===n)throw t();return e.call(r,n);}),r;})(Ht,Jt),dn=((t,e,n)=>()=>{const i=new WeakMap();return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!O(o,s)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(s,e);}return i.set(s,o),j(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o;})(r,s);}};})(cn,K,ge),pn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),h={...mt,...o},u=n(a,h);super(t,!1,u,r(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==h.buffer&&s(this,h.buffer.duration);}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer;}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0);}else this._isBufferNullified=!1,s(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration);}get normalize(){return this._nativeConvolverNode.normalize;}set normalize(t){this._nativeConvolverNode.normalize=t;}})(Ce,dn,cn,ye,be,$e),fn=((t,e,n,i,r)=>s=>{const o=new WeakMap();return{render(a,h){const u=o.get(h);return void 0!==u?Promise.resolve(u):(async(a,h)=>{let u=n(a);const l=O(u,h);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(h,t);}return o.set(h,u),l?await t(h,a.delayTime,u.delayTime):await i(h,a.delayTime,u.delayTime),await r(a,h,u),u;})(a,h);}};})(Ve,Bt,K,je,ge),_n=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const h=r(t),u={...vt,...a},l=i(h,u),c=s(h);super(t,!1,l,c?n(u.maxDelayTime):null),this._delayTime=e(this,c,l.delayTime),o(this,u.maxDelayTime);}get delayTime(){return this._delayTime;}})(Ce,We,fn,Bt,ye,be,$e),mn=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(wt(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return Nt(i,n,"attack"),Nt(i,n,"knee"),Nt(i,n,"ratio"),Nt(i,n,"release"),Nt(i,n,"threshold"),i;})(Ht),gn=((t,e,n,i,r)=>()=>{const s=new WeakMap();return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=O(h,a);if(!u){const t={attack:h.attack.value,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,knee:h.knee.value,ratio:h.ratio.value,release:h.release.value,threshold:h.threshold.value};h=e(a,t);}return s.set(a,h),u?(await t(a,o.attack,h.attack),await t(a,o.knee,h.knee),await t(a,o.ratio,h.ratio),await t(a,o.release,h.release),await t(a,o.threshold,h.threshold)):(await i(a,o.attack,h.attack),await i(a,o.knee,h.knee),await i(a,o.ratio,h.ratio),await i(a,o.release,h.release),await i(a,o.threshold,h.threshold)),await r(o,a,h),h;})(o,a);}};})(Ve,mn,K,je,ge),vn=((t,e,n,i,r,s,o,a)=>class extends t{constructor(t,r){const h=s(t),u={...Tt,...r},l=i(h,u),c=o(h);super(t,!1,l,c?n():null),this._attack=e(this,c,l.attack),this._knee=e(this,c,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,c,l.ratio),this._release=e(this,c,l.release),this._threshold=e(this,c,l.threshold),a(this,.006);}get attack(){return this._attack;}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount;}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,r();}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode;}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,r();}get knee(){return this._knee;}get ratio(){return this._ratio;}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction;}get release(){return this._release;}get threshold(){return this._threshold;}})(Ce,We,gn,mn,Ht,ye,be,$e),yn=((t,e,n,i,r)=>()=>{const s=new WeakMap();return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=O(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,gain:h.gain.value};h=e(a,t);}return s.set(a,h),u?await t(a,o.gain,h.gain):await i(a,o.gain,h.gain),await r(o,a,h),h;})(o,a);}};})(Ve,Gt,K,je,ge),Tn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),h={...Et,...o},u=i(a,h),l=s(a);super(t,!1,u,l?n():null),this._gain=e(this,l,u.gain,M,N);}get gain(){return this._gain;}})(Ce,We,yn,Gt,ye,be),En=((t,e,n,i)=>(r,s,{channelCount:o,channelCountMode:a,channelInterpretation:h,feedback:u,feedforward:l})=>{const c=Dt(s,r.sampleRate),d=u instanceof Float64Array?u:new Float64Array(u),p=l instanceof Float64Array?l:new Float64Array(l),f=d.length,_=p.length,m=Math.min(f,_);if(0===f||f>20)throw i();if(0===d[0])throw e();if(0===_||_>20)throw i();if(0===p[0])throw e();if(1!==d[0]){for(let t=0;t<_;t+=1)p[t]/=d[0];for(let t=1;t<f;t+=1)d[t]/=d[0];}const g=n(r,c,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=h;const v=[],y=[],T=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),T.push(e);}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),r=n.getChannelData(t);v[t]=Rt(d,f,p,_,m,y[t],T[t],v[t],32,i,r);}};const E=r.sampleRate/2;return Ut({get bufferSize(){return c;},get channelCount(){return g.channelCount;},set channelCount(t){g.channelCount=t;},get channelCountMode(){return g.channelCountMode;},set channelCountMode(t){g.channelCountMode=t;},get channelInterpretation(){return g.channelInterpretation;},set channelInterpretation(t){g.channelInterpretation=t;},get context(){return g.context;},get inputs(){return[g];},get numberOfInputs(){return g.numberOfInputs;},get numberOfOutputs(){return g.numberOfOutputs;},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const r=e.length;for(let t=0;t<r;t+=1){const r=-Math.PI*(e[t]/E),s=[Math.cos(r),Math.sin(r)],o=kt(Xt(p,s),Xt(d,s));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0]);}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g);})(xt,bt,Vt,Ht),bn=((t,e,n,i)=>r=>t(St,()=>St(r))?Promise.resolve(t(i,i)).then(t=>{if(!t){const t=n(r,512,0,1);r.oncomplete=()=>{t.onaudioprocess=null,t.disconnect();},t.onaudioprocess=()=>r.currentTime,t.connect(r.destination);}return r.startRendering();}):new Promise(t=>{const n=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer);},n.connect(r.destination),r.startRendering();}))(ce,Gt,Vt,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime);},n.startRendering();});})(Gt,Ee)),xn=((t,e,n,i,r)=>(s,o)=>{const a=new WeakMap();let h=null;return{render(u,l){const c=a.get(l);return void 0!==c?Promise.resolve(c):(async(u,l)=>{let c=null,d=e(u);const p=O(d,l);if(void 0===l.createIIRFilter?c=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=l.createIIRFilter(o,s)),a.set(l,null===c?d:c),null!==c){if(null===h){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(u.context.destination.channelCount,u.context.length,l.sampleRate);h=(async()=>(await i(u,t,t.destination),((t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),o=r.length,a=s.length,h=Math.min(o,a);if(1!==r[0]){for(let t=0;t<o;t+=1)s[t]/=r[0];for(let t=1;t<a;t+=1)r[t]/=r[0];}const u=new Float32Array(32),l=new Float32Array(32),c=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let e=0;e<d;e+=1){const n=t.getChannelData(e),i=c.getChannelData(e);u.fill(0),l.fill(0),Rt(r,o,s,a,h,u,l,0,32,n,i);}return c;})(await r(t),l,s,o)))();}const t=await h;return c.buffer=t,c.start(0),c;}return await i(u,l,d),d;})(u,l);}};})(He,K,Ee,ge,bn),An=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return wt(r,i),r;})(En),Rn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=i(t),h=r(a),u={...At,...o},l=e(a,h?null:t.baseLatency,u);super(t,!1,l,h?n(u.feedback,u.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw xt();return e.call(t,n,i,r);});})(l),this._nativeIIRFilterNode=l,s(this,1);}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n);}})(Ce,An,xn,ye,be,$e),On=((t,e,n,i,r,s,o,a)=>(h,u)=>{const l=u.listener,{forwardX:c,forwardY:d,forwardZ:p,positionX:f,positionY:_,positionZ:m,upX:g,upY:v,upZ:y}=void 0===l.forwardX?(()=>{const c=new Float32Array(1),d=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),p=o(u);let f=!1,_=[0,0,-1,0,1,0],m=[0,0,0];const g=()=>{if(f)return;f=!0;const t=i(u,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[s(t,c,0),s(t,c,1),s(t,c,2),s(t,c,3),s(t,c,4),s(t,c,5)];e.some((t,e)=>t!==_[e])&&(l.setOrientation(...e),_=e);const n=[s(t,c,6),s(t,c,7),s(t,c,8)];n.some((t,e)=>t!==m[e])&&(l.setPosition(...n),m=n);},d.connect(t);},v=t=>e=>{e!==_[t]&&(_[t]=e,l.setOrientation(..._));},y=t=>e=>{e!==m[t]&&(m[t]=e,l.setPosition(...m));},T=(e,i,s)=>{const o=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(d,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const l=t({context:h},p,o.offset,M,N);var c,f,_,m,v,y,T;return a(l,"value",t=>()=>t.call(l),t=>e=>{try{t.call(l,e);}catch(t){if(9!==t.code)throw t;}g(),p&&s(e);}),l.cancelAndHoldAtTime=(c=l.cancelAndHoldAtTime,p?()=>{throw r();}:(...t)=>{const e=c.apply(l,t);return g(),e;}),l.cancelScheduledValues=(f=l.cancelScheduledValues,p?()=>{throw r();}:(...t)=>{const e=f.apply(l,t);return g(),e;}),l.exponentialRampToValueAtTime=(_=l.exponentialRampToValueAtTime,p?()=>{throw r();}:(...t)=>{const e=_.apply(l,t);return g(),e;}),l.linearRampToValueAtTime=(m=l.linearRampToValueAtTime,p?()=>{throw r();}:(...t)=>{const e=m.apply(l,t);return g(),e;}),l.setTargetAtTime=(v=l.setTargetAtTime,p?()=>{throw r();}:(...t)=>{const e=v.apply(l,t);return g(),e;}),l.setValueAtTime=(y=l.setValueAtTime,p?()=>{throw r();}:(...t)=>{const e=y.apply(l,t);return g(),e;}),l.setValueCurveAtTime=(T=l.setValueCurveAtTime,p?()=>{throw r();}:(...t)=>{const e=T.apply(l,t);return g(),e;}),l;};return{forwardX:T(0,0,v(0)),forwardY:T(1,0,v(1)),forwardZ:T(2,-1,v(2)),positionX:T(6,0,y(0)),positionY:T(7,0,y(1)),positionZ:T(8,0,y(2)),upX:T(3,0,v(3)),upY:T(4,1,v(4)),upZ:T(5,0,v(5))};})():l;return{get forwardX(){return c;},get forwardY(){return d;},get forwardZ(){return p;},get positionX(){return f;},get positionY(){return _;},get positionZ(){return m;},get upX(){return g;},get upY(){return v;},get upZ(){return y;}};})(We,en,hn,Vt,Ht,$t,be,Jt),Sn=new WeakMap(),In=((t,e,n,i,r,s)=>class extends n{constructor(n,s){super(n),this._nativeContext=n,a.set(this,n),i(n)&&r.set(n,new Set()),this._destination=new t(this,s),this._listener=e(this,n),this._onstatechange=null;}get currentTime(){return this._nativeContext.currentTime;}get destination(){return this._destination;}get listener(){return this._listener;}get onstatechange(){return this._onstatechange;}set onstatechange(t){const e="function"==typeof t?s(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n;}get sampleRate(){return this._nativeContext.sampleRate;}get state(){return this._nativeContext.state;}})(Ze,On,Ae,be,Sn,se),wn=((t,e,n,i,r,s)=>(o,a)=>{const h=o.createOscillator();return wt(h,a),Nt(h,a,"detune"),Nt(h,a,"frequency"),void 0!==a.periodicWave?h.setPeriodicWave(a.periodicWave):It(h,a,"type"),e(n,()=>n(o))||Mt(h),e(i,()=>i(o))||s(h,o),e(r,()=>r(o))||Pt(h),t(o,h),h;})(ke,ce,ee,ne,ie,re),Cn=((t,e,n,i,r)=>()=>{const s=new WeakMap();let o=null,a=null,h=null;return{set periodicWave(t){o=t;},set start(t){a=t;},set stop(t){h=t;},render(u,l){const c=s.get(l);return void 0!==c?Promise.resolve(c):(async(u,l)=>{let c=n(u);const d=O(c,l);if(!d){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,periodicWave:null===o?void 0:o,type:c.type};c=e(l,t),null!==a&&c.start(a),null!==h&&c.stop(h);}return s.set(l,c),d?(await t(l,u.detune,c.detune),await t(l,u.frequency,c.frequency)):(await i(l,u.detune,c.detune),await i(l,u.frequency,c.frequency)),await r(u,l,c),c;})(u,l);}};})(Ve,wn,K,je,ge),Nn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,o){const a=r(t),h={...Yt,...o},u=n(a,h),l=s(a),c=l?i():null,d=t.sampleRate/2;super(t,!1,u,c),this._detune=e(this,l,u.detune,153600,-153600),this._frequency=e(this,l,u.frequency,d,-d),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=c,null!==this._oscillatorNodeRenderer&&void 0!==h.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave);}get detune(){return this._detune;}get frequency(){return this._frequency;}get onended(){return this._onended;}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n;}get type(){return this._nativeOscillatorNode.type;}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null);}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t);}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){E(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),P(this)&&x(this);};this._nativeOscillatorNode.addEventListener("ended",t);}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t);}})(Ce,We,wn,Cn,ye,be,se),Mn=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n);};})(He),Pn=((t,e,n,i,r)=>(s,{curve:o,oversample:a,...h})=>{const u=s.createWaveShaper(),l=s.createWaveShaper();wt(u,h),wt(l,h);const c=n(s,{...h,gain:1}),d=n(s,{...h,gain:-1}),p=n(s,{...h,gain:1}),f=n(s,{...h,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return u.channelCount;},set channelCount(t){c.channelCount=t,d.channelCount=t,u.channelCount=t,p.channelCount=t,l.channelCount=t,f.channelCount=t;},get channelCountMode(){return u.channelCountMode;},set channelCountMode(t){c.channelCountMode=t,d.channelCountMode=t,u.channelCountMode=t,p.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t;},get channelInterpretation(){return u.channelInterpretation;},set channelInterpretation(t){c.channelInterpretation=t,d.channelInterpretation=t,u.channelInterpretation=t,p.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t;},get context(){return u.context;},get curve(){return g;},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const r=Math.ceil((t+1)/2),s=(t+1)/2-1;for(let o=1;o<r;o+=1){const a=o/r*s,h=Math.floor(a),u=Math.ceil(a);e[o]=h===u?n[h]:(1-(a-h))*n[h]+(1-(u-a))*n[u],i[o]=h===u?-n[t-1-h]:-(1-(a-h))*n[t-1-h]-(1-(u-a))*n[t-1-u];}e[r]=t%2==1?n[r-1]:(n[r-2]+n[r-1])/2,u.curve=e,l.curve=i;}g=n,m&&(i(g)&&null===_?_=t(s,c):null!==_&&(_(),_=null));},get inputs(){return[c];},get numberOfInputs(){return u.numberOfInputs;},get numberOfOutputs(){return u.numberOfOutputs;},get oversample(){return u.oversample;},set oversample(t){u.oversample=t,l.oversample=t;},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2])};return null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a),r(Ut(v,p),()=>{c.connect(u).connect(p),c.connect(d).connect(l).connect(f).connect(p),m=!0,i(g)&&(_=t(s,c));},()=>{c.disconnect(u),u.disconnect(p),c.disconnect(d),d.disconnect(l),l.disconnect(f),f.disconnect(p),m=!1,null!==_&&(_(),_=null);});})(Mn,bt,Gt,Qt,Je),Dn=((t,e,n,i,r,s,o)=>(a,h)=>{const u=a.createWaveShaper();if(null!==s&&"webkitAudioContext"===s.name&&void 0===a.createGain().gain.automationRate)return n(a,h);wt(u,h);const l=null===h.curve||h.curve instanceof Float32Array?h.curve:new Float32Array(h.curve);if(null!==l&&l.length<2)throw e();It(u,{curve:l},"curve"),It(u,h,"oversample");let c=null,d=!1;return o(u,"curve",t=>()=>t.call(u),e=>n=>(e.call(u,n),d&&(i(n)&&null===c?c=t(a,u):i(n)||null===c||(c(),c=null)),n)),r(u,()=>{d=!0,i(u.curve)&&(c=t(a,u));},()=>{d=!1,null!==c&&(c(),c=null);});})(Mn,bt,Pn,Qt,Je,Re,Jt),Ln=((t,e,n,i,r,s,o,a,h,u)=>(l,{coneInnerAngle:c,coneOuterAngle:d,coneOuterGain:p,distanceModel:f,maxDistance:_,orientationX:m,orientationY:g,orientationZ:v,panningModel:y,positionX:T,positionY:E,positionZ:b,refDistance:x,rolloffFactor:A,...R})=>{const O=l.createPanner();if(R.channelCount>2)throw o();if("max"===R.channelCountMode)throw o();wt(O,R);const S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},I=n(l,{...S,channelInterpretation:"speakers",numberOfInputs:6}),w=i(l,{...R,gain:1}),C=i(l,{...S,gain:1}),N=i(l,{...S,gain:0}),M=i(l,{...S,gain:0}),P=i(l,{...S,gain:0}),D=i(l,{...S,gain:0}),L=i(l,{...S,gain:0}),F=r(l,256,6,1),U=s(l,{...S,curve:new Float32Array([1,1]),oversample:"none"});let B=[m,g,v],G=[T,E,b];const k=new Float32Array(1);F.onaudioprocess=({inputBuffer:t})=>{const e=[h(t,k,0),h(t,k,1),h(t,k,2)];e.some((t,e)=>t!==B[e])&&(O.setOrientation(...e),B=e);const n=[h(t,k,3),h(t,k,4),h(t,k,5)];n.some((t,e)=>t!==G[e])&&(O.setPosition(...n),G=n);},Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(L.gain,"defaultValue",{get:()=>0});const X={get bufferSize(){},get channelCount(){return O.channelCount;},set channelCount(t){if(t>2)throw o();w.channelCount=t,O.channelCount=t;},get channelCountMode(){return O.channelCountMode;},set channelCountMode(t){if("max"===t)throw o();w.channelCountMode=t,O.channelCountMode=t;},get channelInterpretation(){return O.channelInterpretation;},set channelInterpretation(t){w.channelInterpretation=t,O.channelInterpretation=t;},get coneInnerAngle(){return O.coneInnerAngle;},set coneInnerAngle(t){O.coneInnerAngle=t;},get coneOuterAngle(){return O.coneOuterAngle;},set coneOuterAngle(t){O.coneOuterAngle=t;},get coneOuterGain(){return O.coneOuterGain;},set coneOuterGain(t){if(t<0||t>1)throw e();O.coneOuterGain=t;},get context(){return O.context;},get distanceModel(){return O.distanceModel;},set distanceModel(t){O.distanceModel=t;},get inputs(){return[w];},get maxDistance(){return O.maxDistance;},set maxDistance(t){if(t<0)throw new RangeError();O.maxDistance=t;},get numberOfInputs(){return O.numberOfInputs;},get numberOfOutputs(){return O.numberOfOutputs;},get orientationX(){return C.gain;},get orientationY(){return N.gain;},get orientationZ(){return M.gain;},get panningModel(){return O.panningModel;},set panningModel(t){O.panningModel=t;},get positionX(){return P.gain;},get positionY(){return D.gain;},get positionZ(){return L.gain;},get refDistance(){return O.refDistance;},set refDistance(t){if(t<0)throw new RangeError();O.refDistance=t;},get rolloffFactor(){return O.rolloffFactor;},set rolloffFactor(t){if(t<0)throw new RangeError();O.rolloffFactor=t;},addEventListener:(...t)=>w.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>w.dispatchEvent(t[0]),removeEventListener:(...t)=>w.removeEventListener(t[0],t[1],t[2])};return c!==X.coneInnerAngle&&(X.coneInnerAngle=c),d!==X.coneOuterAngle&&(X.coneOuterAngle=d),p!==X.coneOuterGain&&(X.coneOuterGain=p),f!==X.distanceModel&&(X.distanceModel=f),_!==X.maxDistance&&(X.maxDistance=_),m!==X.orientationX.value&&(X.orientationX.value=m),g!==X.orientationY.value&&(X.orientationY.value=g),v!==X.orientationZ.value&&(X.orientationZ.value=v),y!==X.panningModel&&(X.panningModel=y),T!==X.positionX.value&&(X.positionX.value=T),E!==X.positionY.value&&(X.positionY.value=E),b!==X.positionZ.value&&(X.positionZ.value=b),x!==X.refDistance&&(X.refDistance=x),A!==X.rolloffFactor&&(X.rolloffFactor=A),1===B[0]&&0===B[1]&&0===B[2]||O.setOrientation(...B),0===G[0]&&0===G[1]&&0===G[2]||O.setPosition(...G),u(Ut(X,O),()=>{w.connect(O),t(w,U,0,0),U.connect(C).connect(I,0,0),U.connect(N).connect(I,0,1),U.connect(M).connect(I,0,2),U.connect(P).connect(I,0,3),U.connect(D).connect(I,0,4),U.connect(L).connect(I,0,5),I.connect(F).connect(l.destination);},()=>{w.disconnect(O),a(w,U,0,0),U.disconnect(C),C.disconnect(I),U.disconnect(N),N.disconnect(I),U.disconnect(M),M.disconnect(I),U.disconnect(P),P.disconnect(I),U.disconnect(D),D.disconnect(I),U.disconnect(L),L.disconnect(I),I.disconnect(F),F.disconnect(l.destination);});})(Y,bt,en,Gt,Vt,Dn,Ht,Z,$t,Je),Fn=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(wt(i,n),Nt(i,n,"orientationX"),Nt(i,n,"orientationY"),Nt(i,n,"orientationZ"),Nt(i,n,"positionX"),Nt(i,n,"positionY"),Nt(i,n,"positionZ"),It(i,n,"coneInnerAngle"),It(i,n,"coneOuterAngle"),It(i,n,"coneOuterGain"),It(i,n,"distanceModel"),It(i,n,"maxDistance"),It(i,n,"panningModel"),It(i,n,"refDistance"),It(i,n,"rolloffFactor"),i);})(Ln),Un=((t,e,n,i,r,s,o,a,h,u)=>()=>{const l=new WeakMap();let c=null;return{render(d,p){const f=l.get(p);return void 0!==f?Promise.resolve(f):(async(d,p)=>{let f=null,_=s(d);const m={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},g={...m,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},v=O(_,p);if("bufferSize"in _)f=i(p,{...m,gain:1});else if(!v){const t={...g,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=r(p,t);}if(l.set(p,null===f?_:f),null!==f){if(null===c){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,d.context.length,p.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),c=(async()=>{const e=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(e,i)=>{const r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,r.offset),r;}));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return u(t);})();}const t=await c,s=i(p,{...m,gain:1});await h(d,p,s);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let _=[l[0][0],l[1][0],l[2][0]],v=[l[3][0],l[4][0],l[5][0]],y=i(p,{...m,gain:1}),T=r(p,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]});s.connect(y).connect(T.inputs[0]),T.connect(f);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some((t,e)=>t!==_[e])||n.some((t,e)=>t!==v[e])){_=t,v=n;const o=e/p.sampleRate;y.gain.setValueAtTime(0,o),y=i(p,{...m,gain:0}),T=r(p,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),y.gain.setValueAtTime(1,o),s.connect(y).connect(T.inputs[0]),T.connect(f);}}return f;}return v?(await t(p,d.orientationX,_.orientationX),await t(p,d.orientationY,_.orientationY),await t(p,d.orientationZ,_.orientationZ),await t(p,d.positionX,_.positionX),await t(p,d.positionY,_.positionY),await t(p,d.positionZ,_.positionZ)):(await a(p,d.orientationX,_.orientationX),await a(p,d.orientationY,_.orientationY),await a(p,d.orientationZ,_.orientationZ),await a(p,d.positionX,_.positionX),await a(p,d.positionY,_.positionY),await a(p,d.positionZ,_.positionZ)),j(_)?await h(d,p,_.inputs[0]):await h(d,p,_),_;})(d,p);}};})(Ve,en,hn,Gt,Fn,K,Ee,je,ge,bn),Bn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,a){const h=r(t),u={...Wt,...a},l=n(h,u),c=s(h);super(t,!1,l,c?i():null),this._nativePannerNode=l,this._orientationX=e(this,c,l.orientationX,M,N),this._orientationY=e(this,c,l.orientationY,M,N),this._orientationZ=e(this,c,l.orientationZ,M,N),this._positionX=e(this,c,l.positionX,M,N),this._positionY=e(this,c,l.positionY,M,N),this._positionZ=e(this,c,l.positionZ,M,N),o(this,1);}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle;}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t;}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle;}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t;}get coneOuterGain(){return this._nativePannerNode.coneOuterGain;}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t;}get distanceModel(){return this._nativePannerNode.distanceModel;}set distanceModel(t){this._nativePannerNode.distanceModel=t;}get maxDistance(){return this._nativePannerNode.maxDistance;}set maxDistance(t){this._nativePannerNode.maxDistance=t;}get orientationX(){return this._orientationX;}get orientationY(){return this._orientationY;}get orientationZ(){return this._orientationZ;}get panningModel(){return this._nativePannerNode.panningModel;}set panningModel(t){this._nativePannerNode.panningModel=t;}get positionX(){return this._positionX;}get positionY(){return this._positionY;}get positionZ(){return this._positionZ;}get refDistance(){return this._nativePannerNode.refDistance;}set refDistance(t){this._nativePannerNode.refDistance=t;}get rolloffFactor(){return this._nativePannerNode.rolloffFactor;}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t;}})(Ce,We,Fn,Un,ye,be,$e),Gn=(t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),o=r instanceof Float32Array?r:new Float32Array(r),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a;})(I),kn=((t,e,n,i)=>class i{constructor(i,r){const s=e(i),o=(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n};})({...zt,...r}),a=t(s,o);return n.add(a),a;}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t);}})(Gn,ye,new WeakSet()),Xn=((t,e,n,i,r,s)=>{const o=16385,a=new Float32Array([1,1]),h=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},c=(t,s,c,d,p)=>{if(1===s)return((t,e,r,s)=>{const c=new Float32Array(o),d=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*h;c[t]=Math.cos(e),d[t]=Math.sin(e);}const p=n(t,{...u,gain:0}),f=i(t,{...l,curve:c}),_=i(t,{...l,curve:a}),m=n(t,{...u,gain:0}),g=i(t,{...l,curve:d});return{connectGraph(){e.connect(p),e.connect(void 0===_.inputs?_:_.inputs[0]),e.connect(m),_.connect(r),r.connect(void 0===f.inputs?f:f.inputs[0]),r.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(p.gain),g.connect(m.gain),p.connect(s,0,0),m.connect(s,0,1);},disconnectGraph(){e.disconnect(p),e.disconnect(void 0===_.inputs?_:_.inputs[0]),e.disconnect(m),_.disconnect(r),r.disconnect(void 0===f.inputs?f:f.inputs[0]),r.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(p.gain),g.disconnect(m.gain),p.disconnect(s,0,0),m.disconnect(s,0,1);}};})(t,c,d,p);if(2===s)return((t,r,s,c)=>{const d=new Float32Array(o),p=new Float32Array(o),f=new Float32Array(o),_=new Float32Array(o),m=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>m){const e=(t-m)/(16384-m)*h;d[t]=Math.cos(e),p[t]=Math.sin(e),f[t]=0,_[t]=1;}else{const e=t/(16384-m)*h;d[t]=1,p[t]=0,f[t]=Math.cos(e),_[t]=Math.sin(e);}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...u,gain:0}),y=i(t,{...l,curve:d}),T=n(t,{...u,gain:0}),E=i(t,{...l,curve:p}),b=i(t,{...l,curve:a}),x=n(t,{...u,gain:0}),A=i(t,{...l,curve:f}),R=n(t,{...u,gain:0}),O=i(t,{...l,curve:_});return{connectGraph(){r.connect(g),r.connect(void 0===b.inputs?b:b.inputs[0]),g.connect(v,0),g.connect(T,0),g.connect(x,1),g.connect(R,1),b.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===E.inputs?E:E.inputs[0]),s.connect(void 0===A.inputs?A:A.inputs[0]),s.connect(void 0===O.inputs?O:O.inputs[0]),y.connect(v.gain),E.connect(T.gain),A.connect(x.gain),O.connect(R.gain),v.connect(c,0,0),x.connect(c,0,0),T.connect(c,0,1),R.connect(c,0,1);},disconnectGraph(){r.disconnect(g),r.disconnect(void 0===b.inputs?b:b.inputs[0]),g.disconnect(v,0),g.disconnect(T,0),g.disconnect(x,1),g.disconnect(R,1),b.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===E.inputs?E:E.inputs[0]),s.disconnect(void 0===A.inputs?A:A.inputs[0]),s.disconnect(void 0===O.inputs?O:O.inputs[0]),y.disconnect(v.gain),E.disconnect(T.gain),A.disconnect(x.gain),O.disconnect(R.gain),v.disconnect(c,0,0),x.disconnect(c,0,0),T.disconnect(c,0,1),R.disconnect(c,0,1);}};})(t,c,d,p);throw r();};return(e,{channelCount:i,channelCountMode:o,pan:a,...h})=>{if("max"===o)throw r();const u=t(e,{...h,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...h,channelCount:i,channelCountMode:o,gain:1}),d=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:p,disconnectGraph:f}=c(e,i,l,d,u);Object.defineProperty(d.gain,"defaultValue",{get:()=>0}),Object.defineProperty(d.gain,"maxValue",{get:()=>1}),Object.defineProperty(d.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return l.channelCount;},set channelCount(t){l.channelCount!==t&&(m&&f(),({connectGraph:p,disconnectGraph:f}=c(e,t,l,d,u)),m&&p()),l.channelCount=t;},get channelCountMode(){return l.channelCountMode;},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();l.channelCountMode=t;},get channelInterpretation(){return l.channelInterpretation;},set channelInterpretation(t){l.channelInterpretation=t;},get context(){return l.context;},get inputs(){return[l];},get numberOfInputs(){return l.numberOfInputs;},get numberOfOutputs(){return l.numberOfOutputs;},get pan(){return d.gain;},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return s(Ut(_,u),()=>{p(),m=!0;},()=>{f(),m=!1;});};})(en,Ft,Gt,Dn,Ht,Je),Vn=((t,e)=>(n,i)=>{const r=i.channelCountMode;if("clamped-max"===r)throw e();if(void 0===n.createStereoPanner)return t(n,i);const s=n.createStereoPanner();return wt(s,i),Nt(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:t=>{if(t!==r)throw e();}}),s;})(Xn,Ht),Hn=((t,e,n,i,r)=>()=>{const s=new WeakMap();return{render(o,a){const h=s.get(a);return void 0!==h?Promise.resolve(h):(async(o,a)=>{let h=n(o);const u=O(h,a);if(!u){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,pan:h.pan.value};h=e(a,t);}return s.set(a,h),u?await t(a,o.pan,h.pan):await i(a,o.pan,h.pan),j(h)?await r(o,a,h.inputs[0]):await r(o,a,h),h;})(o,a);}};})(Ve,Vn,K,je,ge),jn=((t,e,n,i,r,s)=>class extends t{constructor(t,o){const a=r(t),h={...qt,...o},u=n(a,h),l=s(a);super(t,!1,u,l?i():null),this._pan=e(this,l,u.pan);}get pan(){return this._pan;}})(Ce,We,Vn,Hn,ye,be),Yn=((t,e,n)=>()=>{const i=new WeakMap();return{render(r,s){const o=i.get(s);return void 0!==o?Promise.resolve(o):(async(r,s)=>{let o=e(r);if(!O(o,s)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(s,e);}return i.set(s,o),j(o)?await n(r,s,o.inputs[0]):await n(r,s,o),o;})(r,s);}};})(Dn,K,ge),Wn=((t,e,n,i,r,s,o)=>class extends t{constructor(t,e){const a=r(t),h={...Kt,...e},u=n(a,h);super(t,!0,u,s(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=u,o(this,1);}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve;}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t;}}get oversample(){return this._nativeWaveShaperNode.oversample;}set oversample(t){this._nativeWaveShaperNode.oversample=t;}})(Ce,bt,Dn,Yn,ye,be,$e),zn=(t=>null!==t&&t.isSecureContext)(fe),qn=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i();}finally{null!==t&&(delete t.currentFrame,delete t.currentTime);}})(fe),Zn=new WeakMap(),Kn=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i;})(Zn,Ee),$n=zn?((t,e,n,i,r,s,o,a,h,u,c,d,p)=>{let g=0;return(v,y,T={credentials:"omit"})=>{const E=c.get(v);if(void 0!==E&&E.has(y))return Promise.resolve();const b=u.get(v);if(void 0!==b){const t=b.get(y);if(void 0!==t)return t;}const x=s(v),A=void 0===x.audioWorklet?r(y).then(([t,e])=>{const[i,r]=f(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${r}\n})})(window,'_AWGS')`);}).then(()=>{const t=p._AWGS.pop();if(void 0===t)throw new SyntaxError();i(x.currentTime,x.sampleRate,()=>t(class{},void 0,(t,n)=>{if(""===t.trim())throw e();const i=l.get(x);if(void 0!==i){if(i.has(t))throw e();m(n),_(n.parameterDescriptors),i.set(t,n);}else m(n),_(n.parameterDescriptors),l.set(x,new Map([[t,n]]));},x.sampleRate,void 0,void 0));}):Promise.all([r(y),Promise.resolve(t(d,d))]).then(([[t,e],n])=>{const i=g+1;g=i;const[r,s]=f(t,e),u=new Blob([`${r};((AudioWorkletProcessor,registerProcessor)=>{${s}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(u);return x.audioWorklet.addModule(l,T).then(()=>{if(a(x))return x;const t=o(x);return t.audioWorklet.addModule(l,T).then(()=>t);}).then(t=>{if(null===h)throw new SyntaxError();try{new h(t,`__sac${i}`);}catch{throw new SyntaxError();}}).finally(()=>URL.revokeObjectURL(l));});return void 0===b?u.set(v,new Map([[y,A]])):b.set(y,A),A.then(()=>{const t=c.get(v);void 0===t?c.set(v,new Set([y])):t.add(y);}).finally(()=>{const t=u.get(v);void 0!==t&&t.delete(y);}),A;};})(ce,Ht,(t=>e=>new Promise((n,i)=>{if(null===t)return void i(new SyntaxError());const r=t.document.head;if(null===r)i(new SyntaxError());else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),h=t.onerror,u=()=>{t.onerror=h,URL.revokeObjectURL(a);};t.onerror=(e,n,r,s,o)=>n===a||n===t.location.href&&1===r&&1===s?(u(),i(o),!1):null!==h?h(e,n,r,s,o):void 0,s.onerror=()=>{u(),i(new SyntaxError());},s.onload=()=>{u(),n();},s.src=a,s.type="module",r.appendChild(s);}}))(fe),qn,async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url];}catch{}throw new DOMException("","AbortError");},ye,Kn,be,we,new WeakMap(),new WeakMap(),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,o=!1;try{await i.audioWorklet.addModule(r);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>s=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering();}catch{}finally{URL.revokeObjectURL(r);}return s&&!o;})(we,Ee),fe):void 0,Qn=((t,e)=>n=>t(n)||e(n))(Oe,be),Jn=((t,e,n,i,r,s,o,a,h,u,l)=>(n,i)=>{const c=o(n)?n:s(n);if(r.has(i)){const t=new DOMException("","DataCloneError");return Promise.reject(t);}try{r.add(i);}catch{}return e(h,()=>h(c))?c.decodeAudioData(i).then(n=>(gt(i).catch(()=>{}),e(a,()=>a(n))||l(n),t.add(n),n)):new Promise((e,n)=>{const r=async()=>{try{await gt(i);}catch{}},s=t=>{n(t),r();};try{c.decodeAudioData(i,n=>{"function"!=typeof n.copyFromChannel&&(u(n),w(n)),t.add(n),r().then(()=>e(n));},t=>{s(null===t?new DOMException("","EncodingError"):t);});}catch(t){s(t);}});})(Pe,ce,0,0,new WeakSet(),ye,Qn,S,St,Ue,Be),ti=((t,e,n,i,r,s,o,a,h,u,l,c,d,p,f,_,m,g,v,y)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)};}get audioWorklet(){return this._audioWorklet;}createAnalyser(){return new e(this);}createBiquadFilter(){return new r(this);}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i});}createBufferSource(){return new i(this);}createChannelMerger(t=6){return new s(this,{numberOfInputs:t});}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t});}createConstantSource(){return new a(this);}createConvolver(){return new h(this);}createDelay(t=1){return new l(this,{maxDelayTime:t});}createDynamicsCompressor(){return new c(this);}createGain(){return new d(this);}createIIRFilter(t,e){return new p(this,{feedback:e,feedforward:t});}createOscillator(){return new _(this);}createPanner(){return new m(this);}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t});}createStereoPanner(){return new v(this);}createWaveShaper(){return new y(this);}decodeAudioData(t,e,n){return u(this._nativeContext,t).then(t=>("function"==typeof e&&e(t),t),t=>{throw"function"==typeof n&&n(t),t;});}})($n,Me,Ge,qe,Qe,rn,on,ln,pn,Jn,_n,vn,Tn,Rn,In,Nn,Bn,kn,jn,Wn),ei=((t,e,n,i)=>class extends t{constructor(t,e){const r=n(t),s=((t,e)=>t.createMediaElementSource(e.mediaElement))(r,e);if(i(r))throw TypeError();super(t,!0,s,null),this._nativeMediaElementAudioSourceNode=s;}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement;}})(Ce,0,ye,be),ni=((t,e,n,i)=>class extends t{constructor(t,e){const r=n(t);if(i(r))throw new TypeError();const s=((t,e)=>{const n=t.createMediaStreamDestination();return wt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n;})(r,{...Ot,...e});super(t,!1,s,null),this._nativeMediaStreamAudioDestinationNode=s;}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream;}})(Ce,0,ye,be),ii=((t,e,n,i)=>class extends t{constructor(t,e){const r=n(t),s=((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((t,e)=>t.id<e.id?-1:t.id>e.id?1:0);const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r;})(r,e);if(i(r))throw new TypeError();super(t,!0,s,null),this._nativeMediaStreamAudioSourceNode=s;}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream;}})(Ce,0,ye,be),ri=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError();return s;})(bt,be),si=((t,e,n)=>class extends t{constructor(t,i){const r=n(t);super(t,!0,e(r,i),null);}})(Ce,ri,ye),oi=((t,e,n,i,r,s,o,a,h)=>class extends t{constructor(t={}){if(null===h)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new h(t);}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t;}if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:r}=t,{sampleRate:s}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===r?512/s:"interactive"===r||void 0===r?256/s:"playback"===r?1024/s:128*Math.max(2,Math.min(128,Math.round(r*s/128)))/s,this._nativeAudioContext=e,"webkitAudioContext"===h.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t);};e.addEventListener("statechange",t);}}get baseLatency(){return this._baseLatency;}get state(){return null!==this._state?this._state:this._nativeAudioContext.state;}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw e();}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),B(this);}));}createMediaElementSource(t){return new r(this,{mediaElement:t});}createMediaStreamDestination(){return new s(this);}createMediaStreamSource(t){return new o(this,{mediaStream:t});}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t});}resume(){return"suspended"===this._state?new Promise((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e);};this._nativeAudioContext.addEventListener("statechange",n);}):this._nativeAudioContext.resume().catch(t=>{if(void 0===t||15===t.code)throw e();throw t;});}suspend(){return this._nativeAudioContext.suspend().catch(t=>{if(void 0===t)throw e();throw t;});}})(ti,bt,Ht,Zt,ei,ni,ii,si,Re),ai=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n;})(Sn),hi=(t=>(e,n)=>{t(e).add(n);})(ai),ui=(t=>(e,n,i=0,r=0)=>{const s=e[i];if(void 0===s)throw t();return nt(n)?s.connect(n,0,r):s.connect(n,0);})(I),li=(t=>(e,n)=>{t(e).delete(n);})(ai),ci=(t=>(e,n,i,r=0)=>void 0===n?e.forEach(t=>t.disconnect()):"number"==typeof n?yt(t,e,n).disconnect():nt(n)?void 0===i?e.forEach(t=>t.disconnect(n)):void 0===r?yt(t,e,i).disconnect(n,0):yt(t,e,i).disconnect(n,0,r):void 0===i?e.forEach(t=>t.disconnect(n)):yt(t,e,i).disconnect(n,0))(I),di=new WeakMap(),pi=((t,e)=>n=>e(t,n))(di,g),fi=((t,e,n,i,r,s,o,a,h,u,l,d,p)=>(f,_,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw h();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some(t=>t<1))throw h();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw h();const y=g.channelCount*g.numberOfInputs,T=v.reduce((t,e)=>t+e,0),E=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+E>6||T>6)throw h();const b=new MessageChannel(),x=[],A=[];for(let t=0;t<g.numberOfInputs;t+=1)x.push(o(f,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),A.push(r(f,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const R=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){const r=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?M:e},minValue:{get:()=>void 0===n?N:n}}),R.push(r);}const O=i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+E)}),S=Dt(_,f.sampleRate),I=a(f,S,y+E,Math.max(1,T)),w=r(f,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),C=[];for(let t=0;t<g.numberOfOutputs;t+=1)C.push(i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){x[t].connect(A[t]);for(let e=0;e<g.channelCount;e+=1)A[t].connect(O,e,t*g.channelCount+e);}const P=new ot(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map(({name:t},e)=>{const n=R[e];return n.connect(O,0,y+e),n.start(0),[t,n.offset];}));O.connect(I);let D=g.channelInterpretation,L=null;const F=0===g.numberOfOutputs?[I]:C,U={get bufferSize(){return S;},get channelCount(){return g.channelCount;},set channelCount(t){throw n();},get channelCountMode(){return g.channelCountMode;},set channelCountMode(t){throw n();},get channelInterpretation(){return D;},set channelInterpretation(t){for(const e of x)e.channelInterpretation=t;D=t;},get context(){return I.context;},get inputs(){return x;},get numberOfInputs(){return g.numberOfInputs;},get numberOfOutputs(){return g.numberOfOutputs;},get onprocessorerror(){return L;},set onprocessorerror(t){"function"==typeof L&&U.removeEventListener("processorerror",L),L="function"==typeof t?t:null,"function"==typeof L&&U.addEventListener("processorerror",L);},get parameters(){return P;},get port(){return b.port2;},addEventListener:(...t)=>I.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,F),disconnect:u.bind(null,F),dispatchEvent:(...t)=>I.dispatchEvent(t[0]),removeEventListener:(...t)=>I.removeEventListener(t[0],t[1],t[2])},B=new Map();var G,k;b.port1.addEventListener=(G=b.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=B.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(f.currentTime,f.sampleRate,()=>e(t));},B.set(e,t[1]));}}return G.call(b.port1,t[0],t[1],t[2]);}),b.port1.removeEventListener=(k=b.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=B.get(t[1]);void 0!==e&&(B.delete(t[1]),t[1]=e);}return k.call(b.port1,t[0],t[1],t[2]);});let X=null;Object.defineProperty(b.port1,"onmessage",{get:()=>X,set:t=>{"function"==typeof X&&b.port1.removeEventListener("message",X),X="function"==typeof t?t:null,"function"==typeof X&&(b.port1.addEventListener("message",X),b.port1.start());}}),m.prototype.port=b.port1;let V=null;const H=((t,e,n,i)=>{let r=c.get(t);void 0===r&&(r=new WeakMap(),c.set(t,r));const s=(async(t,e)=>{const n=await(t=>new Promise((e,n)=>{const{port1:i,port2:r}=new MessageChannel();i.onmessage=({data:t})=>{i.close(),r.close(),e(t);},i.onmessageerror=({data:t})=>{i.close(),r.close(),n(t);},r.postMessage(t);}))(e);return new t(n);})(n,i);return r.set(e,s),s;})(f,U,m,g);H.then(t=>V=t);const j=lt(g.numberOfInputs,g.channelCount),Y=lt(g.numberOfOutputs,v),W=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((t,{name:e})=>({...t,[e]:new Float32Array(128)}),{});let z=!0;const q=()=>{g.numberOfOutputs>0&&I.disconnect(w);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=C[t];for(let i=0;i<v[t];i+=1)w.disconnect(n,e+i,i);e+=v[t];}},Z=new Map();I.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==V){const n=d(U);for(let i=0;i<S;i+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)ht(t,j[e],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach(({name:e},n)=>{ht(t,W,e,y+n,i);});for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===Y[t][e].byteLength&&(Y[t][e]=new Float32Array(128));try{const t=j.map((t,e)=>{if(n[e].size>0)return Z.set(e,S/128),t;const i=Z.get(e);return void 0===i?[]:(t.every(t=>t.every(t=>0===t))&&(1===i?Z.delete(e):Z.set(e,i-1)),t);}),r=l(f.currentTime+i/f.sampleRate,f.sampleRate,()=>V.process(t,Y,W));z=r;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let r=0;r<v[t];r+=1)ut(e,Y[t],r,n+r,i);n+=v[t];}}catch(t){z=!1,U.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}));}if(!z){for(let t=0;t<g.numberOfInputs;t+=1){x[t].disconnect(A[t]);for(let e=0;e<g.channelCount;e+=1)A[i].disconnect(O,e,t*g.channelCount+e);}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=R[e];t.disconnect(O,0,y+e),t.stop();}}O.disconnect(I),I.onaudioprocess=null,K?q():J();break;}}}};let K=!1;const $=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Q=()=>I.connect($).connect(f.destination),J=()=>{I.disconnect($),$.disconnect();};return Q(),p(U,()=>{if(z){J(),g.numberOfOutputs>0&&I.connect(w);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=C[t];for(let i=0;i<v[t];i+=1)w.connect(n,e+i,i);e+=v[t];}}K=!0;},()=>{z&&(Q(),q()),K=!1;});})(ui,I,bt,en,Ft,hn,Gt,Vt,Ht,ci,qn,pi,Je),_i=((t,e,n,i,r)=>(s,o,a,h,u,l)=>{if(null!==a)try{const e=new a(s,h,l),i=new Map();let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t();}},channelCountMode:{get:()=>"explicit",set:()=>{throw t();}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o);}}}),e.addEventListener=(d=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}));},i.set(e,t[1]));}}return d.call(e,"error",t[1],t[2]),d.call(e,...t);}),e.removeEventListener=(c=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e);}return c.call(e,"error",t[1],t[2]),c.call(e,t[0],t[1],t[2]);}),0!==l.numberOfOutputs){const t=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return e.connect(t).connect(s.destination),r(e,()=>t.disconnect(),()=>t.connect(s.destination));}return e;}catch(t){if(11===t.code)throw i();throw t;}var c,d;if(void 0===u)throw i();return(t=>{const{port1:e}=new MessageChannel();try{e.postMessage(t);}finally{e.close();}})(l),e(s,o,u,l);})(bt,fi,Gt,Ht,Je),mi=((t,e,n,i,r,s,o,a,h,u,l,c,d,p,f,_)=>(m,g,v)=>{const y=new WeakMap();let T=null;return{render(E,b){a(b,E);const x=y.get(b);return void 0!==x?Promise.resolve(x):(async(a,E)=>{let b=l(a),x=null;const A=O(b,E),R=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===c){const t=R.reduce((t,e)=>t+e,0),n=r(E,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),s=[];for(let t=0;t<a.numberOfOutputs;t+=1)s.push(i(E,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[t]}));const u=o(E,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});u.connect=e.bind(null,s),u.disconnect=h.bind(null,s),x=[n,s,u];}else A||(b=new c(E,m));if(y.set(E,null===x?b:x[2]),null!==x){if(null===T){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===d)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,h=async()=>{const h=new d(n,128*Math.ceil(a.context.length/128),E.sampleRate),u=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)u.push(o(h,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(r(h,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const c=await Promise.all(Array.from(a.parameters.values()).map(async t=>{const e=s(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await p(h,t,e.offset),e;})),m=i(h,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){u[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(m,e,t*g.channelCount+e);}for(const[e,n]of c.entries())n.connect(m,0,t+e),n.start(0);return m.connect(h.destination),await Promise.all(u.map(t=>f(a,h,t))),_(h);};T=ct(a,0===n?null:await h(),E,g,R,v,u);}const t=await T,e=n(E,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[h,l,c]=x;null!==t&&(e.buffer=t,e.start(0)),e.connect(h);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let i=0;i<R[t];i+=1)h.connect(n,e+i,i);e+=R[t];}return c;}if(A)for(const[e,n]of a.parameters.entries())await t(E,n,b.parameters.get(e));else for(const[t,e]of a.parameters.entries())await p(E,e,b.parameters.get(t));return await f(a,E,b),b;})(E,b);}};})(Ve,ui,He,en,Ft,hn,Gt,li,ci,qn,K,we,Ee,je,ge,bn),gi=(t=>e=>t.get(e))(Zn),vi=(t=>(e,n)=>{t.set(e,n);})(di),yi=zn?((t,e,n,i,r,s,o,a,h,u,c,d,p,f)=>class extends e{constructor(e,c,p){var f;const _=a(e),m=h(_),g=(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}))({...at,...p});(t=>{const{port1:e,port2:n}=new MessageChannel();try{e.postMessage(t);}finally{e.close(),n.close();}})(g);const v=l.get(_),y=null==v?void 0:v.get(c),T=m||"closed"!==_.state?_:null!==(f=o(_))&&void 0!==f?f:_,E=r(T,m?null:e.baseLatency,u,c,y,g);super(e,!0,E,m?i(c,g,y):null);const b=[];E.parameters.forEach((t,e)=>{const i=n(this,m,t);b.push([e,i]);}),this._nativeAudioWorkletNode=E,this._onprocessorerror=null,this._parameters=new ot(b),m&&t(_,this);const{activeInputs:x}=s(this);d(E,x);}get onprocessorerror(){return this._onprocessorerror;}set onprocessorerror(t){const e="function"==typeof t?f(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n;}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters;}get port(){return this._nativeAudioWorkletNode.port;}})(hi,Ce,We,mi,_i,L,gi,ye,be,we,0,vi,0,se):void 0,Ti=((t,e)=>(n,i,r)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r);}catch(e){if("SyntaxError"===e.name)throw t();throw e;}})(Ht,Ee),Ei=((t,e,n,i,r,s,o,a)=>(h,u)=>n(h).render(h,u).then(()=>Promise.all(Array.from(i(u)).map(t=>n(t).render(t,u)))).then(()=>r(u)).then(n=>("function"!=typeof n.copyFromChannel?(o(n),w(n)):e(s,()=>s(n))||a(n),t.add(n),n)))(Pe,ce,me,ai,bn,S,Ue,Be),bi=((t,e,n,i,r)=>class extends t{constructor(t,n,r){let s;if("number"==typeof t&&void 0!==n&&void 0!==r)s={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");s=t;}const{length:o,numberOfChannels:a,sampleRate:h}={...jt,...s},u=i(a,o,h);e(St,()=>St(u))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1);};return e;})()),super(u,a),this._length=o,this._nativeOfflineAudioContext=u,this._state=null;}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length;}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state;}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,B(this);}));}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout(()=>this._waitForThePromiseToSettle(t));}})(ti,ce,bt,Ti,Ei),xi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n);})(a,Oe),Ai=((t,e)=>n=>t.has(n)||e(n))(r,Se),Ri=((t,e)=>n=>t.has(n)||e(n))(o,Ie),Oi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n);})(a,be);function Si(t,e){if(!t)throw new Error(e);}function Ii(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`);}function wi(t){t.isOffline||"running"===t.state||Ni('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.');}let Ci=console;function Ni(...t){Ci.warn(...t);}function Mi(t){return void 0===t;}function Pi(t){return!Mi(t);}function Di(t){return"number"==typeof t;}function Li(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object;}function Fi(t){return Array.isArray(t);}function Ui(t){return"string"==typeof t;}function Bi(t){return Ui(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t);}const Gi="object"==typeof self?self:null,ki=Gi&&(Gi.hasOwnProperty("AudioContext")||Gi.hasOwnProperty("webkitAudioContext"));function Xi(t,e,n,i){var r,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(o=(s<3?r(o):s>3?r(e,n,o):r(e,n))||o);return s>3&&o&&Object.defineProperty(e,n,o),o;}function Vi(t,e,n,i){return new(n||(n=Promise))(function(r,s){function o(t){try{h(i.next(t));}catch(t){s(t);}}function a(t){try{h(i.throw(t));}catch(t){s(t);}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e);})).then(o,a);}h((i=i.apply(t,e||[])).next());});}Object.create,Object.create;class Hi{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock();}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n;}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback();},1e3*this._updateInterval);}_createClock(){if("worker"===this._type)try{this._createWorker();}catch(t){this._type="timeout",this._createClock();}else"timeout"===this._type&&this._createTimeout();}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null);}get updateInterval(){return this._updateInterval;}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1));}get type(){return this._type;}set type(t){this._disposeClock(),this._type=t,this._createClock();}dispose(){this._disposeClock();}}function ji(t){return Ri(t);}function Yi(t){return Ai(t);}function Wi(t){return Oi(t);}function zi(t){return xi(t);}function qi(t){return t instanceof AudioBuffer;}function Zi(t,e){return"value"===t||ji(e)||Yi(e)||qi(e);}function Ki(t,...e){if(!e.length)return t;const n=e.shift();if(Li(t)&&Li(n))for(const e in n)Zi(e,n[e])?t[e]=n[e]:Li(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Ki(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Ki(t,...e);}function $i(t,e,n=[],i){const r={},s=Array.from(e);if(Li(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(e=>Reflect.has(t,e))||(Ki(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),1===s.length&&Li(s[0]))Ki(r,s[0]);else for(let t=0;t<n.length;t++)Pi(s[t])&&(r[n[t]]=s[t]);return Ki(t,r);}function Qi(t,e){return Mi(t)?e:t;}function Ji(t,e){return e.forEach(e=>{Reflect.has(t,e)&&delete t[e];}),t;}class tr{constructor(){this.debug=!1,this._wasDisposed=!1;}static getDefaults(){return{};}log(...t){(this.debug||Gi&&this.toString()===Gi.TONE_DEBUG_CLASS)&&function(...t){Ci.log(...t);}(this,...t);}dispose(){return this._wasDisposed=!0,this;}get disposed(){return this._wasDisposed;}toString(){return this.name;}}tr.version="14.7.77";const er=1e-6;function nr(t,e){return t>e+er;}function ir(t,e){return nr(t,e)||sr(t,e);}function rr(t,e){return t+er<e;}function sr(t,e){return Math.abs(t-e)<er;}class or extends tr{constructor(){super(),this.name="Timeline",this._timeline=[];const t=$i(or.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing;}static getDefaults(){return{memory:1/0,increasing:!1};}get length(){return this._timeline.length;}add(t){if(Si(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Si(ir(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t);}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t);}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t);}return this;}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this;}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null;}peek(){return this._timeline[0];}shift(){return this._timeline.shift();}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null;}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null;}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0){if(sr(this._timeline[e].time,t)){for(let n=e;n>=0&&sr(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e);}else this._timeline=this._timeline.slice(0,e+1);}else this._timeline=[];}else 1===this._timeline.length&&ir(this._timeline[0].time,t)&&(this._timeline=[]);return this;}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this;}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null;}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){let i=Math.floor(n+(r-n)/2);const s=this._timeline[i],o=this._timeline[i+1];if(sr(s[e],t)){for(let n=i;n<this._timeline.length&&sr(this._timeline[n][e],t);n++)i=n;return i;}if(rr(s[e],t)&&nr(o[e],t))return i;nr(s[e],t)?r=i:n=i+1;}return-1;}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t);}forEach(t){return this._iterate(t),this;}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this;}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this;}forEachBetween(t,e,n){let i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this;}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this;}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&sr(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&sr(this._timeline[e].time,t);e--)i=e;this._iterate(t=>{e(t);},i,n);}return this;}dispose(){return super.dispose(),this._timeline=[],this;}}const ar=[];function hr(t){ar.push(t);}const ur=[];function lr(t){ur.push(t);}class cr extends tr{constructor(){super(...arguments),this.name="Emitter";}on(t,e){return t.split(/\W+/).forEach(t=>{Mi(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e);}),this;}once(t,e){const n=(...i)=>{e(...i),this.off(t,n);};return this.on(t,n),this;}off(t,e){return t.split(/\W+/).forEach(n=>{if(Mi(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Mi(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1);}}),this;}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e);}return this;}static mixin(t){["on","once","off","emit"].forEach(e=>{const n=Object.getOwnPropertyDescriptor(cr.prototype,e);Object.defineProperty(t.prototype,e,n);});}dispose(){return super.dispose(),this._events=void 0,this;}}class dr extends cr{constructor(){super(...arguments),this.isOffline=!1;}toJSON(){return{};}}class pr extends dr{constructor(){super(),this.name="Context",this._constants=new Map(),this._timeouts=new or(),this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map();const t=$i(pr.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new oi(t);}({latencyHint:t.latencyHint}),this._ticker=new Hi(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state);},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead;}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05};}initialize(){var t;return this._initialized||(t=this,ar.forEach(e=>e(t)),this._initialized=!0),this;}createAnalyser(){return this._context.createAnalyser();}createOscillator(){return this._context.createOscillator();}createBufferSource(){return this._context.createBufferSource();}createBiquadFilter(){return this._context.createBiquadFilter();}createBuffer(t,e,n){return this._context.createBuffer(t,e,n);}createChannelMerger(t){return this._context.createChannelMerger(t);}createChannelSplitter(t){return this._context.createChannelSplitter(t);}createConstantSource(){return this._context.createConstantSource();}createConvolver(){return this._context.createConvolver();}createDelay(t){return this._context.createDelay(t);}createDynamicsCompressor(){return this._context.createDynamicsCompressor();}createGain(){return this._context.createGain();}createIIRFilter(t,e){return this._context.createIIRFilter(t,e);}createPanner(){return this._context.createPanner();}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n);}createStereoPanner(){return this._context.createStereoPanner();}createWaveShaper(){return this._context.createWaveShaper();}createMediaStreamSource(t){return Si(zi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t);}createMediaElementSource(t){return Si(zi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t);}createMediaStreamDestination(){return Si(zi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination();}decodeAudioData(t){return this._context.decodeAudioData(t);}get currentTime(){return this._context.currentTime;}get state(){return this._context.state;}get sampleRate(){return this._context.sampleRate;}get listener(){return this.initialize(),this._listener;}set listener(t){Si(!this._initialized,"The listener cannot be set after initialization."),this._listener=t;}get transport(){return this.initialize(),this._transport;}set transport(t){Si(!this._initialized,"The transport cannot be set after initialization."),this._transport=t;}get draw(){return this.initialize(),this._draw;}set draw(t){Si(!this._initialized,"Draw cannot be set after initialization."),this._draw=t;}get destination(){return this.initialize(),this._destination;}set destination(t){Si(!this._initialized,"The destination cannot be set after initialization."),this._destination=t;}createAudioWorkletNode(t,e){return function(t,e,n){return Si(Pi(yi),"This node only works in a secure context (https or localhost)"),new yi(t,e,n);}(this.rawContext,t,e);}addAudioWorkletModule(t,e){return Vi(this,void 0,void 0,function*(){Si(Pi(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e);});}workletsAreReady(){return Vi(this,void 0,void 0,function*(){const t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t);});}get updateInterval(){return this._ticker.updateInterval;}set updateInterval(t){this._ticker.updateInterval=t;}get clockSource(){return this._ticker.type;}set clockSource(t){this._ticker.type=t;}get latencyHint(){return this._latencyHint;}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Ui(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25;}this.lookAhead=e,this.updateInterval=e/2;}get rawContext(){return this._context;}now(){return this._context.currentTime+this.lookAhead;}immediate(){return this._context.currentTime;}resume(){return zi(this._context)?this._context.resume():Promise.resolve();}close(){return Vi(this,void 0,void 0,function*(){var t;zi(this._context)&&(yield this._context.close()),this._initialized&&(t=this,ur.forEach(e=>e(t)));});}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i;}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this;}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek();}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds;}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e);}),this;}clearInterval(t){return this.clearTimeout(t);}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{t(),i();},id:n,time:r+e});};return i(),n;}}function fr(t,e){Fi(e)?e.forEach(e=>fr(t,e)):Object.defineProperty(t,e,{enumerable:!0,writable:!1});}function _r(t,e){Fi(e)?e.forEach(e=>_r(t,e)):Object.defineProperty(t,e,{writable:!0});}const mr=()=>{};class gr extends tr{constructor(){super(),this.name="ToneAudioBuffer",this.onload=mr;const t=$i(gr.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&qi(t.url)||t.url instanceof gr?this.set(t.url):Ui(t.url)&&this.load(t.url).catch(t.onerror);}static getDefaults(){return{onerror:mr,onload:mr,reverse:!1};}get sampleRate(){return this._buffer?this._buffer.sampleRate:Er().sampleRate;}set(t){return t instanceof gr?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this);}:this._buffer=t,this._reversed&&this._reverse(),this;}get(){return this._buffer;}load(t){return Vi(this,void 0,void 0,function*(){const e=gr.load(t).then(t=>{this.set(t),this.onload(this);});gr.downloads.push(e);try{yield e;}finally{const t=gr.downloads.indexOf(e);gr.downloads.splice(t,1);}return this;});}dispose(){return super.dispose(),this._buffer=void 0,this;}fromArray(t){const e=Fi(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=Er(),s=r.createBuffer(n,i,r.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)s.copyToChannel(o[t],t);return this._buffer=s,this;}toMono(t){if(Di(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n];}t=t.map(t=>t/e),this.fromArray(t);}return this;}toArray(t){if(Di(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t;}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0);}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Si(n<i,"The start time must be less than the end time");const r=i-n,s=Er().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)s.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new gr(s);}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this;}get loaded(){return this.length>0;}get duration(){return this._buffer?this._buffer.duration:0;}get length(){return this._buffer?this._buffer.length:0;}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0;}get reverse(){return this._reversed;}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse());}static fromArray(t){return new gr().fromArray(t);}static fromUrl(t){return Vi(this,void 0,void 0,function*(){const e=new gr();return yield e.load(t);});}static load(t){return Vi(this,void 0,void 0,function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(gr.supportsType(t)){i=t;break;}t=t.replace(e[0],i);}const n=""===gr.baseUrl||gr.baseUrl.endsWith("/")?gr.baseUrl:gr.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const r=yield i.arrayBuffer();return yield Er().decodeAudioData(r);});}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n);}static loaded(){return Vi(this,void 0,void 0,function*(){for(yield Promise.resolve();gr.downloads.length;)yield gr.downloads[0];});}}gr.baseUrl="",gr.downloads=[];class vr extends pr{constructor(){var t,e,n;super({clockSource:"offline",context:Wi(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new bi(t,e,n)),lookAhead:0,updateInterval:Wi(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Wi(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1];}now(){return this._currentTime;}get currentTime(){return this._currentTime;}_renderClock(t){return Vi(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise(t=>setTimeout(t,1)));}});}render(t=!0){return Vi(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new gr(e);});}close(){return Promise.resolve();}}const yr=new class extends dr{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1;}createAnalyser(){return{};}createOscillator(){return{};}createBufferSource(){return{};}createBiquadFilter(){return{};}createBuffer(t,e,n){return{};}createChannelMerger(t){return{};}createChannelSplitter(t){return{};}createConstantSource(){return{};}createConvolver(){return{};}createDelay(t){return{};}createDynamicsCompressor(){return{};}createGain(){return{};}createIIRFilter(t,e){return{};}createPanner(){return{};}createPeriodicWave(t,e,n){return{};}createStereoPanner(){return{};}createWaveShaper(){return{};}createMediaStreamSource(t){return{};}createMediaElementSource(t){return{};}createMediaStreamDestination(){return{};}decodeAudioData(t){return Promise.resolve({});}createAudioWorkletNode(t,e){return{};}get rawContext(){return{};}addAudioWorkletModule(t,e){return Vi(this,void 0,void 0,function*(){return Promise.resolve();});}resume(){return Promise.resolve();}setTimeout(t,e){return 0;}clearTimeout(t){return this;}setInterval(t,e){return 0;}clearInterval(t){return this;}getConstant(t){return{};}get currentTime(){return 0;}get state(){return{};}get sampleRate(){return 0;}get listener(){return{};}get transport(){return{};}get draw(){return{};}set draw(t){}get destination(){return{};}set destination(t){}now(){return 0;}immediate(){return 0;}}();let Tr=yr;function Er(){return Tr===yr&&ki&&(t=new pr(),Tr=zi(t)?new pr(t):Wi(t)?new vr(t):t),Tr;var t;}if(Gi&&!Gi.TONE_SILENCE_LOGGING){const t=` * Tone.js ${"v"}14.7.77 * `;console.log(`%c${t}`,"background: #000; color: #fff");}function br(t){return Math.log(t)/Math.LN10*20;}function xr(t){return Math.pow(2,t/12);}let Ar=440;function Rr(t){return Math.round(Or(t));}function Or(t){return 69+12*Math.log2(t/Ar);}class Sr extends tr{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions();}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i;},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)));},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i;},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}};}valueOf(){if(this._val instanceof Sr&&this.fromType(this._val),Mi(this._val))return this._noArg();if(Ui(this._val)&&Mi(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break;}}else if(Li(this._val)){let t=0;for(const e in this._val)if(Pi(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n;}return t;}if(Pi(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val);}return Ui(this._val)?parseFloat(this._val):this._val;}_frequencyToUnits(t){return 1/t;}_beatsToUnits(t){return 60/this._getBpm()*t;}_secondsToUnits(t){return t;}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ();}_noArg(){return this._now();}_getBpm(){return this.context.transport.bpm.value;}_getTimeSignature(){return this.context.transport.timeSignature;}_getPPQ(){return this.context.transport.PPQ;}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();}return this;}toFrequency(){return 1/this.toSeconds();}toSamples(){return this.toSeconds()*this.context.sampleRate;}toMilliseconds(){return 1e3*this.toSeconds();}}class Ir extends Sr{constructor(){super(...arguments),this.name="TimeClass";}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Ir(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e));},regexp:/^@(.+)/}});}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e;}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t");}e.push("0");let n=e[0],i=new Ir(this.context,e[0]).toSeconds();return e.forEach(e=>{const r=new Ir(this.context,e).toSeconds();Math.abs(r-t)<Math.abs(i-t)&&(n=e,i=r);}),n;}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[n,e,i].join(":");}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ());}toSeconds(){return this.valueOf();}toMidi(){return Rr(this.toFrequency());}_now(){return this.context.now();}}class wr extends Ir{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz";}static get A4(){return Ar;}static set A4(t){!function(t){Ar=t;}(t);}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:wr.mtof(t);}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Cr[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:wr.mtof(n);}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i;}}});}transpose(t){return new wr(this.context,this.valueOf()*xr(t));}harmonize(t){return t.map(t=>this.transpose(t));}toMidi(){return Rr(this.valueOf());}toNote(){const t=this.toFrequency(),e=Math.log2(t/wr.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);return i<0&&(n+=-12*i),Nr[n%12]+i.toString();}toSeconds(){return 1/super.toSeconds();}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ());}_noArg(){return 0;}_frequencyToUnits(t){return t;}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()));}_beatsToUnits(t){return 1/super._beatsToUnits(t);}_secondsToUnits(t){return 1/t;}static mtof(t){return function(t){return Ar*Math.pow(2,(t-69)/12);}(t);}static ftom(t){return Rr(t);}}const Cr={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Nr=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Mr extends Ir{constructor(){super(...arguments),this.name="TransportTime";}_now(){return this.context.transport.seconds;}}class Pr extends tr{constructor(){super();const t=$i(Pr.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context;}static getDefaults(){return{context:Er()};}now(){return this.context.currentTime+this.context.lookAhead;}immediate(){return this.context.currentTime;}get sampleTime(){return 1/this.context.sampleRate;}get blockTime(){return 128/this.context.sampleRate;}toSeconds(t){return new Ir(this.context,t).toSeconds();}toFrequency(t){return new wr(this.context,t).toFrequency();}toTicks(t){return new Mr(this.context,t).toTicks();}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach(n=>{Mi(t[n])&&delete e[n];}),e;}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){const n=this[e];Pi(n)&&Pi(n.value)&&Pi(n.setValueAtTime)?t[e]=n.value:n instanceof Pr?t[e]=n._getPartialProperties(t[e]):Fi(n)||Di(n)||Ui(n)||"boolean"==typeof n?t[e]=n:delete t[e];}}),t;}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&Pi(this[e])&&(this[e]&&Pi(this[e].value)&&Pi(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Pr?this[e].set(t[e]):this[e]=t[e]);}),this;}}class Dr extends or{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0);}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial;}setStateAtTime(t,e,n){return Ii(e,0),this.add(Object.assign({},n,{state:t,time:e})),this;}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e;}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n;}}}class Lr extends Pr{constructor(){super($i(Lr.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=$i(Lr.getDefaults(),arguments,["param","units","convert"]);for(Si(Pi(t.param)&&(ji(t.param)||t.param instanceof Lr),"param must be an AudioParam");!ji(t.param);)t.param=t.param._param;this._swappable=!!Pi(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new or(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Pi(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0);}static getDefaults(){return Object.assign(Pr.getDefaults(),{convert:!0,units:"number"});}get value(){const t=this.now();return this.getValueAtTime(t);}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now());}get minValue(){return Pi(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue;}get maxValue(){return Pi(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue;}_is(t,e){return this.units===e;}_assertRange(t){return Pi(this.maxValue)&&Pi(this.minValue)&&Ii(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t;}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?(e=t,Math.pow(10,e/20)):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t;var e;}_toType(t){return this.convert&&"decibels"===this.units?br(t):t;}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Si(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this;}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type){if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value;}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e);}else r=i.value;}else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,n,i.value,i.constant,e));}return this._toType(r);}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this;}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Si(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this;}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=sr(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Si(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this;}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this;}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this;}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this;}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this;}setTargetAtTime(t,e,n){const i=this._fromType(t);Si(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(e);return this._assertRange(i),Si(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this;}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);const s=n/(t.length-1);for(let n=1;n<t.length;n++){const r=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(r),e+n*s);}return this;}cancelScheduledValues(t){const e=this.toSeconds(t);return Si(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this;}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Si(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),r=this._events.getAfter(e);return i&&sr(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this;}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this;}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),r=i?i.time:e+2,s=(r-e)/10;for(let n=e;n<r;n+=s)t.linearRampToValueAtTime(this.getValueAtTime(n),n);}return this._events.forEachAfter(this.context.currentTime,e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time);}),this;}setParam(t){Si(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this;}dispose(){return super.dispose(),this._events.dispose(),this;}get defaultValue(){return this._toType(this._param.defaultValue);}_exponentialApproach(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i);}_linearInterpolate(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e);}_exponentialInterpolate(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t));}}class Fr extends Pr{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[];}get numberOfInputs(){return Pi(this.input)?ji(this.input)||this.input instanceof Lr?1:this.input.numberOfInputs:0;}get numberOfOutputs(){return Pi(this.output)?this.output.numberOfOutputs:0;}_isAudioNode(t){return Pi(t)&&(t instanceof Fr||Yi(t));}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t;}_setChannelProperties(t){this._getInternalNodes().forEach(e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation;});}_getChannelProperties(){const t=this._getInternalNodes();Si(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation};}get channelCount(){return this._getChannelProperties().channelCount;}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}));}get channelCountMode(){return this._getChannelProperties().channelCountMode;}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}));}get channelInterpretation(){return this._getChannelProperties().channelInterpretation;}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}));}connect(t,e=0,n=0){return Br(this,t,e,n),this;}toDestination(){return this.connect(this.context.destination),this;}toMaster(){return Ni("toMaster() has been renamed toDestination()"),this.toDestination();}disconnect(t,e=0,n=0){return function(t,e,n=0,i=0){if(Pi(e))for(;e instanceof Fr;)e=e.input;for(;!Yi(t);)Pi(t.output)&&(t=t.output);ji(e)?t.disconnect(e,n):Yi(e)?t.disconnect(e,n,i):t.disconnect();}(this,t,e,n),this;}chain(...t){return Ur(this,...t),this;}fan(...t){return t.forEach(t=>this.connect(t)),this;}dispose(){return super.dispose(),Pi(this.input)&&(this.input instanceof Fr?this.input.dispose():Yi(this.input)&&this.input.disconnect()),Pi(this.output)&&(this.output instanceof Fr?this.output.dispose():Yi(this.output)&&this.output.disconnect()),this._internalChannels=[],this;}}function Ur(...t){const e=t.shift();t.reduce((t,e)=>(t instanceof Fr?t.connect(e):Yi(t)&&Br(t,e),e),e);}function Br(t,e,n=0,i=0){for(Si(Pi(t),"Cannot connect from undefined node"),Si(Pi(e),"Cannot connect to undefined node"),(e instanceof Fr||Yi(e))&&Si(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Si(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Fr||e instanceof Lr;)Pi(e.input)&&(e=e.input);for(;t instanceof Fr;)Pi(t.output)&&(t=t.output);ji(e)?t.connect(e,n):t.connect(e,n,i);}class Gr extends Fr{constructor(){super($i(Gr.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=$i(Gr.getDefaults(),arguments,["gain","units"]);this.gain=new Lr({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),fr(this,"gain");}static getDefaults(){return Object.assign(Fr.getDefaults(),{convert:!0,gain:1,units:"gain"});}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this;}}class kr extends Fr{constructor(t){super(t),this.onended=mr,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Gr({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped";},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended;}static getDefaults(){return Object.assign(Fr.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:mr});}_startGain(t,e=1){Si(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this;}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this;}_stopGain(t){Si(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended();},this._stopTime-this.context.currentTime),this;}_onended(){if(this.onended!==mr&&(this.onended(this),this.onended=mr,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3);}}get state(){return this.getStateAtTime(this.now());}cancelStop(){return this.log("cancelStop"),Si(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this;}dispose(){return super.dispose(),this._gainNode.disconnect(),this;}}class Xr extends kr{constructor(){super($i(Xr.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=$i(Xr.getDefaults(),arguments,["offset"]);Br(this._source,this._gainNode),this.offset=new Lr({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue});}static getDefaults(){return Object.assign(kr.getDefaults(),{convert:!0,offset:1,units:"number"});}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this;}_stopSource(t){this._source.stop(t);}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this;}}class Vr extends Fr{constructor(){super($i(Vr.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=$i(Vr.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Xr({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset;}static getDefaults(){return Object.assign(Fr.getDefaults(),{convert:!0,units:"number",value:0});}connect(t,e=0,n=0){return Hr(this,t,e,n),this;}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this;}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this;}getValueAtTime(t){return this._param.getValueAtTime(t);}setRampPoint(t){return this._param.setRampPoint(t),this;}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this;}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this;}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this;}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this;}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this;}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this;}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this;}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this;}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this;}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this;}rampTo(t,e,n){return this._param.rampTo(t,e,n),this;}get value(){return this._param.value;}set value(t){this._param.value=t;}get convert(){return this._param.convert;}set convert(t){this._param.convert=t;}get units(){return this._param.units;}get overridden(){return this._param.overridden;}set overridden(t){this._param.overridden=t;}get maxValue(){return this._param.maxValue;}get minValue(){return this._param.minValue;}apply(t){return this._param.apply(t),this;}}function Hr(t,e,n,i){(e instanceof Lr||ji(e)||e instanceof Vr&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Vr&&(e.overridden=!0)),Br(t,e,n,i);}class jr extends Lr{constructor(){super($i(jr.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new or(1/0),this._multiplier=1;const t=$i(jr.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0);}static getDefaults(){return Object.assign(Lr.getDefaults(),{multiplier:1,units:"hertz",value:1});}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),r=this._events.get(e),s=Math.round(Math.max(1/n,1));for(let t=0;t<=s;t++){const s=n*t+e,o=this._exponentialApproach(r.time,r.value,i,n,s);this.linearRampToValueAtTime(this._toType(o),s);}return this;}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this;}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),r=this._events.previousEvent(i),s=this._getTicksUntilEvent(r,n);return i.ticks=Math.max(s,0),this;}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),s=(e-i.time)/r;for(let t=0;t<=r;t++){const r=s*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,r);this.linearRampToValueAtTime(this._toType(o),r);}return this;}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Mi(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time);}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const r=this._events.get(e);return r&&r.time===e&&"setValueAtTime"===r.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks;}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0);}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n;}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),s=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),o=(-i+s)/r,a=(-i-s)/r;return(o>0?o:a)+e.time;}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue;}ticksToTime(t,e){return this.getDurationOfTicks(t,e);}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r;}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t);}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t);}get multiplier(){return this._multiplier;}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0);}}class Yr extends Vr{constructor(){super($i(Yr.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=$i(Yr.getDefaults(),arguments,["value"]);this.input=this._param=new jr({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value});}static getDefaults(){return Object.assign(Vr.getDefaults(),{multiplier:1,units:"hertz",value:1});}ticksToTime(t,e){return this._param.ticksToTime(t,e);}timeToTicks(t,e){return this._param.timeToTicks(t,e);}getTimeOfTick(t){return this._param.getTimeOfTick(t);}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e);}getTicksAtTime(t){return this._param.getTicksAtTime(t);}get multiplier(){return this._param.multiplier;}set multiplier(t){this._param.multiplier=t;}dispose(){return super.dispose(),this._param.dispose(),this;}}class Wr extends Pr{constructor(){super($i(Wr.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Dr(),this._tickOffset=new or();const t=$i(Wr.getDefaults(),arguments,["frequency"]);this.frequency=new Yr({context:this.context,units:t.units,value:t.frequency}),fr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0);}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Pr.getDefaults());}get state(){return this.getStateAtTime(this.now());}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Pi(e)&&this.setTicksAtTime(e,n)),this;}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time));}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this;}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this;}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this;}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let r=n,s=0;return this._state.forEachBetween(n.time,e+this.sampleTime,t=>{let e=r.time;const n=this._tickOffset.get(t.time);n&&n.time>=r.time&&(s=n.ticks,e=n.time),"started"===r.state&&"started"!==t.state&&(s+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),r=t;}),this._state.remove(i),s;}get ticks(){return this.getTicksAtTime(this.now());}set ticks(t){this.setTicksAtTime(t,this.now());}get seconds(){return this.getSecondsAtTime(this.now());}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e);}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,r=0;return this._state.forEachBetween(e.time,t+this.sampleTime,t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(r=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(r+=t.time-e),i=t;}),this._state.remove(n),r;}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this;}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t);}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),s=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(s);}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e;});let r=null;if(i&&"started"===i.state){const s=Math.max(i.time,t),o=this.frequency.getTicksAtTime(s),a=o-this.frequency.getTicksAtTime(i.time);let h=Math.ceil(a)-a;h=sr(h,1)?0:h;let u=this.frequency.getTimeOfTick(o+h);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)));}catch(t){r=t;break;}u+=this.frequency.getDurationOfTicks(1,u);}}if(r)throw r;return this;}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this;}}class zr extends Pr{constructor(){super($i(zr.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=mr,this._lastUpdate=0,this._state=new Dr("stopped"),this._boundLoop=this._loop.bind(this);const t=$i(zr.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Wr({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,fr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop);}static getDefaults(){return Object.assign(Pr.getDefaults(),{callback:mr,frequency:1,units:"hertz"});}get state(){return this._state.getValueAtTime(this.now());}start(t,e){wi(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this;}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this;}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this;}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()));}set ticks(t){this._tickSource.ticks=t;}get seconds(){return this._tickSource.seconds;}set seconds(t){this._tickSource.seconds=t;}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t);}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this;}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e);}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t);}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n);}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time);}}),this._tickSource.forEachTickBetween(t,e,(t,e)=>{this.callback(t,e);}));}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e);}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this;}}cr.mixin(zr);class qr extends tr{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map(),this._loadingCount=0;const t=$i(qr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror);});}static getDefaults(){return{baseUrl:"",onerror:mr,onload:mr,urls:{}};}has(t){return this._buffers.has(t.toString());}get(t){return Si(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString());}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t();}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded);}add(t,e,n=mr,i=mr){return Ui(e)?this._buffers.set(t.toString(),new gr(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new gr(e,n,i)),this;}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this;}}class Zr extends Mr{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i";}_now(){return this.context.transport.ticks;}_beatsToUnits(t){return this._getPPQ()*t;}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ());}_ticksToUnits(t){return t;}toTicks(){return this.valueOf();}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm());}}class Kr extends Pr{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new or(),this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1;}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this;}cancel(t){return this._events.cancel(this.toSeconds(t)),this;}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback();}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop));}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this;}}hr(t=>{t.draw=new Kr({context:t});}),lr(t=>{t.draw.dispose();});class $r extends tr{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0;}add(t){Si(Pi(t.time),"Events must have a time property"),Si(Pi(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Qr(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this;}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break;}}return this;}get length(){return this._length;}cancel(t){return this.forEachFrom(t,t=>this.remove(t)),this;}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null);}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e);}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0){if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right);}}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right);}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n);}t.dispose();}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i);}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i);}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t));}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event;}}return null;}forEach(t){if(null!==this._root){const e=[];this._root.traverse(t=>e.push(t)),e.forEach(e=>{e.event&&t(e.event);});}return this;}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach(t=>{t.event&&e(t.event);});}return this;}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach(t=>{t.event&&e(t.event);});}return this;}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(t=>t.dispose()),this._root=null,this;}}class Qr{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high;}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t);}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e));}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e);}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t);}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0;}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max));}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t;}isLeftChild(){return null!==this.parent&&this.parent.left===this;}get left(){return this._left;}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax();}get right(){return this._right;}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax();}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null;}}class Jr extends Fr{constructor(){super($i(Jr.getDefaults(),arguments,["volume"])),this.name="Volume";const t=$i(Jr.getDefaults(),arguments,["volume"]);this.input=this.output=new Gr({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,fr(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute;}static getDefaults(){return Object.assign(Fr.getDefaults(),{mute:!1,volume:0});}get mute(){return this.volume.value===-1/0;}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume);}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this;}}class ts extends Fr{constructor(){super($i(ts.getDefaults(),arguments)),this.name="Destination",this.input=new Jr({context:this.context}),this.output=new Gr({context:this.context}),this.volume=this.input.volume;const t=$i(ts.getDefaults(),arguments);Ur(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output];}static getDefaults(){return Object.assign(Fr.getDefaults(),{mute:!1,volume:0});}get mute(){return this.input.mute;}set mute(t){this.input.mute=t;}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Ur(...t),this;}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount;}dispose(){return super.dispose(),this.volume.dispose(),this;}}hr(t=>{t.destination=new ts({context:t});}),lr(t=>{t.destination.dispose();});class es extends tr{constructor(t){super(),this.name="TimelineValue",this._timeline=new or({memory:10}),this._initialValue=t;}set(t,e){return this._timeline.add({value:t,time:e}),this;}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue;}}class ns{constructor(t,e){this.id=ns._eventId++;const n=Object.assign(ns.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time;}static getDefaults(){return{callback:mr,once:!1,time:0};}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id));}dispose(){return this.callback=void 0,this;}}ns._eventId=0;class is extends ns{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(is.getDefaults(),e);this.duration=new Zr(t.context,n.duration).valueOf(),this._interval=new Zr(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart();}static getDefaults(){return Object.assign({},ns.getDefaults(),{duration:1/0,interval:1,once:!1});}invoke(t){this._createEvents(t),super.invoke(t);}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Zr(this.context,this._nextTick).toSeconds()));}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Zr(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Zr(this.context,this._nextTick).toSeconds());}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this;}}class rs extends Pr{constructor(){super($i(rs.getDefaults(),arguments)),this.name="Transport",this._loop=new es(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new or(),this._repeatedEvents=new $r(),this._syncedSignals=[],this._swingAmount=0;const t=$i(rs.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new zr({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),fr(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2;}static getDefaults(){return Object.assign(Pr.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4});}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Zr(this.context,2*this._swingTicks/3).toSeconds()*i;}this._timeline.forEachAtTime(e,e=>e.invoke(t));}schedule(t,e){const n=new ns(this,{callback:t,time:new Mr(this.context,e).toTicks()});return this._addEvent(n,this._timeline);}scheduleRepeat(t,e,n,i=1/0){const r=new is(this,{callback:t,duration:new Ir(this.context,i).toTicks(),interval:new Ir(this.context,e).toTicks(),time:new Mr(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents);}scheduleOnce(t,e){const n=new ns(this,{callback:t,once:!0,time:new Mr(this.context,e).toTicks()});return this._addEvent(n,this._timeline);}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()];}return this;}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id;}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,t=>this.clear(t.id)),this._repeatedEvents.forEachFrom(e,t=>this.clear(t.id)),this;}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new Zr(this.context,e).toSeconds(),this.emit("start",t,e);}),this._clock.on("stop",t=>{this.emit("stop",t);}),this._clock.on("pause",t=>{this.emit("pause",t);});}get state(){return this._clock.getStateAtTime(this.now());}start(t,e){let n;return Pi(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this;}stop(t){return this._clock.stop(t),this;}pause(t){return this._clock.pause(t),this;}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this;}get timeSignature(){return this._timeSignature;}set timeSignature(t){Fi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t;}get loopStart(){return new Ir(this.context,this._loopStart,"i").toSeconds();}set loopStart(t){this._loopStart=this.toTicks(t);}get loopEnd(){return new Ir(this.context,this._loopEnd,"i").toSeconds();}set loopEnd(t){this._loopEnd=this.toTicks(t);}get loop(){return this._loop.get(this.now());}set loop(t){this._loop.set(t,this.now());}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this;}get swing(){return this._swingAmount;}set swing(t){this._swingAmount=t;}get swingSubdivision(){return new Zr(this.context,this._swingTicks).toNotation();}set swingSubdivision(t){this._swingTicks=this.toTicks(t);}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new Zr(this.context,e).toBarsBeatsSixteenths();}set position(t){const e=this.toTicks(t);this.ticks=e;}get seconds(){return this._clock.seconds;}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n;}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart);}return 0;}get ticks(){return this._clock.ticks;}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i));}else this._clock.setTicksAtTime(t,e);}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t));}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t);}get PPQ(){return this._clock.frequency.multiplier;}set PPQ(t){this._clock.frequency.multiplier=t;}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e);}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i;}else e=0;}const n=new Gr(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this;}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1));}return this;}dispose(){return super.dispose(),this._clock.dispose(),_r(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this;}}cr.mixin(rs),hr(t=>{t.transport=new rs({context:t});}),lr(t=>{t.transport.dispose();});class ss extends Fr{constructor(t){super(t),this.input=void 0,this._state=new Dr("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=mr,this._syncedStop=mr,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Jr({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,fr(this,"volume"),this.onstop=t.onstop;}static getDefaults(){return Object.assign(Fr.getDefaults(),{mute:!1,onstop:mr,volume:0});}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now());}get mute(){return this._volume.mute;}set mute(t){this._volume.mute=t;}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime);}start(t,e,n){let i=Mi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i)){if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(Qi(e,0)),t.duration=n?this.toSeconds(n):void 0);const r=this.context.transport.schedule(t=>{this._start(t,e,n);},i);this._scheduled.push(r),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds);}else wi(this.context),this._start(i,e,n);}else Si(nr(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this;}stop(t){let e=Mi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Pi(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t);}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e);}return this;}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this;}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let r;n.duration&&(r=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,r);}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t);},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this;}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this;}dispose(){return super.dispose(),this.onstop=mr,this.unsync(),this._volume.dispose(),this._state.dispose(),this;}}class os extends kr{constructor(){super($i(os.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=$i(os.getDefaults(),arguments,["url","onload"]);Br(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Lr({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new gr(t.url,t.onload,t.onerror),this._internalChannels.push(this._source);}static getDefaults(){return Object.assign(kr.getDefaults(),{url:new gr(),loop:!1,loopEnd:0,loopStart:0,onload:mr,onerror:mr,playbackRate:1});}get fadeIn(){return this._fadeIn;}set fadeIn(t){this._fadeIn=t;}get fadeOut(){return this._fadeOut;}set fadeOut(t){this._fadeOut=t;}get curve(){return this._curve;}set curve(t){this._curve=t;}start(t,e,n,i=1){Si(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(t);this._startGain(r,i),e=this.loop?Qi(e,this.loopStart):Qi(e,0);let s=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;ir(s,t)&&(s=(s-e)%n+e),sr(s,this.buffer.duration)&&(s=0);}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,rr(s,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,s)),Pi(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(r+t);}return this;}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended());}get loopStart(){return this._source.loopStart;}set loopStart(t){this._source.loopStart=this.toSeconds(t);}get loopEnd(){return this._source.loopEnd;}set loopEnd(t){this._source.loopEnd=this.toSeconds(t);}get buffer(){return this._buffer;}set buffer(t){this._buffer.set(t);}get loop(){return this._source.loop;}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop();}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this;}}class as extends Fr{constructor(){super($i(as.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=$i(as.getDefaults(),arguments,["volume"]);this._volume=this.output=new Jr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,fr(this,"volume"),this.mute=t.mute;}static getDefaults(){return Object.assign(Fr.getDefaults(),{mute:!1,volume:0});}open(t){return Vi(this,void 0,void 0,function*(){Si(as.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield as.enumerateDevices();Di(t)?this._device=e[t]:(this._device=e.find(e=>e.label===t||e.deviceId===t),!this._device&&e.length>0&&(this._device=e[0]),Si(Pi(this._device),`No matching device ${t}`));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;const t=this.context.createMediaStreamSource(i);Br(t,this.output),this._mediaStream=t;}return this;});}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach(t=>{t.stop();}),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this;}static enumerateDevices(){return Vi(this,void 0,void 0,function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter(t=>"audioinput"===t.kind);});}get state(){return this._stream&&this._stream.active?"started":"stopped";}get deviceId(){return this._device?this._device.deviceId:void 0;}get groupId(){return this._device?this._device.groupId:void 0;}get label(){return this._device?this._device.label:void 0;}get mute(){return this._volume.mute;}set mute(t){this._volume.mute=t;}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this;}static get supported(){return Pi(navigator.mediaDevices)&&Pi(navigator.mediaDevices.getUserMedia);}}function hs(t,e){return Vi(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,i=new vr(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0);});}class us extends kr{constructor(){super($i(us.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=$i(us.getDefaults(),arguments,["frequency","type"]);Br(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Lr({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Lr({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),fr(this,["frequency","detune"]);}static getDefaults(){return Object.assign(kr.getDefaults(),{detune:0,frequency:440,type:"sine"});}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this;}_stopSource(t){this._oscillator.stop(t);}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this;}get type(){return this._oscillator.type;}set type(t){this._oscillator.type=t;}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this;}}class ls extends ss{constructor(){super($i(ls.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=$i(ls.getDefaults(),arguments,["frequency","type"]);this.frequency=new Vr({context:this.context,units:"frequency",value:t.frequency}),fr(this,"frequency"),this.detune=new Vr({context:this.context,units:"cents",value:t.detune}),fr(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase;}static getDefaults(){return Object.assign(ss.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"});}_start(t){const e=this.toSeconds(t),n=new us({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e);}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e);}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this;}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this;}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this;}_getCachedPeriodicWave(){if("custom"===this._type)return ls._periodicWaveCache.find(t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every((t,e)=>n[e]===t));var e,n;});{const t=ls._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t;}}get type(){return this._type;}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Pi(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave);}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),ls._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),ls._periodicWaveCache.length>100&&ls._periodicWaveCache.shift();}}}get baseType(){return this._type.replace(this.partialCount.toString(),"");}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t;}get partialCount(){return this._partialCount;}set partialCount(t){Ii(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach((t,n)=>e[n]=t),this._partials=Array.from(e),this.type=this._type;}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),r=new Float32Array(n);let s=1;if("custom"===t){if(s=this._partials.length+1,this._partialCount=this._partials.length,n=s,0===this._partials.length)return[i,r];}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(s=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],s=Math.max(s,2),n=s):this._partialCount=0,this._partials=[];}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=s?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t);}0!==a?(i[o]=-a*Math.sin(e*o),r[o]=a*Math.cos(e*o)):(i[o]=0,r[o]=0);}return[i,r];}_inverseFFT(t,e,n){let i=0;const r=t.length;for(let s=0;s<r;s++)i+=t[s]*Math.cos(s*n)+e[s]*Math.sin(s*n);return i;}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let r=0;r<32;r++)n=Math.max(this._inverseFFT(t,e,r/32*i),n);return r=-this._inverseFFT(t,e,this._phase)/n,-1,1,Math.max(Math.min(r,1),-1);var r;}get partials(){return this._partials.slice(0,this.partialCount);}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom");}get phase(){return this._phase*(180/Math.PI);}set phase(t){this._phase=t*Math.PI/180,this.type=this._type;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this;}}ls._periodicWaveCache=[];class cs extends Fr{constructor(){super(Object.assign($i(cs.getDefaults(),arguments,["context"])));}connect(t,e=0,n=0){return Hr(this,t,e,n),this;}}class ds extends cs{constructor(){super(Object.assign($i(ds.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=$i(ds.getDefaults(),arguments,["mapping","length"]);Fi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):"function"==typeof t.mapping&&this.setMap(t.mapping,t.length);}static getDefaults(){return Object.assign(Vr.getDefaults(),{length:1024});}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,r=e;i<r;i++){const e=i/(r-1)*2-1;n[i]=t(e,i);}return this.curve=n,this;}get curve(){return this._shaper.curve;}set curve(t){this._shaper.curve=t;}get oversample(){return this._shaper.oversample;}set oversample(t){Si(["none","2x","4x"].some(e=>e.includes(t)),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t;}dispose(){return super.dispose(),this._shaper.disconnect(),this;}}class ps extends cs{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new ds({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm;}dispose(){return super.dispose(),this._norm.dispose(),this;}}class fs extends Vr{constructor(){super(Object.assign($i(fs.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=$i(fs.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Gr({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0);}static getDefaults(){return Object.assign(Vr.getDefaults(),{value:0});}dispose(){return super.dispose(),this._mult.dispose(),this;}}class _s extends ss{constructor(){super($i(_s.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new ps({context:this.context}),this._modulationNode=new Gr({context:this.context});const t=$i(_s.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ls({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new fs({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),fr(this,["frequency","detune","harmonicity"]);}static getDefaults(){return Object.assign(ls.getDefaults(),{harmonicity:1,modulationType:"square"});}_start(t){this._modulator.start(t),this._carrier.start(t);}_stop(t){this._modulator.stop(t),this._carrier.stop(t);}_restart(t){this._modulator.restart(t),this._carrier.restart(t);}get type(){return this._carrier.type;}set type(t){this._carrier.type=t;}get baseType(){return this._carrier.baseType;}set baseType(t){this._carrier.baseType=t;}get partialCount(){return this._carrier.partialCount;}set partialCount(t){this._carrier.partialCount=t;}get modulationType(){return this._modulator.type;}set modulationType(t){this._modulator.type=t;}get phase(){return this._carrier.phase;}set phase(t){this._carrier.phase=t,this._modulator.phase=t;}get partials(){return this._carrier.partials;}set partials(t){this._carrier.partials=t;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this;}}class ms extends ss{constructor(){super($i(ms.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Gr({context:this.context,gain:0});const t=$i(ms.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ls({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Vr({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ls({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new fs({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new fs({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),fr(this,["modulationIndex","frequency","detune","harmonicity"]);}static getDefaults(){return Object.assign(ls.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"});}_start(t){this._modulator.start(t),this._carrier.start(t);}_stop(t){this._modulator.stop(t),this._carrier.stop(t);}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this;}get type(){return this._carrier.type;}set type(t){this._carrier.type=t;}get baseType(){return this._carrier.baseType;}set baseType(t){this._carrier.baseType=t;}get partialCount(){return this._carrier.partialCount;}set partialCount(t){this._carrier.partialCount=t;}get modulationType(){return this._modulator.type;}set modulationType(t){this._modulator.type=t;}get phase(){return this._carrier.phase;}set phase(t){this._carrier.phase=t,this._modulator.phase=t;}get partials(){return this._carrier.partials;}set partials(t){this._carrier.partials=t;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this;}}class gs extends ss{constructor(){super($i(gs.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Gr({context:this.context,gain:0}),this._thresh=new ds({context:this.context,mapping:t=>t<=0?-1:1});const t=$i(gs.getDefaults(),arguments,["frequency","width"]);this.width=new Vr({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),fr(this,["width","frequency","detune"]);}static getDefaults(){return Object.assign(ss.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2});}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t);}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t);}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t);}get phase(){return this._triangle.phase;}set phase(t){this._triangle.phase=t;}get type(){return"pulse";}get baseType(){return"pulse";}get partials(){return[];}get partialCount(){return 0;}set carrierType(t){this._triangle.type=t;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this;}}class vs extends ss{constructor(){super($i(vs.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=$i(vs.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Vr({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Vr({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,fr(this,["frequency","detune"]);}static getDefaults(){return Object.assign(ls.getDefaults(),{count:3,spread:20,type:"sawtooth"});}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t));}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t));}_restart(t){this._forEach(e=>e.restart(t));}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e);}get type(){return this._type;}set type(t){this._type=t,this._forEach(e=>e.type=t);}get spread(){return this._spread;}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach((t,i)=>t.detune.value=e+n*i);}}get count(){return this._oscillators.length;}set count(t){if(Ii(t,1),this._oscillators.length!==t){this._forEach(t=>t.dispose()),this._oscillators=[];for(let e=0;e<t;e++){const n=new ls({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):mr});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n;}this.spread=this._spread,"started"===this.state&&this._forEach(t=>t.start());}}get phase(){return this._phase;}set phase(t){this._phase=t,this._forEach((t,e)=>t.phase=this._phase+e/this.count*360);}get baseType(){return this._oscillators[0].baseType;}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type;}get partials(){return this._oscillators[0].partials;}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t));}get partialCount(){return this._oscillators[0].partialCount;}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this;}}class ys extends ss{constructor(){super($i(ys.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new fs({context:this.context,value:2});const t=$i(ys.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new gs({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ls({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),fr(this,["modulationFrequency","frequency","detune"]);}static getDefaults(){return Object.assign(ss.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"});}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t);}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t);}_restart(t){this._modulator.restart(t),this._pulse.restart(t);}get type(){return"pwm";}get baseType(){return"pwm";}get partials(){return[];}get partialCount(){return 0;}get phase(){return this._modulator.phase;}set phase(t){this._modulator.phase=t;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this;}}const Ts={am:_s,fat:vs,fm:ms,oscillator:ls,pulse:gs,pwm:ys};class Es extends ss{constructor(){super($i(Es.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=$i(Es.getDefaults(),arguments,["frequency","type"]);this.frequency=new Vr({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Vr({context:this.context,units:"cents",value:t.detune}),fr(this,["frequency","detune"]),this.set(t);}static getDefaults(){return Object.assign(ls.getDefaults(),ms.getDefaults(),_s.getDefaults(),vs.getDefaults(),gs.getDefaults(),ys.getDefaults());}_start(t){this._oscillator.start(t);}_stop(t){this._oscillator.stop(t);}_restart(t){return this._oscillator.restart(t),this;}get type(){let t="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(t=this._sourceType),t+this._oscillator.type;}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t);}get partials(){return this._oscillator.partials;}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t);}get partialCount(){return this._oscillator.partialCount;}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t);}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this;}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=Ts[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout(()=>t.dispose(),this.blockTime);}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n);}}get phase(){return this._oscillator.phase;}set phase(t){this._oscillator.phase=t;}get sourceType(){return this._sourceType;}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm");}_getOscType(t,e){return t instanceof Ts[e];}get baseType(){return this._oscillator.baseType;}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t);}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0;}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0;}set count(t){this._getOscType(this._oscillator,"fat")&&Di(t)&&(this._oscillator.count=t);}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0;}set spread(t){this._getOscType(this._oscillator,"fat")&&Di(t)&&(this._oscillator.spread=t);}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0;}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Ui(t)&&(this._oscillator.modulationType=t);}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0;}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0;}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){return hs(this,t);});}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this;}}function bs(t,e=1/0){const n=new WeakMap();return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this);},set:function(i){Ii(i,t,e),n.set(this,i);}});};}function xs(t,e=1/0){const n=new WeakMap();return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this);},set:function(i){Ii(this.toSeconds(i),t,e),n.set(this,i);}});};}class As extends ss{constructor(){super($i(As.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set();const t=$i(As.getDefaults(),arguments,["url","onload"]);this._buffer=new gr({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut;}static getDefaults(){return Object.assign(ss.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:mr,onerror:mr,playbackRate:1,reverse:!1});}load(t){return Vi(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this;});}_onload(t=mr){t(),this.autostart&&this.start();}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()));}start(t,e,n){return super.start(t,e,n),this;}_start(t,e,n){e=this._loop?Qi(e,this._loopStart):Qi(e,0);const i=this.toSeconds(e),r=n;n=Qi(n,Math.max(this._buffer.duration-i,0));let s=this.toSeconds(n);s/=this._playbackRate,t=this.toSeconds(t);const o=new os({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+s),this._state.setStateAtTime("stopped",t+s,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Mi(r)?o.start(t,i):o.start(t,i,s-this.toSeconds(this.fadeOut));}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach(t=>t.stop(e));}restart(t,e,n){return super.restart(t,e,n),this;}_restart(t,e,n){this._stop(t),this._start(t,e,n);}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e);}return this;}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this;}get loopStart(){return this._loopStart;}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t;});}get loopEnd(){return this._loopEnd;}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t;});}get buffer(){return this._buffer;}set buffer(t){this._buffer.set(t);}get loop(){return this._loop;}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t;}),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time);}}get playbackRate(){return this._playbackRate;}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(t=>t.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e);});}get reverse(){return this._buffer.reverse;}set reverse(t){this._buffer.reverse=t;}get loaded(){return this._buffer.loaded;}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this;}}Xi([xs(0)],As.prototype,"fadeIn",void 0),Xi([xs(0)],As.prototype,"fadeOut",void 0);class Rs extends Fr{constructor(){super($i(Rs.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Vr({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=$i(Rs.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve;}static getDefaults(){return Object.assign(Fr.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5});}get value(){return this.getValueAtTime(this.now());}_getCurve(t,e){if(Ui(t))return t;{let n;for(n in Os)if(Os[n][e]===t)return n;return t;}}_setCurve(t,e,n){if(Ui(n)&&Reflect.has(Os,n)){const i=Os[n];Li(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i;}else{if(!Fi(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n;}}get attackCurve(){return this._getCurve(this._attackCurve,"In");}set attackCurve(t){this._setCurve("_attackCurve","In",t);}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out");}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t);}get decayCurve(){return this._decayCurve;}set decayCurve(t){Si(["linear","exponential"].some(e=>e===t),`Invalid envelope curve: ${t}`),this._decayCurve=t;}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0&&(n=(1-r)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=r&&r<=i[t]){i=this._attackCurve.slice(t),i[0]=r;break;}this._sig.setValueCurveAtTime(i,t,n,e);}if(i&&this.sustain<1){const r=e*this.sustain,s=t+n;this.log("decay",s),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(r,i+s):this._sig.exponentialApproachValueAtTime(r,s,i);}return this;}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Si(Fi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e));}return this;}getValueAtTime(t){return this._sig.getValueAtTime(t);}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this;}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this;}connect(t,e=0,n=0){return Hr(this,t,e,n),this;}asArray(t=1024){return Vi(this,void 0,void 0,function*(){const e=t/this.context.sampleRate,n=new vr(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),s=.1*r,o=r+s,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));return a._sig.toDestination(),a.triggerAttackRelease(e*(i+s)/o,0),(yield n.render()).getChannelData(0);});}dispose(){return super.dispose(),this._sig.dispose(),this;}}Xi([xs(0)],Rs.prototype,"attack",void 0),Xi([xs(0)],Rs.prototype,"decay",void 0),Xi([bs(0,1)],Rs.prototype,"sustain",void 0),Xi([xs(0)],Rs.prototype,"release",void 0);const Os=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=t/10+.83*n;}r[127]=1;const s=[];for(e=0;e<t;e++)s[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n));}function h(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e;}return{bounce:{In:h(a),Out:a},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:h(r)},sine:{In:o,Out:h(o)},step:{In:s,Out:h(s)}};var u;})();class Ss extends Fr{constructor(){super($i(Ss.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=$i(Ss.getDefaults(),arguments);this._volume=this.output=new Jr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,fr(this,"volume");}static getDefaults(){return Object.assign(Fr.getDefaults(),{volume:0});}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this;}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t;}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],r=this.context.transport.schedule(i=>{t[e]=i,n.apply(this,t);},i);this._scheduledEvents.push(r);};}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this;}triggerAttackRelease(t,e,n,i){const r=this.toSeconds(n),s=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+s),this;}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this;}}class Is extends Ss{constructor(){super($i(Is.getDefaults(),arguments));const t=$i(Is.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence;}static getDefaults(){return Object.assign(Ss.getDefaults(),{detune:0,onsilence:mr,portamento:0});}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this;}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this;}setNote(t,e){const n=this.toSeconds(e),i=t instanceof wr?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n);}else this.frequency.setValueAtTime(i,n);return this;}}Xi([xs(0)],Is.prototype,"portamento",void 0);class ws extends Rs{constructor(){super($i(ws.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Gr({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode;}dispose(){return super.dispose(),this._gainNode.dispose(),this;}}class Cs extends Is{constructor(){super($i(Cs.getDefaults(),arguments)),this.name="Synth";const t=$i(Cs.getDefaults(),arguments);this.oscillator=new Es(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new ws(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),fr(this,["oscillator","frequency","detune","envelope"]);}static getDefaults(){return Object.assign(Is.getDefaults(),{envelope:Object.assign(Ji(Rs.getDefaults(),Object.keys(Fr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ji(Es.getDefaults(),[...Object.keys(ss.getDefaults()),"frequency","detune"]),{type:"triangle"})});}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n);}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release));}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t);}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this;}}class Ns extends Fr{constructor(){super($i(Ns.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=$i(Ns.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Lr({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new Lr({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new Lr({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new Lr({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type;}static getDefaults(){return Object.assign(Fr.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0});}get type(){return this._filter.type;}set type(t){Si(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t;}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i;}const n=new Float32Array(t),i=new Float32Array(t),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(e,n,i),n;}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this;}}class Ms extends Fr{constructor(){super($i(Ms.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Gr({context:this.context}),this.output=new Gr({context:this.context}),this._filters=[];const t=$i(Ms.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Vr({context:this.context,units:"positive",value:t.Q}),this.frequency=new Vr({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Vr({context:this.context,units:"cents",value:t.detune}),this.gain=new Vr({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,fr(this,["detune","frequency","gain","Q"]);}static getDefaults(){return Object.assign(Fr.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"});}get type(){return this._type;}set type(t){Si(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach(e=>e.type=t);}get rolloff(){return this._rolloff;}set rolloff(t){const e=Di(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);Si(-1!==i,`rolloff can only be ${n.join(", ")}`),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach(t=>t.disconnect()),this._filters=new Array(i);for(let t=0;t<i;t++){const e=new Ns({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e;}this._internalChannels=this._filters,Ur(this.input,...this._internalChannels,this.output);}getFrequencyResponse(t=128){const e=new Ns({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map(()=>1);return this._filters.forEach(()=>{e.getFrequencyResponse(t).forEach((t,e)=>n[e]*=t);}),e.dispose(),n;}dispose(){return super.dispose(),this._filters.forEach(t=>{t.dispose();}),_r(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this;}}class Ps extends Cs{constructor(){super($i(Ps.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=$i(Ps.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,fr(this,["oscillator","envelope"]);}static getDefaults(){return Ki(Is.getDefaults(),Cs.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05});}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof wr?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this;}dispose(){return super.dispose(),this;}}Xi([bs(0)],Ps.prototype,"octaves",void 0),Xi([xs(0)],Ps.prototype,"pitchDecay",void 0);const Ds=new Set();function Ls(t){Ds.add(t);}function Fs(t,e){const n=`registerProcessor("${t}", ${e})`;Ds.add(n);}Ls('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),Ls("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),Ls("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n"),Fs("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Us extends Ss{constructor(){super($i(Us.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map();const t=$i(Us.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(n=>{const i=parseInt(n,10);if(Si(Bi(n)||Di(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),Bi(n)){const i=new wr(this.context,n).toMidi();e[i]=t.urls[n];}else Di(i)&&isFinite(i)&&(e[i]=t.urls[i]);}),this._buffers=new qr({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload);}static getDefaults(){return Object.assign(Ss.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:mr,onerror:mr,release:.1,urls:{}});}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++;}throw new Error(`No available buffers for note: ${t}`);}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach(t=>{const i=Or(new wr(this.context,t).toFrequency()),r=Math.round(i),s=i-r,o=this._findClosest(r),a=r-o,h=this._buffers.get(a),u=xr(o+s),l=new os({url:h,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);l.start(e,0,h.duration/u,n),Fi(this._activeSources.get(r))||this._activeSources.set(r,[]),this._activeSources.get(r).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(r)){const t=this._activeSources.get(r),e=t.indexOf(l);-1!==e&&t.splice(e,1);}};}),this;}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(t=>{const n=new wr(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach(t=>{t.stop(e);}),this._activeSources.set(n,[]);}}),this;}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach(t=>{for(;t.length;)t.shift().stop(e);}),this;}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this;}triggerAttackRelease(t,e,n,i=1){const r=this.toSeconds(n);return this.triggerAttack(t,r,i),Fi(e)?(Si(Fi(t),"notes must be an array when duration is array"),t.forEach((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,r+this.toSeconds(i));})):this.triggerRelease(t,r+this.toSeconds(e)),this;}add(t,e,n){if(Si(Bi(t)||isFinite(t),`note must be a pitch or midi: ${t}`),Bi(t)){const i=new wr(this.context,t).toMidi();this._buffers.add(i,e,n);}else this._buffers.add(t,e,n);return this;}get loaded(){return this._buffers.loaded;}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(t=>t.dispose());}),this._activeSources.clear(),this;}}Xi([xs(0)],Us.prototype,"attack",void 0),Xi([xs(0)],Us.prototype,"release",void 0);class Bs extends Fr{constructor(){super(Object.assign($i(Bs.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=$i(Bs.getDefaults(),arguments,["pan"]);this.pan=new Lr({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",fr(this,"pan");}static getDefaults(){return Object.assign(Fr.getDefaults(),{pan:0,channelCount:1});}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this;}}Fs("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class Gs extends Fr{constructor(){super($i(Gs.getDefaults(),arguments,["channels"])),this.name="Split";const t=$i(Gs.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter];}static getDefaults(){return Object.assign(Fr.getDefaults(),{channels:2});}dispose(){return super.dispose(),this._splitter.disconnect(),this;}}class ks extends Fr{constructor(){super($i(ks.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=$i(ks.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Gr({context:this.context}),this._split=new Gs({context:this.context,channels:t.channels}),this.input.connect(this._split),Ii(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type;}static getDefaults(){return Object.assign(Fr.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1});}getValue(){return this._analysers.forEach((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n);}),1===this.channels?this._buffers[0]:this._buffers;}get size(){return this._analysers[0].frequencyBinCount;}set size(t){this._analysers.forEach((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t);});}get channels(){return this._analysers.length;}get type(){return this._type;}set type(t){Si("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t;}get smoothing(){return this._analysers[0].smoothingTimeConstant;}set smoothing(t){this._analysers.forEach(e=>e.smoothingTimeConstant=t);}dispose(){return super.dispose(),this._analysers.forEach(t=>t.disconnect()),this._split.dispose(),this._gain.dispose(),this;}}class Xs extends Fr{constructor(){super($i(Xs.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new ks({context:this.context,size:256,type:"waveform"});}dispose(){return super.dispose(),this._analyser.dispose(),this;}}class Vs extends Xs{constructor(){super($i(Vs.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=$i(Vs.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new ks({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange;}static getDefaults(){return Object.assign(Xs.getDefaults(),{smoothing:.8,normalRange:!1,channels:1});}getLevel(){return Ni("'getLevel' has been changed to 'getValue'"),this.getValue();}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map(t=>{const e=t.reduce((t,e)=>t+e*e,0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:br(this._rms);});return 1===this.channels?e[0]:e;}get channels(){return this._analyser.channels;}dispose(){return super.dispose(),this._analyser.dispose(),this;}}class Hs extends Fr{constructor(){super($i(Hs.getDefaults(),arguments,["solo"])),this.name="Solo";const t=$i(Hs.getDefaults(),arguments,["solo"]);this.input=this.output=new Gr({context:this.context}),Hs._allSolos.has(this.context)||Hs._allSolos.set(this.context,new Set()),Hs._allSolos.get(this.context).add(this),this.solo=t.solo;}static getDefaults(){return Object.assign(Fr.getDefaults(),{solo:!1});}get solo(){return this._isSoloed();}set solo(t){t?this._addSolo():this._removeSolo(),Hs._allSolos.get(this.context).forEach(t=>t._updateSolo());}get muted(){return 0===this.input.gain.value;}_addSolo(){Hs._soloed.has(this.context)||Hs._soloed.set(this.context,new Set()),Hs._soloed.get(this.context).add(this);}_removeSolo(){Hs._soloed.has(this.context)&&Hs._soloed.get(this.context).delete(this);}_isSoloed(){return Hs._soloed.has(this.context)&&Hs._soloed.get(this.context).has(this);}_noSolos(){return!Hs._soloed.has(this.context)||Hs._soloed.has(this.context)&&0===Hs._soloed.get(this.context).size;}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0;}dispose(){return super.dispose(),Hs._allSolos.get(this.context).delete(this),this._removeSolo(),this;}}Hs._allSolos=new Map(),Hs._soloed=new Map();class js extends Fr{constructor(){super($i(js.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=$i(js.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Bs({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Jr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,fr(this,["pan","volume"]);}static getDefaults(){return Object.assign(Fr.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1});}get mute(){return this._volume.mute;}set mute(t){this._volume.mute=t;}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this;}}class Ys extends Fr{constructor(){super($i(Ys.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=$i(Ys.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Hs({solo:t.solo,context:this.context}),this._panVol=this.output=new js({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),fr(this,["pan","volume"]);}static getDefaults(){return Object.assign(Fr.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1});}get solo(){return this._solo.solo;}set solo(t){this._solo.solo=t;}get muted(){return this._solo.muted||this.mute;}get mute(){return this._panVol.mute;}set mute(t){this._panVol.mute=t;}_getBus(t){return Ys.buses.has(t)||Ys.buses.set(t,new Gr({context:this.context})),Ys.buses.get(t);}send(t,e=0){const n=this._getBus(t),i=new Gr({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i;}receive(t){return this._getBus(t).connect(this),this;}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this;}}Ys.buses=new Map();class Ws extends Fr{constructor(){super(...arguments),this.name="Listener",this.positionX=new Lr({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Lr({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Lr({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Lr({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Lr({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Lr({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Lr({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Lr({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Lr({context:this.context,param:this.context.rawContext.listener.upZ});}static getDefaults(){return Object.assign(Fr.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0});}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this;}}hr(t=>{t.listener=new Ws({context:t});}),lr(t=>{t.listener.dispose();}),Er().transport,Er().destination,Er().destination,Er().listener,Er().draw,Er();var zs=setTimeout;function qs(t){return Boolean(t&&void 0!==t.length);}function Zs(){}function Ks(t){if(!(this instanceof Ks))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],no(t,this);}function $s(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,Ks._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value);}catch(t){return void Js(e.promise,t);}Qs(e.promise,i);}else(1===t._state?Qs:Js)(e.promise,t._value);})):t._deferreds.push(e);}function Qs(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof Ks)return t._state=3,t._value=e,void to(t);if("function"==typeof n)return void no((i=n,r=e,function(){i.apply(r,arguments);}),t);}t._state=1,t._value=e,to(t);}catch(e){Js(t,e);}var i,r;}function Js(t,e){t._state=2,t._value=e,to(t);}function to(t){2===t._state&&0===t._deferreds.length&&Ks._immediateFn(function(){t._handled||Ks._unhandledRejectionFn(t._value);});for(var e=0,n=t._deferreds.length;e<n;e++)$s(t,t._deferreds[e]);t._deferreds=null;}function eo(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n;}function no(t,e){var n=!1;try{t(function(t){n||(n=!0,Qs(e,t));},function(t){n||(n=!0,Js(e,t));});}catch(t){if(n)return;n=!0,Js(e,t);}}Ks.prototype.catch=function(t){return this.then(null,t);},Ks.prototype.then=function(t,e){var n=new this.constructor(Zs);return $s(this,new eo(t,e,n)),n;},Ks.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n;});},function(n){return e.resolve(t()).then(function(){return e.reject(n);});});},Ks.all=function(t){return new Ks(function(e,n){if(!qs(t))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function s(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,function(e){s(t,e);},n);}i[t]=o,0==--r&&e(i);}catch(t){n(t);}}for(var o=0;o<i.length;o++)s(o,i[o]);});},Ks.allSettled=function(t){return new this(function(e,n){if(!t||void 0===t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function s(t,n){if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if("function"==typeof o)return void o.call(n,function(e){s(t,e);},function(n){i[t]={status:"rejected",reason:n},0==--r&&e(i);});}i[t]={status:"fulfilled",value:n},0==--r&&e(i);}for(var o=0;o<i.length;o++)s(o,i[o]);});},Ks.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Ks?t:new Ks(function(e){e(t);});},Ks.reject=function(t){return new Ks(function(e,n){n(t);});},Ks.race=function(t){return new Ks(function(e,n){if(!qs(t))return n(new TypeError("Promise.race accepts an array"));for(var i=0,r=t.length;i<r;i++)Ks.resolve(t[i]).then(e,n);});},Ks._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t);}||function(t){zs(t,0);},Ks._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t);};const io=Ks;var ro=n(418),so=n.n(ro);if("undefined"==typeof globalThis&&("undefined"!=typeof self?self.globalThis=self:void 0!==n.g&&(n.g.globalThis=n.g)),globalThis.Promise||(globalThis.Promise=io),Object.assign||(Object.assign=so()),Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime();}),!globalThis.performance||!globalThis.performance.now){var oo=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-oo;};}for(var ao=Date.now(),ho=["ms","moz","webkit","o"],uo=0;uo<ho.length&&!globalThis.requestAnimationFrame;++uo){var lo=ho[uo];globalThis.requestAnimationFrame=globalThis[lo+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[lo+"CancelAnimationFrame"]||globalThis[lo+"CancelRequestAnimationFrame"];}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(t){if("function"!=typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+ao-e;return n<0&&(n=0),ao=e,globalThis.self.setTimeout(function(){ao=Date.now(),t(performance.now());},n);}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(t){return clearTimeout(t);}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1;}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t;}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array);var co,po,fo,_o,mo,go,vo,yo,To,Eo,bo,xo,Ao,Ro,Oo,So,Io,wo,Co,No=/iPhone/i,Mo=/iPod/i,Po=/iPad/i,Do=/\biOS-universal(?:.+)Mac\b/i,Lo=/\bAndroid(?:.+)Mobile\b/i,Fo=/Android/i,Uo=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Bo=/Silk/i,Go=/Windows Phone/i,ko=/\bWindows(?:.+)ARM\b/i,Xo=/BlackBerry/i,Vo=/BB10/i,Ho=/Opera Mini/i,jo=/\b(CriOS|Chrome)(?:.+)Mobile/i,Yo=/Mobile(?:.+)Firefox\b/i,Wo=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream;},zo=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,i=n.split("[FBAN");void 0!==i[1]&&(n=i[0]),void 0!==(i=n.split("Twitter"))[1]&&(n=i[0]);var r=function(t){return function(e){return e.test(t);};}(n),s={apple:{phone:r(No)&&!r(Go),ipod:r(Mo),tablet:!r(No)&&(r(Po)||Wo(e))&&!r(Go),universal:r(Do),device:(r(No)||r(Mo)||r(Po)||r(Do)||Wo(e))&&!r(Go)},amazon:{phone:r(Uo),tablet:!r(Uo)&&r(Bo),device:r(Uo)||r(Bo)},android:{phone:!r(Go)&&r(Uo)||!r(Go)&&r(Lo),tablet:!r(Go)&&!r(Uo)&&!r(Lo)&&(r(Bo)||r(Fo)),device:!r(Go)&&(r(Uo)||r(Bo)||r(Lo)||r(Fo))||r(/\bokhttp\b/i)},windows:{phone:r(Go),tablet:r(ko),device:r(Go)||r(ko)},other:{blackberry:r(Xo),blackberry10:r(Vo),opera:r(Ho),firefox:r(Yo),chrome:r(jo),device:r(Xo)||r(Vo)||r(Ho)||r(Yo)||r(jo)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s;}(globalThis.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(co||(co={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(po||(po={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(fo||(fo={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(_o||(_o={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(mo||(mo={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(go||(go={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(vo||(vo={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(yo||(yo={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(To||(To={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(Eo||(Eo={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(bo||(bo={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(xo||(xo={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(Ao||(Ao={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(Ro||(Ro={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(Oo||(Oo={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(So||(So={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(Io||(Io={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(wo||(wo={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(Co||(Co={}));var qo,Zo,Ko,$o,Qo,Jo,ta,ea,na,ia,ra,sa,oa,aa,ha,ua,la,ca,da,pa={MIPMAP_TEXTURES:xo.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:wo.NONE,SPRITE_MAX_TEXTURES:function(t){var e,n=!0;(zo.tablet||zo.phone)&&(zo.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(n=!1),zo.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(n=!1));return n?32:4;}(),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Oo.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:bo.CLAMP,SCALE_MODE:Eo.LINEAR,PRECISION_VERTEX:So.HIGH,PRECISION_FRAGMENT:zo.apple.device?So.HIGH:So.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!zo.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},fa=n(718),_a=n.n(fa),ma=n(187),ga=n.n(ma),va=n(310);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(qo||(qo={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(Zo||(Zo={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(Ko||(Ko={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}($o||($o={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(Qo||(Qo={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(Jo||(Jo={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(ta||(ta={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(ea||(ea={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(na||(na={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(ia||(ia={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(ra||(ra={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(sa||(sa={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(oa||(oa={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(aa||(aa={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(ha||(ha={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(ua||(ua={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(la||(la={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(ca||(ca={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(da||(da={}));var ya={parse:va.Qc,format:va.WU,resolve:va.DB};pa.RETINA_PREFIX=/@([0-9\.]+)x/,pa.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ta,Ea=!1,ba={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function xa(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e;}function Aa(t){var e=t.toString(16);return"#"+("000000".substring(0,6-e.length)+e);}function Ra(t){return"string"==typeof t&&"#"===(t=ba[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),parseInt(t,16);}var Oa=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[$o.NORMAL_NPM]=$o.NORMAL,t[$o.ADD_NPM]=$o.ADD,t[$o.SCREEN_NPM]=$o.SCREEN,e[$o.NORMAL]=$o.NORMAL_NPM,e[$o.ADD]=$o.ADD_NPM,e[$o.SCREEN]=$o.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i;}();function Sa(t,e){return Oa[e?1:0][t];}function Ia(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,i=t>>8&255,r=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(r*e+.5|0);}function wa(t,e,n,i){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(i||void 0===i)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n;}function Ca(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array";}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null;}function Na(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16);}function Ma(t){return!(t&t-1||!t);}function Pa(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1;}function Da(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var s=r-(n=e+n>r?r-e:n);for(i=e;i<s;++i)t[i]=t[i+n];t.length=s;}}function La(t){return 0===t?0:t<0?-1:1;}Float32Array,Uint32Array,Int32Array,Uint8Array;var Fa=0;function Ua(){return++Fa;}var Ba={};function Ga(t,e,n){if(void 0===n&&(n=3),!Ba[e]){var i=new Error().stack;void 0===i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),Ba[e]=!0;}}var ka,Xa={},Va=Object.create(null),Ha=Object.create(null),ja=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||pa.RESOLUTION,this.resize(t,e);}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height);},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution);},t.prototype.destroy=function(){this.context=null,this.canvas=null;},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width;},set:function(t){this.canvas.width=Math.round(t);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height;},set:function(t){this.canvas.height=Math.round(t);},enumerable:!1,configurable:!0}),t;}();function Ya(t,e){var n=pa.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1;}var Wa,za=2*Math.PI,qa=180/Math.PI,Za=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC";}(Wa||(Wa={}));var Ka=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e;}return t.prototype.clone=function(){return new t(this.x,this.y);},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this;},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t;},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y;},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this;},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]";},t;}(),$a=[new Ka(),new Ka(),new Ka(),new Ka()],Qa=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=Wa.RECT;}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0);},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height);},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this;},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t;},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height;},t.prototype.intersects=function(t,e){if(!e){var n=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=n)return!1;var i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i;}var r=this.left,s=this.right,o=this.top,a=this.bottom;if(s<=r||a<=o)return!1;var h=$a[0].set(t.left,t.top),u=$a[1].set(t.left,t.bottom),l=$a[2].set(t.right,t.top),c=$a[3].set(t.right,t.bottom);if(l.x<=h.x||u.y<=h.y)return!1;var d=Math.sign(e.a*e.d-e.b*e.c);if(0===d)return!1;if(e.apply(h,h),e.apply(u,u),e.apply(l,l),e.apply(c,c),Math.max(h.x,u.x,l.x,c.x)<=r||Math.min(h.x,u.x,l.x,c.x)>=s||Math.max(h.y,u.y,l.y,c.y)<=o||Math.min(h.y,u.y,l.y,c.y)>=a)return!1;var p=d*(u.y-h.y),f=d*(h.x-u.x),_=p*r+f*o,m=p*s+f*o,g=p*r+f*a,v=p*s+f*a;if(Math.max(_,m,g,v)<=p*h.x+f*h.y||Math.min(_,m,g,v)>=p*c.x+f*c.y)return!1;var y=d*(h.y-l.y),T=d*(l.x-h.x),E=y*r+T*o,b=y*s+T*o,x=y*r+T*a,A=y*s+T*a;return!(Math.max(E,b,x,A)<=y*h.x+T*h.y||Math.min(E,b,x,A)>=y*c.x+T*c.y);},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this;},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this;},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this;},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this;},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]";},t;}(),Ja=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=Wa.CIRC;}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius);},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n;},t.prototype.getBounds=function(){return new Qa(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius);},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]";},t;}(),th=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=Wa.ELIP;}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height);},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1;},t.prototype.getBounds=function(){return new Qa(this.x-this.width,this.y-this.height,this.width,this.height);},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]";},t;}(),eh=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var r=[],s=0,o=i.length;s<o;s++)r.push(i[s].x,i[s].y);i=r;}this.points=i,this.type=Wa.POLY,this.closeStroke=!0;}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e;},t.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,s=i-1;r<i;s=r++){var o=this.points[2*r],a=this.points[2*r+1],h=this.points[2*s],u=this.points[2*s+1];a>e!=u>e&&t<(e-a)/(u-a)*(h-o)+o&&(n=!n);}return n;},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce(function(t,e){return t+", "+e;},"")+"]";},t;}(),nh=function(){function t(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=Wa.RREC;}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius);},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var i=t-(this.x+n),r=e-(this.y+n),s=n*n;if(i*i+r*r<=s)return!0;if((i=t-(this.x+this.width-n))*i+r*r<=s)return!0;if(i*i+(r=e-(this.y+this.height-n))*r<=s)return!0;if((i=t-(this.x+n))*i+r*r<=s)return!0;}return!1;},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]";},t;}(),ih=function(){function t(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this._x=n,this._y=i,this.cb=t,this.scope=e;}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y);},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this;},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this;},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t;},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y;},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]";},Object.defineProperty(t.prototype,"x",{get:function(){return this._x;},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope));},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y;},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope));},enumerable:!1,configurable:!0}),t;}(),rh=function(){function t(t,e,n,i,r,s){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=s;}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5];},t.prototype.set=function(t,e,n,i,r,s){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=s,this;},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n;},t.prototype.apply=function(t,e){e=e||new Ka();var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e;},t.prototype.applyInverse=function(t,e){e=e||new Ka();var n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e;},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this;},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this;},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,s=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=s*e-this.ty*n,this.ty=s*n+this.ty*e,this;},t.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this;},t.prototype.setTransform=function(t,e,n,i,r,s,o,a,h){return this.a=Math.cos(o+h)*r,this.b=Math.sin(o+h)*r,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this;},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d;}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this;},t.prototype.decompose=function(t){var e=this.a,n=this.b,i=this.c,r=this.d,s=t.pivot,o=-Math.atan2(-i,r),a=Math.atan2(n,e),h=Math.abs(o+a);return h<1e-5||Math.abs(za-h)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(s.x*e+s.y*i),t.position.y=this.ty+(s.x*n+s.y*r),t;},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,s=t*i-e*n;return this.a=i/s,this.b=-e/s,this.c=-n/s,this.d=t/s,this.tx=(n*this.ty-i*r)/s,this.ty=-(t*this.ty-e*r)/s,this;},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this;},t.prototype.clone=function(){var e=new t();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e;},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t;},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this;},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]";},Object.defineProperty(t,"IDENTITY",{get:function(){return new t();},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t();},enumerable:!1,configurable:!0}),t;}(),sh=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],oh=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ah=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],hh=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],uh=[],lh=[],ch=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];uh.push(e);for(var n=0;n<16;n++)for(var i=ch(sh[t]*sh[n]+ah[t]*oh[n]),r=ch(oh[t]*sh[n]+hh[t]*oh[n]),s=ch(sh[t]*ah[n]+ah[t]*hh[n]),o=ch(oh[t]*ah[n]+hh[t]*hh[n]),a=0;a<16;a++)if(sh[a]===i&&oh[a]===r&&ah[a]===s&&hh[a]===o){e.push(a);break;}}for(t=0;t<16;t++){var h=new rh();h.set(sh[t],oh[t],ah[t],hh[t],0,0),lh.push(h);}}();var dh={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return sh[t];},uY:function(t){return oh[t];},vX:function(t){return ah[t];},vY:function(t){return hh[t];},inv:function(t){return 8&t?15&t:7&-t;},add:function(t,e){return uh[t][e];},sub:function(t,e){return uh[t][dh.inv(e)];},rotate180:function(t){return 4^t;},isVertical:function(t){return 2==(3&t);},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?dh.S:dh.N:2*Math.abs(e)<=Math.abs(t)?t>0?dh.E:dh.W:e>0?t>0?dh.SE:dh.SW:t>0?dh.NE:dh.NW;},matrixAppendRotationInv:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=lh[dh.inv(e)];r.tx=n,r.ty=i,t.append(r);}},ph=function(){function t(){this.worldTransform=new rh(),this.localTransform=new rh(),this.position=new ih(this.onChange,this,0,0),this.scale=new ih(this.onChange,this,1,1),this.pivot=new ih(this.onChange,this,0,0),this.skew=new ih(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0;}return t.prototype.onChange=function(){this._localID++;},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++;},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]";},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1);},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++;}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++;},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation;},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew());},enumerable:!1,configurable:!0}),t.IDENTITY=new t(),t;}();pa.SORTABLE_CHILDREN=!1;var fh=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1;}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY;},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0;},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Qa.EMPTY:((t=t||new Qa(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t);},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y);},t.prototype.addPointMatrix=function(t,e){var n=t.a,i=t.b,r=t.c,s=t.d,o=t.tx,a=t.ty,h=n*e.x+r*e.y+o,u=i*e.x+s*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u);},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,n=o<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[2])<e?s:e,n=(o=t[3])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[4])<e?s:e,n=(o=t[5])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[6])<e?s:e,n=(o=t[7])<n?o:n,i=s>i?s:i,r=o>r?o:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r;},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r);},t.prototype.addFrameMatrix=function(t,e,n,i,r){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,_=s*e+a*n+u,m=o*e+h*n+l;c=_<c?_:c,d=m<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*i+a*n+u)<c?_:c,d=(m=o*i+h*n+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*e+a*r+u)<c?_:c,d=(m=o*e+h*r+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*i+a*r+u)<c?_:c,d=(m=o*i+h*r+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f;},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<n;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,r=u<r?u:r,s=h>s?h:s,o=u>o?u:o;}this.minX=i,this.minY=r,this.maxX=s,this.maxY=o;},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i);},t.prototype.addVerticesMatrix=function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty,d=this.minX,p=this.minY,f=this.maxX,_=this.maxY,m=n;m<i;m+=2){var g=e[m],v=e[m+1],y=o*g+h*v+l,T=u*v+a*g+c;d=Math.min(d,y-r),f=Math.max(f,y+r),p=Math.min(p,T-s),_=Math.max(_,T+s);}this.minX=d,this.minY=p,this.maxX=f,this.maxY=_;},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r;},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u;}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY);},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u;}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e);},t.prototype.addFramePad=function(t,e,n,i,r,s){t-=r,e-=s,n+=r,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i;},t;}(),_h=function(t,e){return _h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},_h(t,e);};function mh(t,e){function n(){this.constructor=t;}_h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var gh,vh,yh,Th,Eh,bh,xh,Ah,Rh,Oh,Sh,Ih,wh,Ch,Nh,Mh,Ph,Dh,Lh,Fh=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new ph(),e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new fh(),e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e;}return mh(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r));}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed;},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform);},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Qa()),e=this._boundsRect),this._bounds.getRectangle(e);},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Qa()),t=this._localBoundsRect),this._localBounds||(this._localBounds=new fh());var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,s;},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e);},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n);},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t;},e.prototype.setTransform=function(t,e,n,i,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this;},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners();},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Uh()),this.tempDisplayObjectParent;},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t;},e.prototype.disableTempParent=function(t){this.parent=t;},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x;},set:function(t){this.transform.position.x=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y;},set:function(t){this.transform.position.y=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position;},set:function(t){this.transform.position.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale;},set:function(t){this.transform.scale.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot;},set:function(t){this.transform.pivot.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew;},set:function(t){this.transform.skew.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation;},set:function(t){this.transform.rotation=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*qa;},set:function(t){this.transform.rotation=t*Za;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex;},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent;}while(t);return!0;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask;},set:function(t){var e;this._mask!==t&&(this._mask&&((e=this._mask.maskObject||this._mask)._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1)),this._mask=t,this._mask&&(0===(e=this._mask.maskObject||this._mask)._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++));},enumerable:!1,configurable:!0}),e;}(_a()),Uh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e;}return mh(e,t),e;}(Fh);function Bh(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex;}Fh.prototype.displayObjectUpdateTransform=Fh.prototype.updateTransform,function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(gh||(gh={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(vh||(vh={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(yh||(yh={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(Th||(Th={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(Eh||(Eh={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(bh||(bh={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(xh||(xh={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(Ah||(Ah={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(Rh||(Rh={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(Oh||(Oh={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(Sh||(Sh={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(Ih||(Ih={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(wh||(wh={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(Ch||(Ch={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(Nh||(Nh={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(Mh||(Mh={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(Ph||(Ph={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(Dh||(Dh={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(Lh||(Lh={}));var Gh=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=pa.SORTABLE_CHILDREN,e.sortDirty=!1,e;}return mh(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this);}return e[0];},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t;},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i);}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e;},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Da(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e);},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t];},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],s=this.children.indexOf(r);if(-1===s)return null;r.parent=null,r.transform._parentID=-1,Da(this.children,s,1),this._boundsID++,this.onChildrenChange(s),r.emit("removed",this),this.emit("childRemoved",r,this,s);}return e[0];},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Da(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e;},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var s=0;s<n.length;++s)n[s].parent=null,n[s].transform&&(n[s].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),s=0;s<n.length;++s)n[s].emit("removed",this),this.emit("childRemoved",n[s],this,s);return n;}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.");},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0);}t&&this.children.length>1&&this.children.sort(Bh),this.sortDirty=!1;},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform();}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds);}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds);}this._bounds.updateID=this._boundsID;},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform();}return i;},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var n=t.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var i,r;if(this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&n.intersects(i,r))this._render(t);else if(this.cullArea)return;for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s],h=a.cullable;a.cullable=h||!this.cullArea,a.render(t),a.cullable=h;}}},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t);}},e.prototype.renderAdvanced=function(t){var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);}var r=e&&this._enabledFilters&&this._enabledFilters.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Ph.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t),i=0;for(var s=this.children.length;i<s;++i)this.children[i].render(t);}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop();},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e);},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width;},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height;},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t;},enumerable:!1,configurable:!0}),e;}(Fh);Gh.prototype.containerUpdateTransform=Gh.prototype.updateTransform,Fh.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var kh,Xh=function(){function t(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(zo.tablet||zo.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1);}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility;},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook();}),document.body.appendChild(e),this._hookDiv=e;},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null);},t.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div));},t.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div));},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n]);}},t.prototype.update=function(){var t=performance.now();if(!(zo.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,i=e.top,r=e.width,s=e.height,o=this.renderer,a=o.width,h=o.height,u=o.resolution,l=r/a*u,c=s/h*u,d=this.div;d.style.left=n+"px",d.style.top=i+"px",d.style.width=a+"px",d.style.height=h+"px";for(var p=0;p<this.children.length;p++){var f=this.children[p];if(f.renderId!==this.renderId)f._accessibleActive=!1,Da(this.children,p,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,p--;else{d=f._accessibleDiv;var _=f.hitArea,m=f.worldTransform;f.hitArea?(d.style.left=(m.tx+_.x*m.a)*l+"px",d.style.top=(m.ty+_.y*m.d)*c+"px",d.style.width=_.width*m.a*l+"px",d.style.height=_.height*m.d*c+"px"):(_=f.getBounds(),this.capHitArea(_),d.style.left=_.x*l+"px",d.style.top=_.y*c+"px",d.style.width=_.width*l+"px",d.style.height=_.height*c+"px",d.title!==f.accessibleTitle&&null!==f.accessibleTitle&&(d.title=f.accessibleTitle),d.getAttribute("aria-label")!==f.accessibleHint&&null!==f.accessibleHint&&d.setAttribute("aria-label",f.accessibleHint)),f.accessibleTitle===d.title&&f.tabIndex===d.tabIndex||(d.title=f.accessibleTitle,d.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(d));}}this.renderId++;}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex;},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,i=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>i&&(t.height=i-t.y);},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex;},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"click",i),e.dispatchEvent(n,"pointertap",i),e.dispatchEvent(n,"tap",i);},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseover",i);},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseout",i);},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate();},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate();},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null;},t;}();pa.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY";}(kh||(kh={}));var Vh=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=0),void 0===i&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i;}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e;},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e;},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this;},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e;},t;}(),Hh=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Vh(null,null,1/0),this.deltaMS=1/pa.TARGET_FPMS,this.elapsedMS=1/pa.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)));};}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick));},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null);},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start();},t.prototype.add=function(t,e,n){return void 0===n&&(n=kh.NORMAL),this._addListener(new Vh(t,e,n));},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=kh.NORMAL),this._addListener(new Vh(t,e,n,!0));},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break;}n=e,e=e.next;}t.previous||t.connect(n);}else t.connect(n);return this._startIfPossible(),this;},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this;},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t;},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded());},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded());},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null;}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS;}this.deltaMS=e,this.deltaTime=this.deltaMS*pa.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded();}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t;},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS;},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,pa.TARGET_FPMS);this._maxElapsedMS=1/n;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0;},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3);}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t();e.autoStart=!0,e._protected=!0;}return t._shared;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t();e.autoStart=!0,e._protected=!0;}return t._system;},enumerable:!1,configurable:!0}),t;}(),jh=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,kh.LOW);},get:function(){return this._ticker;}}),this.stop=function(){e._ticker.stop();},this.start=function(){e._ticker.start();},this._ticker=null,this.ticker=t.sharedTicker?Hh.shared:new Hh(),t.autoStart&&this.start();},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy();}},t;}(),Yh=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ka(),this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0;}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier;},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e);},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0;},t.prototype.reset=function(){this.isPrimary=!1;},t;}(),Wh=function(t,e){return Wh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Wh(t,e);},zh=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null;}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget;},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null;},t;}(),qh=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE;}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t;},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags;},set:function(t){this._flags=t;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER);},set:function(e){this._doSet(t.FLAGS.OVER,e);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN);},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN);},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e);},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t;}(),Zh=function(){function t(){this._tempPoint=new Ka();}return t.prototype.recursiveFindHit=function(t,e,n,i,r){if(!e||!e.visible)return!1;var s=t.data.global,o=!1,a=r=e.interactive||r,h=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(s,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?o=!0:(i=!1,h=!1)),a=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(s)||(i=!1)),h&&e.interactiveChildren&&e.children)for(var u=e.children,l=u.length-1;l>=0;l--){var c=u[l],d=this.recursiveFindHit(t,c,n,i,a);if(d){if(!c.parent)continue;a=!1,d&&(t.target&&(i=!1),o=!0);}}return r&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(s)&&(o=!0),e.interactive&&(o&&!t.target&&(t.target=e),n&&n(t,e,!!o))),o;},t.prototype.findHit=function(t,e,n,i){this.recursiveFindHit(t,e,n,i,!1);},t;}(),Kh={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor;},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null);},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers;},_trackedPointers:void 0};Fh.mixin(Kh);var $h={target:null,data:{global:null}},Qh=function(t){function e(e,n){var i=t.call(this)||this;return n=n||{},i.renderer=e,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new Yh(),i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new zh(),i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new Zh(),i._tempDisplayObject=new Uh(),i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i;}return function(t,e){function n(){this.constructor=t;}Wh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker;},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject;},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return $h.target=null,$h.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive($h,e,null,!0),$h.target;},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener();},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(Hh.system.add(this.tickerUpdate,this,kh.INTERACTION),this.tickerAdded=!0);},e.prototype.removeTickerListener=function(){this.tickerAdded&&(Hh.system.remove(this.tickerUpdate,this),this.tickerAdded=!1);},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0;}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1;}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update());},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0);}}this.setCursorMode(this.cursor);}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n);}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t);}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n));},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n});},e.prototype.mapPositionToPoint=function(t,e,n){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var r=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*r,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)*r;},e.prototype.processInteractive=function(t,e,n,i){var r=this.search.findHit(t,e,n,i),s=this.delayedEvents;if(!s.length)return r;t.stopPropagationHint=!1;var o=s.length;this.delayedEvents=[];for(var a=0;a<o;a++){var h=s[a],u=h.displayObject,l=h.eventString,c=h.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,l,c);}return r;},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,i=0;i<n;i++){var r=e[i],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);if(o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===r.pointerType)this.emit("touchstart",o);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;this.emit(a?"rightdown":"mousedown",this.eventData);}}}},e.prototype.processPointerDown=function(t,e,n){var i=t.data,r=t.data.identifier;if(n)if(e.trackedPointers[r]||(e.trackedPointers[r]=new qh(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var s=2===i.button;s?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,s?"rightdown":"mousedown",t);}},e.prototype.onPointerComplete=function(t,e,n){for(var i=this.normalizeToPointerData(t),r=i.length,s=t.target!==this.interactionDOMElement?"outside":"",o=0;o<r;o++){var a=i[o],h=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,n,e||!s),this.emit(e?"pointercancel":"pointerup"+s,u),"mouse"===a.pointerType||"pen"===a.pointerType){var l=2===a.button;this.emit(l?"rightup"+s:"mouseup"+s,u);}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+s,u),this.releaseInteractionDataForPointerId(a.pointerId));}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel);},e.prototype.processPointerCancel=function(t,e){var n=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t));},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp);},e.prototype.processPointerUp=function(t,e,n){var i=t.data,r=t.data.identifier,s=e.trackedPointers[r],o="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,h=!1;if(a){var u=2===i.button,l=qh.FLAGS,c=u?l.RIGHT_DOWN:l.LEFT_DOWN,d=void 0!==s&&s.flags&c;n?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),h=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),s&&(u?s.rightDown=!1:s.leftDown=!1);}n?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),s&&(a&&!h||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),s.over=!1))):s&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),s&&s.none&&delete e.trackedPointers[r];},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,i=0;i<n;i++){var r=e[i],s=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,s);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===r.pointerType&&this.emit("touchmove",o),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mousemove",o);}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor);}},e.prototype.processPointerMove=function(t,e,n){var i=t.data,r="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType;s&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),s&&this.dispatchEvent(e,"mousemove",t));},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier);}},e.prototype.processPointerOverOut=function(t,e,n){var i=t.data,r=t.data.identifier,s="mouse"===i.pointerType||"pen"===i.pointerType,o=e.trackedPointers[r];n&&!o&&(o=e.trackedPointers[r]=new qh(r)),void 0!==o&&(n&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),s&&this.delayDispatchEvent(e,"mouseover",t)),s&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),s&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[r]));},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i);},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new Yh()).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e;},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e));},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t;},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];void 0===r.button&&(r.button=t.touches.length?1:0),void 0===r.buttons&&(r.buttons=t.touches.length?1:0),void 0===r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===r.width&&(r.width=r.radiusX||1),void 0===r.height&&(r.height=r.radiusY||1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="touch"),void 0===r.pointerId&&(r.pointerId=r.identifier||0),void 0===r.pressure&&(r.pressure=r.force||.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),void 0===r.layerX&&(r.layerX=r.offsetX=r.clientX),void 0===r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r);}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof globalThis.PointerEvent)){var s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s);}else e.push(t);return e;},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null;},e;}(_a()),Jh=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0;}return t.prototype.emit=function(t,e,n,i,r,s,o,a){if(arguments.length>8)throw new Error("max arguments reached");var h=this,u=h.name,l=h.items;this._aliasCount++;for(var c=0,d=l.length;c<d;c++)l[c][u](t,e,n,i,r,s,o,a);return l===this.items&&this._aliasCount--,this;},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0));},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this;},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this;},t.prototype.contains=function(t){return-1!==this.items.indexOf(t);},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this;},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null;},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name;},enumerable:!1,configurable:!0}),t;}();Object.defineProperties(Jh.prototype,{dispatch:{value:Jh.prototype.emit},run:{value:Jh.prototype.emit}}),pa.PREFER_ENV=zo.any?qo.WEBGL:qo.WEBGL2,pa.STRICT_TEXTURE_CACHE=!1;var tu=[];function eu(t,e){if(!t)return null;var n="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(n=i[1].toLowerCase());}for(var r=tu.length-1;r>=0;--r){var s=tu[r];if(s.test&&s.test(t,n))return new s(t,e);}throw new Error("Unrecognized source type to auto-detect Resource");}var nu=function(t,e){return nu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},nu(t,e);};function iu(t,e){function n(){this.constructor=t;}nu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var ru=function(){return ru=Object.assign||function(t){for(var e,n=arguments,i=1,r=arguments.length;i<r;i++)for(var s in e=n[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t;},ru.apply(this,arguments);},su=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Jh("setRealSize"),this.onUpdate=new Jh("update"),this.onError=new Jh("onError");}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height);},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t);},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e));},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height;},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit();},t.prototype.load=function(){return Promise.resolve(this);},Object.defineProperty(t.prototype,"width",{get:function(){return this._width;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height;},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1;},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null);},t.test=function(t,e){return!1;},t;}(),ou=function(t){function e(e,n){var i=this,r=n||{},s=r.width,o=r.height;if(!s||!o)throw new Error("BufferResource width or height invalid");return(i=t.call(this,s,o)||this).data=e,i;}return iu(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===oa.UNPACK);var r=e.realWidth,s=e.realHeight;return n.width===r&&n.height===s?i.texSubImage2D(e.target,0,0,0,r,s,e.format,n.type,this.data):(n.width=r,n.height=s,i.texImage2D(e.target,0,n.internalFormat,r,s,0,e.format,n.type,this.data)),!0;},e.prototype.dispose=function(){this.data=null;},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array;},e;}(su),au={scaleMode:ia.NEAREST,format:Jo.RGBA,alphaMode:oa.NPM},hu=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i=t.call(this)||this,r=(n=n||{}).alphaMode,s=n.mipmap,o=n.anisotropicLevel,a=n.scaleMode,h=n.width,u=n.height,l=n.wrapMode,c=n.format,d=n.type,p=n.target,f=n.resolution,_=n.resourceOptions;return!e||e instanceof su||((e=eu(e,_)).internal=!0),i.resolution=f||pa.RESOLUTION,i.width=Math.round((h||0)*i.resolution)/i.resolution,i.height=Math.round((u||0)*i.resolution)/i.resolution,i._mipmap=void 0!==s?s:pa.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==o?o:pa.ANISOTROPIC_LEVEL,i._wrapMode=l||pa.WRAP_MODE,i._scaleMode=void 0!==a?a:pa.SCALE_MODE,i.format=c||Jo.RGBA,i.type=d||ea.UNSIGNED_BYTE,i.target=p||ta.TEXTURE_2D,i.alphaMode=void 0!==r?r:oa.UNPACK,i.uid=Ua(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=h>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i;}return iu(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap;},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode;},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode;},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++);},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this;},e.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n);},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this;},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Ma(this.realWidth)&&Ma(this.realHeight);},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this;},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this;},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this));},e.prototype.onError=function(t){this.emit("error",this,t);},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ha[this.cacheId],delete Va[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0;},e.prototype.dispose=function(){this.emit("dispose",this);},e.prototype.castToBaseTexture=function(){return this;},e.from=function(t,n,i){void 0===i&&(i=pa.STRICT_TEXTURE_CACHE);var r="string"==typeof t,s=null;if(r)s=t;else{if(!t._pixiId){var o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+Ua();}s=t._pixiId;}var a=Ha[s];if(r&&i&&!a)throw new Error('The cacheId "'+s+'" does not exist in BaseTextureCache.');return a||((a=new e(t,n)).cacheId=s,e.addToCache(a,s)),a;},e.fromBuffer=function(t,n,i,r){t=t||new Float32Array(n*i*4);var s=new ou(t,{width:n,height:i}),o=t instanceof Float32Array?ea.FLOAT:ea.UNSIGNED_BYTE;return new e(s,Object.assign(au,r||{width:n,height:i,type:o}));},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ha[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Ha[e]=t);},e.removeFromCache=function(t){if("string"==typeof t){var e=Ha[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ha[t],e;}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Ha[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t;}return null;},e._globalBatch=0,e;}(_a()),uu=function(t){function e(e,n){var i=this,r=n||{},s=r.width,o=r.height;(i=t.call(this,s,o)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<e;a++){var h=new hu();i.items.push(h),i.itemDirtyIds.push(-2);}return i.length=e,i._load=null,i.baseTexture=null,i;}return iu(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof su?this.addResourceAt(t[n],n):this.addResourceAt(eu(t[n],e),n));},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null;},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this;},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e);},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e);},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map(function(t){return t.resource;}).filter(function(t){return t;}).map(function(t){return t.load();});return this._load=Promise.all(e).then(function(){var e=t.items[0],n=e.realWidth,i=e.realHeight;return t.resize(n,i),Promise.resolve(t);}),this._load;},e;}(su),lu=function(t){function e(e,n){var i,r,s=this,o=n||{},a=o.width,h=o.height;return Array.isArray(e)?(i=e,r=e.length):r=e,s=t.call(this,r,{width:a,height:h})||this,i&&s.initFromArray(i,n),s;}return iu(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this;},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ta.TEXTURE_2D_ARRAY;},e.prototype.upload=function(t,e,n){var i=this,r=i.length,s=i.itemDirtyIds,o=i.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var h=0;h<r;h++){var u=o[h];s[h]<u.dirtyId&&(s[h]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source));}return!0;},e;}(uu),cu=function(t){function e(e){var n=this,i=e,r=i.naturalWidth||i.videoWidth||i.width,s=i.naturalHeight||i.videoHeight||i.height;return(n=t.call(this,r,s)||this).source=e,n.noSubImage=!1,n;}return iu(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=globalThis.location),0===t.indexOf("data:"))return"";e=e||globalThis.location,ka||(ka=document.createElement("a")),ka.href=t;var n=ya.parse(ka.href),i=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&i&&n.protocol===e.protocol?"":"anonymous";}(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous");},e.prototype.upload=function(t,e,n,i){var r=t.gl,s=e.realWidth,o=e.realHeight;if((i=i||this.source)instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1;}else if(i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===oa.UNPACK),this.noSubImage||e.target!==r.TEXTURE_2D||n.width!==s||n.height!==o?(n.width=s,n.height=o,r.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,n.type,i),!0;},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),t.prototype.update.call(this);}},e.prototype.dispose=function(){this.source=null;},e;}(su),du=function(t){function e(e){return t.call(this,e)||this;}return iu(e,t),e.test=function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement;},e;}(cu),pu=function(t){function e(n,i){var r=this,s=i||{},o=s.width,a=s.height,h=s.autoLoad,u=s.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");r=t.call(this,6,{width:o,height:a})||this;for(var l=0;l<e.SIDES;l++)r.items[l].target=ta.TEXTURE_CUBE_MAP_POSITIVE_X+l;return r.linkBaseTexture=!1!==u,n&&r.initFromArray(n,i),!1!==h&&r.load(),r;}return iu(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ta.TEXTURE_CUBE_MAP;},e.prototype.addBaseTextureAt=function(t,e,n){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e);}else t.target=ta.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this;},e.prototype.upload=function(t,n,i){for(var r=this.itemDirtyIds,s=0;s<e.SIDES;s++){var o=this.items[s];r[s]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(t,o,i),r[s]=o.dirtyId):r[s]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),r[s]=-1));}return!0;},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES;},e.SIDES=6,e;}(uu),fu=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image();cu.crossOrigin(r,e,n.crossorigin),r.src=e,e=r;}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:pa.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i;}return iu(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise(function(t,n){var i=e.source;e.url=i.src;var r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e));};i.complete&&i.src?r():(i.onload=r,i.onerror=function(t){n(t),e.onError.emit(t);});})),this._load;},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var n=globalThis.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then(function(t){return t.blob();}).then(function(i){return n(i,0,0,e.width,e.height,{premultiplyAlpha:t.alphaMode===oa.UNPACK?"premultiply":"none"});}).then(function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t));}),this._process;},e.prototype.upload=function(e,n,i){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,i,this.bitmap),!this.preserveBitmap){var r=!0,s=n._glTextures;for(var o in s){var a=s[o];if(a!==i&&a.dirtyId!==n.dirtyId){r=!1;break;}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null);}return!0;},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null;},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement;},e;}(cu),_u=function(t){function e(e,n){var i=this;return n=n||{},(i=t.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=e,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,!1!==n.autoLoad&&i.load(),i;}return iu(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise(function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t);},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)));}t._loadSvg();})),this._load;},e.prototype._loadSvg=function(){var t=this,e=new Image();cu.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n));},e.onload=function(){if(t._resolve){var n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var r=n*t.scale,s=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(r=t._overrideWidth||t._overrideHeight/i*n,s=t._overrideHeight||t._overrideWidth/n*i),r=Math.round(r),s=Math.round(s);var o=t.source;o.width=r,o.height=s,o._pixiId="canvas_"+Ua(),o.getContext("2d").drawImage(e,0,0,n,i,0,0,r,s),t._resolve(),t._resolve=null;}};},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i;},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null;},e.test=function(t,n){return"svg"===n||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&e.SVG_XML.test(t);},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e;}(cu),mu=function(t){function e(n,i){var r=this;if(i=i||{},!(n instanceof HTMLVideoElement)){var s=document.createElement("video");s.setAttribute("preload","auto"),s.setAttribute("webkit-playsinline",""),s.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var o=n[0].src||n[0];cu.crossOrigin(s,o,i.crossorigin);for(var a=0;a<n.length;++a){var h=document.createElement("source"),u=n[a],l=u.src,c=u.mime,d=(l=l||n[a]).split("?").shift().toLowerCase(),p=d.slice(d.lastIndexOf(".")+1);c=c||e.MIME_TYPES[p]||"video/"+p,h.src=l,h.type=c,s.appendChild(h);}n=s;}return(r=t.call(this,n)||this).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==i.autoPlay,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),!1!==i.autoLoad&&r.load(),r;}return iu(e,t),e.prototype.update=function(e){if(!this.destroyed){var n=Hh.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0);}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(function(n){t.valid?n(t):(t._resolve=n,e.load());}),this._load;},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t);},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2;},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState;},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Hh.shared.add(this.update,this),this._isConnectedToTicker=!0);},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Hh.shared.remove(this.update,this),this._isConnectedToTicker=!1);},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play();},e.prototype.dispose=function(){this._isConnectedToTicker&&(Hh.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this);},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate;},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Hh.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Hh.shared.add(this.update,this),this._isConnectedToTicker=!0));},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS;},set:function(t){t!==this._updateFPS&&(this._updateFPS=t);},enumerable:!1,configurable:!0}),e.test=function(t,n){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1;},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e;}(cu),gu=function(t){function e(e){return t.call(this,e)||this;}return iu(e,t),e.test=function(t){return!!globalThis.createImageBitmap&&t instanceof ImageBitmap;},e;}(cu);tu.push(fu,gu,du,mu,_u,ou,pu,lu);var vu={__proto__:null,Resource:su,BaseImageResource:cu,INSTALLED:tu,autoDetectResource:eu,AbstractMultiResource:uu,ArrayResource:lu,BufferResource:ou,CanvasResource:du,CubeResource:pu,ImageResource:fu,SVGResource:_u,VideoResource:mu,ImageBitmapResource:gu},yu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this;}return iu(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===oa.UNPACK);var r=e.realWidth,s=e.realHeight;return n.width===r&&n.height===s?i.texSubImage2D(e.target,0,0,0,r,s,e.format,n.type,this.data):(n.width=r,n.height=s,i.texImage2D(e.target,0,n.internalFormat,r,s,0,e.format,n.type,this.data)),!0;},e;}(ou),Tu=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Jh("disposeFramebuffer"),this.multisample=ca.NONE;}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0];},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new hu(null,{scaleMode:ia.NEAREST,resolution:1,mipmap:sa.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this;},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new hu(new yu(null,{width:this.width,height:this.height}),{scaleMode:ia.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:sa.OFF,format:Jo.DEPTH_COMPONENT,type:ea.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this;},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this;},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this;},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r);}this.depthTexture&&(r=this.depthTexture.resolution,this.depthTexture.setSize(t/r,e/r));}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1);},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat);},t;}(),Eu=function(t){function e(e){void 0===e&&(e={});var n=this;if("number"==typeof e){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];e={width:i,height:r,scaleMode:s,resolution:o};}return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:ca.NONE,(n=t.call(this,null,e)||this).mipmap=sa.OFF,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new Tu(n.realWidth,n.realHeight).addColorTexture(0,n),n.framebuffer.multisample=e.multisample,n.maskStack=[],n.filterStack=[{}],n;}return iu(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height);},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this);},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null;},e;}(hu),bu=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8);}return t.prototype.set=function(t,e,n){var i=e.width,r=e.height;if(n){var s=t.width/2/i,o=t.height/2/r,a=t.x/i+s,h=t.y/r+o;n=dh.add(n,dh.NW),this.x0=a+s*dh.uX(n),this.y0=h+o*dh.uY(n),n=dh.add(n,2),this.x1=a+s*dh.uX(n),this.y1=h+o*dh.uY(n),n=dh.add(n,2),this.x2=a+s*dh.uX(n),this.y2=h+o*dh.uY(n),n=dh.add(n,2),this.x3=a+s*dh.uX(n),this.y3=h+o*dh.uY(n);}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3;},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]";},t;}(),xu=new bu();function Au(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){};}var Ru=function(t){function e(n,i,r,s,o,a){var h=t.call(this)||this;if(h.noFrame=!1,i||(h.noFrame=!0,i=new Qa(0,0,1,1)),n instanceof e&&(n=n.baseTexture),h.baseTexture=n,h._frame=i,h.trim=s,h.valid=!1,h._uvs=xu,h.uvMatrix=null,h.orig=r||i,h._rotate=Number(o||0),!0===o)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=a?new Ka(a.x,a.y):new Ka(0,0),h._updateID=0,h.textureCacheIds=[],n.valid?h.noFrame?n.valid&&h.onBaseTextureUpdated(n):h.frame=i:n.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&n.on("update",h.onBaseTextureUpdated,h),h;}return iu(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update();},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs();}else this.frame=this._frame;this.emit("update",this);},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&Va[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy();}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null;}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null;},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i;},e.prototype.updateUvs=function(){this._uvs===xu&&(this._uvs=new bu()),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++;},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=pa.STRICT_TEXTURE_CACHE);var r="string"==typeof t,s=null;if(r)s=t;else if(t instanceof hu){if(!t.cacheId){var o=n&&n.pixiIdPrefix||"pixiid";t.cacheId=o+"-"+Ua(),hu.addToCache(t,t.cacheId);}s=t.cacheId;}else t._pixiId||(o=n&&n.pixiIdPrefix||"pixiid",t._pixiId=o+"_"+Ua()),s=t._pixiId;var a=Va[s];if(r&&i&&!a)throw new Error('The cacheId "'+s+'" does not exist in TextureCache.');return a||t instanceof hu?!a&&t instanceof hu&&(a=new e(t),e.addToCache(a,s)):(n.resolution||(n.resolution=Ya(t)),(a=new e(new hu(t,n))).baseTexture.cacheId=s,hu.addToCache(a.baseTexture,s),e.addToCache(a,s)),a;},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},null==n?void 0:n.resourceOptions),r=e.from(t,Object.assign({resourceOptions:i},n),!1),s=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):s.load().then(function(){return Promise.resolve(r);});},e.fromBuffer=function(t,n,i,r){return new e(hu.fromBuffer(t,n,i,r));},e.fromLoader=function(t,n,i,r){var s=new hu(t,Object.assign({scaleMode:pa.SCALE_MODE,resolution:Ya(n)},r)),o=s.resource;o instanceof fu&&(o.url=n);var a=new e(s);return i||(i=n),hu.addToCache(a.baseTexture,i),e.addToCache(a,i),i!==n&&(hu.addToCache(a.baseTexture,n),e.addToCache(a,n)),a.baseTexture.valid?Promise.resolve(a):new Promise(function(t){a.baseTexture.once("loaded",function(){return t(a);});});},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Va[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Va[e]=t);},e.removeFromCache=function(t){if("string"==typeof t){var e=Va[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Va[t],e;}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Va[t.textureCacheIds[i]]===t&&delete Va[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t;}return null;},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame;},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,i=t.width,r=t.height,s=e+i>this.baseTexture.width,o=n+r>this.baseTexture.height;if(s||o){var a=s&&o?"and":"or",h="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+n+" + "+r+" = "+(n+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+h+" "+a+" "+u);}this.valid=i&&r&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate;},set:function(t){this._rotate=t,this.valid&&this.updateUvs();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height;},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture;},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new hu()),Au(e._EMPTY),Au(e._EMPTY.baseTexture)),e._EMPTY;},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=16,t.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),e._WHITE=new e(new hu(new du(t))),Au(e._WHITE),Au(e._WHITE.baseTexture);}return e._WHITE;},enumerable:!1,configurable:!0}),e;}(_a()),Ou=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i;}return iu(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample;},set:function(t){this.framebuffer.multisample=t;},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var i=this.baseTexture.resolution,r=Math.round(t*i)/i,s=Math.round(e*i)/i;this.valid=r>0&&s>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=s,n&&this.baseTexture.resize(r,s),this.updateUvs();},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1));},e.create=function(t){for(var n=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=n[r];return"number"==typeof t&&(Ga("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new Eu(t));},e;}(Ru),Su=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0;}return t.prototype.createTexture=function(t,e,n){void 0===n&&(n=ca.NONE);var i=new Eu(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new Ou(i);},t.prototype.getOptimalTexture=function(t,e,n,i){var r;void 0===n&&(n=1),void 0===i&&(i=ca.NONE),t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?r=i>1?-i:-1:(r=((65535&(t=Na(t)))<<16|65535&(e=Na(e)))>>>0,i>1&&(r+=4294967296*i)),this.texturePool[r]||(this.texturePool[r]=[]);var s=this.texturePool[r].pop();return s||(s=this.createTexture(t,e,i)),s.filterPoolKey=r,s.setResolution(n),s;},t.prototype.getFilterTexture=function(t,e,n){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||ca.NONE);return i.filterFrame=t.filterFrame,i;},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t);},t.prototype.returnFilterTexture=function(t){this.returnTexture(t);},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0);}this.texturePool={};},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[];}this._pixelsWidth=t.width,this._pixelsHeight=t.height;}},t.SCREEN_KEY=-1,t;}(),Iu=function(){function t(t,e,n,i,r,s,o){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=ea.FLOAT),this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=s,this.instance=o;}return t.prototype.destroy=function(){this.buffer=null;},t.from=function(e,n,i,r,s){return new t(e,n,i,r,s);},t;}(),wu=0,Cu=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=wu++,this.disposeRunner=new Jh("disposeBuffer");}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++;},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1);},t.prototype.destroy=function(){this.dispose(),this.data=null;},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===da.ELEMENT_ARRAY_BUFFER;},set:function(t){this.type=t?da.ELEMENT_ARRAY_BUFFER:da.ARRAY_BUFFER;},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e);},t;}(),Nu={Float32Array,Uint32Array,Int32Array,Uint8Array},Mu={5126:4,5123:2,5121:1},Pu=0,Du={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Lu=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Pu++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Jh("disposeGeometry"),this.refCount=0;}return t.prototype.addAttribute=function(t,e,n,i,r,s,o,a){if(void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Cu||(e instanceof Array&&(e=new Float32Array(e)),e=new Cu(e));var h=t.split("|");if(h.length>1){for(var u=0;u<h.length;u++)this.addAttribute(h[u],e,n,i,r);return this;}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Iu(l,n,i,r,s,o,a),this.instanced=this.instanced||a,this;},t.prototype.getAttribute=function(t){return this.attributes[t];},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer];},t.prototype.addIndex=function(t){return t instanceof Cu||(t instanceof Array&&(t=new Uint16Array(t)),t=new Cu(t)),t.type=da.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this;},t.prototype.getIndex=function(){return this.indexBuffer;},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],i=new Cu();for(t in this.attributes){var r=this.attributes[t],s=this.buffers[r.buffer];e.push(s.data),n.push(r.size*Mu[r.type]/4),r.buffer=0;}for(i.data=function(t,e){for(var n=0,i=0,r={},s=0;s<t.length;s++)i+=e[s],n+=t[s].length;var o=new ArrayBuffer(4*n),a=null,h=0;for(s=0;s<t.length;s++){var u=e[s],l=t[s],c=Ca(l);r[c]||(r[c]=new Nu[c](o)),a=r[c];for(var d=0;d<l.length;d++)a[(d/u|0)*i+h+d%u]=l[d];h+=u;}return new Float32Array(o);}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this;},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size);}return 0;},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1);},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null;},t.prototype.clone=function(){for(var e=new t(),n=0;n<this.buffers.length;n++)e.buffers[n]=new Cu(this.buffers[n].data.slice(0));for(var n in this.attributes){var i=this.attributes[n];e.attributes[n]=new Iu(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance);}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=da.ELEMENT_ARRAY_BUFFER),e;},t.merge=function(e){for(var n,i=new t(),r=[],s=[],o=[],a=0;a<e.length;a++){n=e[a];for(var h=0;h<n.buffers.length;h++)s[h]=s[h]||0,s[h]+=n.buffers[h].data.length,o[h]=0;}for(a=0;a<n.buffers.length;a++)r[a]=new Du[Ca(n.buffers[a].data)](s[a]),i.buffers[a]=new Cu(r[a]);for(a=0;a<e.length;a++)for(n=e[a],h=0;h<n.buffers.length;h++)r[h].set(n.buffers[h].data,o[h]),o[h]+=n.buffers[h].data.length;if(i.attributes=n.attributes,n.indexBuffer){i.indexBuffer=i.buffers[n.buffers.indexOf(n.indexBuffer)],i.indexBuffer.type=da.ELEMENT_ARRAY_BUFFER;var u=0,l=0,c=0,d=0;for(a=0;a<n.buffers.length;a++)if(n.buffers[a]!==n.indexBuffer){d=a;break;}for(var a in n.attributes){var p=n.attributes[a];(0|p.buffer)===d&&(l+=p.size*Mu[p.type]/4);}for(a=0;a<e.length;a++){var f=e[a].indexBuffer.data;for(h=0;h<f.length;h++)i.indexBuffer.data[h+c]+=u;u+=e[a].buffers[d].data.length/l,c+=f.length;}}return i;},t;}(),Fu=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e;}return iu(e,t),e;}(Lu),Uu=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Cu(e.vertices),e.uvBuffer=new Cu(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e;}return iu(e,t),e.prototype.map=function(t,e){var n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this;},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this;},e;}(Lu),Bu=0,Gu=function(){function t(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Bu++,this.static=!!e,this.ubo=!!n,t instanceof Cu?(this.buffer=t,this.buffer.type=da.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Cu(new Float32Array(1)),this.buffer.type=da.UNIFORM_BUFFER,this.autoManage=!0));}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update();},t.prototype.add=function(e,n,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(n,i);},t.from=function(e,n,i){return new t(e,n,i);},t.uboFrom=function(e,n){return new t(e,null==n||n,!0);},t;}(),ku=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ca.NONE,this.sourceFrame=new Qa(),this.destinationFrame=new Qa(),this.bindingSourceFrame=new Qa(),this.bindingDestinationFrame=new Qa(),this.filters=[],this.transform=null;}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null;},t;}(),Xu=[new Ka(),new Ka(),new Ka(),new Ka()],Vu=new rh(),Hu=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Su(),this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Fu(),this.quadUv=new Uu(),this.tempRect=new Qa(),this.activeState={},this.globalUniforms=new Gu({outputFrame:new Qa(),inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1;}return t.prototype.push=function(t,e){for(var n,i,r=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new ku(),a=this.renderer.renderTexture,h=e[0].resolution,u=e[0].multisample,l=e[0].padding,c=e[0].autoFit,d=null===(n=e[0].legacy)||void 0===n||n,p=1;p<e.length;p++){var f=e[p];h=Math.min(h,f.resolution),u=Math.min(u,f.multisample),l=this.useMaxPadding?Math.max(l,f.padding):l+f.padding,c=c&&f.autoFit,d=d||null===(i=f.legacy)||void 0===i||i;}1===s.length&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(o),o.resolution=h,o.multisample=u,o.legacy=d,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(l);var _=this.tempRect.copyFrom(a.sourceFrame);r.projection.transform&&this.transformAABB(Vu.copyFrom(r.projection.transform).invert(),_),c?(o.sourceFrame.fit(_),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(_)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,u),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var m=this.tempRect;m.x=0,m.y=0,m.width=o.sourceFrame.width,m.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=r.projection.transform,r.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,m),r.framebuffer.clear(0,0,0,0);},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var r=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],s[0]=Math.round(r[0]*e.resolution),s[1]=Math.round(r[1]*e.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=e.sourceFrame.width*r[2]-.5*s[2],o[3]=e.sourceFrame.height*r[3]-.5*s[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp;}this.globalUniforms.update();var h=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,h.renderTexture,aa.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var c=0;for(c=0;c<n.length-1;++c){1===c&&e.multisample>1&&((l=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),n[c].apply(this,u,l,aa.CLEAR,e);var d=u;u=l,l=d;}n[c].apply(this,u,h.renderTexture,aa.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(l);}e.clear(),this.statePool.push(e);},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=aa.CLEAR);var n=this.renderer,i=n.renderTexture,r=n.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var s=this.tempRect;s.x=0,s.y=0,s.width=t.filterFrame.width,s.height=t.filterFrame.height,i.bind(t,t.filterFrame,s);}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&r.stateId||this.forceClear;(e===aa.CLEAR||e===aa.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0);},t.prototype.applyFilter=function(t,e,n,i){var r=this.renderer;r.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(Qo.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(Qo.TRIANGLE_STRIP));},t.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,i=n.sourceFrame,r=n.destinationFrame,s=e._texture.orig,o=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(rh.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/s.width,1/s.height),o.translate(e.anchor.x,e.anchor.y),o;},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1);},t.prototype.getOptimalFilterTexture=function(t,e,n,i){return void 0===n&&(n=1),void 0===i&&(i=ca.NONE),this.texturePool.getOptimalTexture(t,e,n,i);},t.prototype.getFilterTexture=function(t,e,n){if("number"==typeof t){var i=t;t=e,e=i;}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||ca.NONE);return r.filterFrame=t.filterFrame,r;},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t);},t.prototype.emptyPool=function(){this.texturePool.clear(!0);},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view);},t.prototype.transformAABB=function(t,e){var n=Xu[0],i=Xu[1],r=Xu[2],s=Xu[3];n.set(e.left,e.top),i.set(e.left,e.bottom),r.set(e.right,e.top),s.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(r,r),t.apply(s,s);var o=Math.min(n.x,i.x,r.x,s.x),a=Math.min(n.y,i.y,r.y,s.y),h=Math.max(n.x,i.x,r.x,s.x),u=Math.max(n.y,i.y,r.y,s.y);e.x=o,e.y=a,e.width=h-o,e.height=u-a;},t.prototype.roundFrame=function(t,e,n,i,r){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(r){var s=r.a,o=r.b,a=r.c,h=r.d;if((Math.abs(o)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(h)>1e-4))return;}(r=r?Vu.copyFrom(r):Vu.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t);}},t;}(),ju=function(){function t(t){this.renderer=t;}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null;},t.prototype.start=function(){},t.prototype.stop=function(){this.flush();},t.prototype.render=function(t){},t;}(),Yu=function(){function t(t){this.renderer=t,this.emptyRenderer=new ju(t),this.currentRenderer=this.emptyRenderer;}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start());},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer);},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer);},t.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i);},t.prototype.boundArray=function(t,e,n,i){for(var r=t.elements,s=t.ids,o=t.count,a=0,h=0;h<o;h++){var u=r[h],l=u._batchLocation;if(l>=0&&l<i&&e[l]===u)s[h]=l;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==n||c._batchLocation!==a){s[h]=a,u._batchLocation=a,e[a]=u;break;}a++;}}},t.prototype.destroy=function(){this.renderer=null;},t;}(),Wu=0,zu=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1);}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost();},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Wu++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext();},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Wu++,this.renderer.runners.contextChange.emit(t);},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e);},t.prototype.createContext=function(t,e){var n;if(pa.PREFER_ENV>=qo.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl;},t.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")});},t.prototype.handleContextLost=function(t){t.preventDefault();},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl);},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext();},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush();},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly");},t;}(),qu=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ca.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0;},Zu=new Qa(),Ku=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Tu(10,10),this.msaaSamples=null;}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Qa(),this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;pa.PREFER_ENV===qo.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t);}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1);}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES);},t.prototype.bind=function(t,e,n){void 0===n&&(n=0);var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=n),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var o=t.colorTextures[s];this.renderer.texture.unbind(o.parentTextureArray||o);}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>n,h=e.height>>n,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,h);}else a=t.width>>n,h=t.height>>n,this.setViewport(0,0,a,h);}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height);},t.prototype.setViewport=function(t,e,n,i){var r=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),r.width===n&&r.height===i&&r.x===t&&r.y===e||(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i));},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height};},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,n,i,r){void 0===r&&(r=Ko.COLOR|Ko.DEPTH);var s=this.gl;s.clearColor(t,e,n,i),s.clear(r);},t.prototype.initFramebuffer=function(t){var e=this.gl,n=new qu(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n;},t.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,r=i.length;e.drawBuffers||(r=Math.min(r,1));for(var s=0;s<r;s++){var o=i[s],a=o.parentTextureArray||o;this.renderer.texture.bind(a,0);}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0);},t.prototype.updateFramebuffer=function(t,e){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures,s=r.length;n.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],a=0;a<s;a++){var h=r[a],u=h.parentTextureArray||h;this.renderer.texture.bind(u,0),0===a&&i.msaaBuffer||(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,h.target,u._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+a));}if(o.length>1&&n.drawBuffers(o),t.depthTexture&&this.writeDepthTexture){var l=t.depthTexture;this.renderer.texture.bind(l,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e);}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil));},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture;},t.prototype.detectSamples=function(t){var e=this.msaaSamples,n=ca.NONE;if(t<=1||null===e)return n;for(var i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break;}return 1===n&&(n=ca.NONE),n;},t.prototype.blit=function(t,e,n){var i=this,r=i.current,s=i.renderer,o=i.gl,a=i.CONTEXT_UID;if(2===s.context.webGLVersion&&r){var h=r.glFramebuffers[a];if(h){if(!t){if(!h.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;h.blitFramebuffer||(h.blitFramebuffer=new Tu(r.width,r.height),h.blitFramebuffer.addColorTexture(0,u)),(t=h.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++);}e||((e=Zu).width=r.width,e.height=r.height),n||(n=e);var l=e.width===n.width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR);}}},t.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose();}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t);},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,i=t.height,r=this.gl,s=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,s),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,n,i):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=s,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,s);}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Qa();},t.prototype.destroy=function(){this.renderer=null;},t;}(),$u={5126:4,5123:2,5121:1},Qu=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={};}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;pa.PREFER_ENV===qo.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES();},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t);},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t);}):(this.hasVao=!1,t.createVertexArray=function(){return null;},t.bindVertexArray=function(){return null;},t.deleteVertexArray=function(){return null;});}if(2!==e.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e);},t.drawElementsInstanced=function(t,e,n,r,s){return i.drawElementsInstancedANGLE(t,e,n,r,s);},t.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r);}):this.hasInstance=!1;}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex;},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},r=!0);var s=i[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?n.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers();},t.prototype.reset=function(){this.unbind();},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var i=t.buffers[n];e.update(i);}},t.prototype.checkCompatibility=function(t,e){var n=t.attributes,i=e.attributeData;for(var r in i)if(!n[r])throw new Error('shader and geometry incompatible, geometry missing the "'+r+'" attribute');},t.prototype.getSignature=function(t,e){var n=t.attributes,i=e.attributeData,r=["g",t.id];for(var s in n)i[s]&&r.push(s,i[s].location);return r.join("-");},t.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var i=this.gl,r=this.CONTEXT_UID,s=this.renderer.buffer,o=e.program;o.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var a=this.getSignature(t,o),h=t.glVertexArrayObjects[this.CONTEXT_UID],u=h[a];if(u)return h[o.id]=u,u;var l=t.buffers,c=t.attributes,d={},p={};for(var f in l)d[f]=0,p[f]=0;for(var f in c)!c[f].size&&o.attributeData[f]?c[f].size=o.attributeData[f].size:c[f].size||console.warn("PIXI Geometry attribute '"+f+"' size cannot be determined (likely the bound shader does not have the attribute)"),d[c[f].buffer]+=c[f].size*$u[c[f].type];for(var f in c){var _=c[f],m=_.size;void 0===_.stride&&(d[_.buffer]===m*$u[_.type]?_.stride=0:_.stride=d[_.buffer]),void 0===_.start&&(_.start=p[_.buffer],p[_.buffer]+=m*$u[_.type]);}u=i.createVertexArray(),i.bindVertexArray(u);for(var g=0;g<l.length;g++){var v=l[g];s.bind(v),n&&v._glBuffers[r].refCount++;}return this.activateVao(t,o),this._activeVao=u,h[o.id]=u,h[a]=u,u;},t.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,s=t.buffers,o=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),i){if(o)for(var a=0;a<s.length;a++){var h=s[a]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,0!==h.refCount||e||o.dispose(s[a],e));}if(!e)for(var u in i)if("g"===u[0]){var l=i[u];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l);}delete t.glVertexArrayObjects[this.CONTEXT_UID];}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t);},t.prototype.activateVao=function(t,e){var n=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,s=t.buffers,o=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);var a=null;for(var h in o){var u=o[h],l=s[u.buffer],c=l._glBuffers[i];if(e.attributeData[h]){a!==c&&(r.bind(l),a=c);var d=e.attributeData[h].location;if(n.enableVertexAttribArray(d),n.vertexAttribPointer(d,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(d,1);}}}},t.prototype.draw=function(t,e,n,i){var r=this.gl,s=this._activeGeometry;if(s.indexBuffer){var o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?r.UNSIGNED_SHORT:r.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?r.drawElementsInstanced(t,e||s.indexBuffer.data.length,a,(n||0)*o,i||1):r.drawElements(t,e||s.indexBuffer.data.length,a,(n||0)*o):console.warn("unsupported index buffer type: uint32");}else s.instanced?r.drawArraysInstanced(t,n,e||s.getSize(),i||1):r.drawArrays(t,n,e||s.getSize());return this;},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null;},t.prototype.destroy=function(){this.renderer=null;},t;}(),Ju=function(){function t(t){void 0===t&&(t=null),this.type=la.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=pa.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null;}return Object.defineProperty(t.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null;},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null;},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=la.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null;},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null);},t;}();function tl(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i;}function el(t,e){var n=t.getShaderSource(e).split("\n").map(function(t,e){return e+": "+t;}),i=t.getShaderInfoLog(e),r=i.split("\n"),s={},o=r.map(function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"));}).filter(function(t){return!(!t||s[t]||(s[t]=!0,0));}),a=[""];o.forEach(function(t){n[t-1]="%c"+n[t-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px");});var h=n.join("\n");a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd();}function nl(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e;}function il(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return nl(2*e);case"bvec3":return nl(3*e);case"bvec4":return nl(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);}return null;}var rl,sl={},ol=sl;function al(t,e,n){if("precision"!==t.substring(0,9)){var i=e;return e===ua.HIGH&&n!==ua.HIGH&&(i=ua.MEDIUM),"precision "+i+" float;\n"+t;}return n!==ua.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t;}var hl={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ul(t){return hl[t];}var ll=null,cl={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function dl(t,e){if(!ll){var n=Object.keys(cl);ll={};for(var i=0;i<n.length;++i){var r=n[i];ll[t[r]]=cl[r];}}return ll[e];}var pl,fl=[{test:function(t){return"float"===t.type&&1===t.size;},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            ';}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray;},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }';}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a;},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            ';},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            ";}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x;},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }';},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            ";}},{test:function(t){return"vec2"===t.type&&1===t.size;},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            ';}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width;},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }';},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                ";}},{test:function(t){return"vec4"===t.type&&1===t.size;},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }';}}],_l={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},ml={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},gl=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function vl(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e;}var yl=0,Tl={},El=function(){function t(e,n,i){void 0===i&&(i="pixi-shader"),this.id=yl++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Tl[i]?(Tl[i]++,i+="-"+Tl[i]):Tl[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=al(this.vertexSrc,pa.PRECISION_VERTEX,ua.HIGH),this.fragmentSrc=al(this.fragmentSrc,pa.PRECISION_FRAGMENT,function(){if(!rl){rl=ua.MEDIUM;var t=function(){if(ol===sl||ol&&ol.isContextLost()){var t=document.createElement("canvas"),e=void 0;pa.PREFER_ENV>=qo.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),ol=e;}return ol;}();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);rl=e.precision?ua.HIGH:ua.MEDIUM;}}return rl;}())),this.glPrograms={},this.syncUniforms=null;}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n";},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}";},enumerable:!1,configurable:!0}),t.from=function(e,n,i){var r=e+n,s=Xa[r];return s||(Xa[r]=s=new t(e,n,i)),s;},t;}(),bl=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof Gu?e:new Gu(e):new Gu({});}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0;}return!1;},t.prototype.destroy=function(){this.uniformGroup=null;},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms;},enumerable:!1,configurable:!0}),t.from=function(e,n,i){return new t(El.from(e,n),i);},t;}(),xl=function(){function t(){this.data=0,this.blendMode=$o.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0;}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data);},set:function(t){!!(1&this.data)!==t&&(this.data^=1);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data);},set:function(t){!!(2&this.data)!==t&&(this.data^=2);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data);},set:function(t){!!(4&this.data)!==t&&(this.data^=4);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data);},set:function(t){!!(8&this.data)!==t&&(this.data^=8);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data);},set:function(t){!!(32&this.data)!==t&&(this.data^=32);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data);},set:function(t){!!(16&this.data)!==t&&(this.data^=16);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode;},set:function(t){this.blend=t!==$o.NONE,this._blendMode=t;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset;},set:function(t){this.offsets=!!t,this._polygonOffset=t;},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]";},t.for2d=function(){var e=new t();return e.depthTest=!1,e.blend=!0,e;},t;}(),Al=function(t){function e(n,i,r){var s=this,o=El.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(s=t.call(this,o,r)||this).padding=0,s.resolution=pa.FILTER_RESOLUTION,s.multisample=pa.FILTER_MULTISAMPLE,s.enabled=!0,s.autoFit=!0,s.state=new xl(),s;}return iu(e,t),e.prototype.apply=function(t,e,n,i,r){t.applyFilter(this,e,n,i);},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode;},set:function(t){this.state.blendMode=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution;},set:function(t){this._resolution=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n";},enumerable:!1,configurable:!0}),e;}(bl),Rl=new rh(),Ol=function(){function t(t,e){this._texture=t,this.mapCoord=new rh(),this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1;}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture;},set:function(t){this._texture=t,this._textureID=-1;},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,i=0;i<t.length;i+=2){var r=t[i],s=t[i+1];e[i]=r*n.a+s*n.c+n.tx,e[i+1]=r*n.b+s*n.d+n.ty;}return e;},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=e.orig,r=e.trim;r&&(Rl.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Rl));var s=e.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,h=this.clampOffset;return o[0]=(e._frame.x+a+h)/s.width,o[1]=(e._frame.y+a+h)/s.height,o[2]=(e._frame.x+e._frame.width-a+h)/s.width,o[3]=(e._frame.y+e._frame.height-a+h)/s.height,this.uClampOffset[0]=h/s.realWidth,this.uClampOffset[1]=h/s.realHeight,this.isSimple=e._frame.width===s.width&&e._frame.height===s.height&&0===e.rotate,!0;},t;}(),Sl=function(t){function e(e,n,i){var r=this,s=null;return"string"!=typeof e&&void 0===n&&void 0===i&&(s=e,e=void 0,n=void 0,i=void 0),(r=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)||this).maskSprite=s,r.maskMatrix=new rh(),r;}return iu(e,t),Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite;},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1);},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,n,i){var r=this._maskSprite,s=r._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new Ol(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i));},e;}(Al),Il=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0;}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t);},t.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var i=this.maskDataPool.pop()||new Ju();i.pooled=!0,i.maskObject=e,n=i;}var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n.autoDetect&&this.detect(n),n._target=t,n.type!==la.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case la.SCISSOR:this.renderer.scissor.push(n);break;case la.STENCIL:this.renderer.stencil.push(n);break;case la.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);}n.type===la.SPRITE&&this.maskStack.push(n);},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case la.SCISSOR:this.renderer.scissor.pop();break;case la.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case la.SPRITE:this.popSpriteMask(e);}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===la.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject);}}},t.prototype.detect=function(t){t.maskObject.isSprite?t.type=la.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=la.SCISSOR:t.type=la.STENCIL;},t.prototype.pushSpriteMask=function(t){var e,n,i=t.maskObject,r=t._target,s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex])||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new Sl()]);var o,a,h=this.renderer,u=h.renderTexture;if(u.current){var l=u.current;o=t.resolution||l.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:l.multisample;}else o=t.resolution||h.resolution,a=null!==(n=t.multisample)&&void 0!==n?n:h.multisample;s[0].resolution=o,s[0].multisample=a,s[0].maskSprite=i;var c=r.filterArea;r.filterArea=i.getBounds(!0),h.filter.push(r,s),r.filterArea=c,t._filters||this.alphaMaskIndex++;},t.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null);},t.prototype.destroy=function(){this.renderer=null;},t;}(),wl=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0;}return t.prototype.getStackLength=function(){return this.maskStack.length;},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==n&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()));},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null;},t;}(),Cl=new rh(),Nl=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n;}return iu(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0;},e.prototype.calcScissorRect=function(t){if(!t._scissorRectLocal){var e=t._scissorRect,n=t.maskObject,i=this.renderer,r=i.renderTexture;n.renderable=!0;var s=n.getBounds();this.roundFrameToPixels(s,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),n.renderable=!1,e&&s.fit(e),t._scissorRectLocal=s;}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,n=t.b,i=t.c,r=t.d;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4);},e.prototype.testScissor=function(t){var n=t.maskObject;if(!n.isFastRect||!n.isFastRect())return!1;if(e.isMatrixRotated(n.worldTransform))return!1;if(e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0;},e.prototype.roundFrameToPixels=function(t,n,i,r,s){e.isMatrixRotated(s)||((s=s?Cl.copyFrom(s):Cl.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(s,t),t.fit(r),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n));},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent();},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST);},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height);},e;}(wl),Ml=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n;}return iu(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0;},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent();},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?e.disable(e.STENCIL_TEST):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent());},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP);},e;}(wl),Pl=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new rh(),this.transform=null;}return t.prototype.update=function(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);var r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals);},t.prototype.calculateProjection=function(t,e,n,i){var r=this.projectionMatrix,s=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=s*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-s-e.y*r.d;},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null;},t;}(),Dl=new Qa(),Ll=new Qa(),Fl=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Qa(),this.destinationFrame=new Qa(),this.viewportFrame=new Qa();}return t.prototype.bind=function(t,e,n){void 0===t&&(t=null);var i,r,s,o=this.renderer;this.current=t,t?(s=(i=t.baseTexture).resolution,e||(Dl.width=t.frame.width,Dl.height=t.frame.height,e=Dl),n||(Ll.x=t.frame.x,Ll.y=t.frame.y,Ll.width=e.width,Ll.height=e.height,n=Ll),r=i.framebuffer):(s=o.resolution,e||(Dl.width=o.screen.width,Dl.height=o.screen.height,e=Dl),n||((n=Dl).width=e.width,n.height=e.height));var a=this.viewportFrame;a.x=n.x*s,a.y=n.y*s,a.width=n.width*s,a.height=n.height*s,t||(a.y=o.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(r,a),this.renderer.projection.update(n,e,s,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n);},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,r=n.width!==i.width||n.height!==i.height;if(r){var s=this.viewportFrame,o=s.x,a=s.y,h=s.width,u=s.height;o=Math.round(o),a=Math.round(a),h=Math.round(h),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,h,u);}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),r&&this.renderer.scissor.pop();},t.prototype.resize=function(){this.bind(null);},t.prototype.reset=function(){this.bind(null);},t.prototype.destroy=function(){this.renderer=null;},t;}();function Ul(t,e,n,i,r){n.buffer.update(r);}var Bl={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},Gl={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};var kl=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={};}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null;},t;}();var Xl=0,Vl={textureCount:0,uboCount:0},Hl=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Xl++;}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof pl)return pl;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");pl=!0===t({a:"b"},"a","b");}catch(t){pl=!1;}return pl;}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.");},t.prototype.contextChange=function(t){this.gl=t,this.reset();},t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(Vl.textureCount=0,Vl.uboCount=0,this.syncUniformGroup(t.uniformGroup,Vl)),i;},t.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer);},t.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e));},t.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n);},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in t.uniforms){var s=e[r];if(s){for(var o=t.uniforms[r],a=!1,h=0;h<fl.length;h++)if(fl[h].test(s,o)){i.push(fl[h].code(r,o)),a=!0;break;}if(!a){var u=(1===s.size?_l:ml)[s.type].replace("location",'ud["'+r+'"].location');i.push('\n            cu = ud["'+r+'"];\n            cv = cu.value;\n            v = uv["'+r+'"];\n            '+u+";");}}else(null===(n=t.uniforms[r])||void 0===n?void 0:n.group)&&(t.uniforms[r].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+r+", '"+r+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                    "));}return new Function("ud","uv","renderer","syncData",i.join("\n"));}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id];},t.prototype.syncUniformBufferGroup=function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,Vl,t.buffer);}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e]);},t.prototype.createSyncBufferGroup=function(t,e,n){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var r=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;var s=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[s];if(o||(o=this._uboCache[s]=function(t,e){if(!t.autoManage)return{size:0,syncFunc:Ul};for(var n=function(t,e){var n=[];for(var i in t)e[i]&&n.push(e[i]);return n.sort(function(t,e){return t.index-e.index;}),n;}(t.uniforms,e),i=function(t){for(var e=t.map(function(t){return{data:t,offset:0,dataLen:0,dirty:0};}),n=0,i=0,r=0,s=0;s<e.length;s++){var o=e[s];if(n=Gl[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,i%n!=0&&i<16){var a=i%n%16;i+=a,r+=a;}i+n>16?(r=16*Math.ceil(r/16),o.offset=r,r+=n,i=n):(o.offset=r,i+=n,r+=n);}return{uboElements:e,size:r=16*Math.ceil(r/16)};}(n),r=i.uboElements,s=i.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],a=0;a<r.length;a++){for(var h=r[a],u=t.uniforms[h.data.name],l=h.data.name,c=!1,d=0;d<fl.length;d++){var p=fl[d];if(p.codeUbo&&p.test(h.data,u)){o.push("offset = "+h.offset/4+";",fl[d].codeUbo(h.data.name,u)),c=!0;break;}}if(!c)if(h.data.size>1){var f=ul(h.data.type),_=Math.max(Gl[h.data.type]/16,1),m=f/_,g=(4-m%4)%4;o.push("\n                cv = ud."+l+".value;\n                v = uv."+l+";\n                offset = "+h.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+h.data.size*_+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ");}else{var v=Bl[h.data.type];o.push("\n                cv = ud."+l+".value;\n                v = uv."+l+";\n                offset = "+h.offset/4+";\n                "+v+";\n                ");}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))};}(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(o.size/4);t.buffer.update(a);}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id];},t.prototype.getSignature=function(t,e,n){var i=t.uniforms,r=[n+"-"];for(var s in i)r.push(s),e[s]&&r.push(e[s].type);return r.join("-");},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null;},t.prototype.generateProgram=function(t){var e=this.gl,n=t.program,i=function(t,e){var n=tl(t,t.VERTEX_SHADER,e.vertexSrc),i=tl(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||function(t,e,n,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||el(t,n),t.getShaderParameter(i,t.COMPILE_STATUS)||el(t,i),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)));}(t,r,n,i),e.attributeData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var s=e.getActiveAttrib(t,r);if(0!==s.name.indexOf("gl_")){var o=dl(e,s.type),a={type:o,name:s.name,size:ul(o),location:e.getAttribLocation(t,s.name)};n[s.name]=a;}}return n;}(r,t),e.uniformData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var s=e.getActiveUniform(t,r),o=s.name.replace(/\[.*?\]$/,""),a=!!s.name.match(/\[.*?\]$/),h=dl(e,s.type);n[o]={name:o,index:r,type:h,size:s.size,isArray:a,value:il(h,s.size)};}return n;}(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var s=Object.keys(e.attributeData);s.sort(function(t,e){return t>e?1:-1;});for(var o=0;o<s.length;o++)e.attributeData[s[o]].location=o,t.bindAttribLocation(r,o,s[o]);t.linkProgram(r);}t.deleteShader(n),t.deleteShader(i);var a={};for(var o in e.uniformData){var h=e.uniformData[o];a[o]={location:t.getUniformLocation(r,o),value:il(h.type,h.size)};}return new kl(r,a);}(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i;},t.prototype.reset=function(){this.program=null,this.shader=null;},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0;},t;}(),jl=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=$o.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new xl(),this.defaultState.blend=!0;}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[$o.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.ADD]=[t.ONE,t.ONE],e[$o.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.NONE]=[0,0],e[$o.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[$o.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[$o.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[$o.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[$o.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[$o.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[$o.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[$o.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[$o.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[$o.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[$o.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e;}(t),this.set(this.defaultState),this.reset();},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data;}for(n=0;n<this.checks.length;n++)this.checks[n](this,t);},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data;},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND);},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL);},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST);},t.prototype.setDepthMask=function(t){this.gl.depthMask(t);},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE);},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"]);},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD));}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e);},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0);},t.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1);},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode);},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset);},t.prototype.destroy=function(){this.gl=null;},t;}(),Yl=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=pa.GC_MAX_IDLE,this.checkCountMax=pa.GC_MAX_CHECK_COUNT,this.mode=pa.GC_MODE;}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==ha.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())));},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,i=0;i<e.length;i++){var r=e[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[i]=null,n=!0);}if(n){var s=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[s++]=e[i]);e.length=s;}},t.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i]);},t.prototype.destroy=function(){this.renderer=null;},t;}(),Wl=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=ea.UNSIGNED_BYTE,this.internalFormat=Jo.RGBA,this.samplerType=0;},zl=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new hu(),this.hasIntegerTextures=!1;}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,n,i,r,s,o,a,h,u,l,c,d,p,f,_,m,g,v,y,T,E,b,x;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?((e={})[ea.UNSIGNED_BYTE]=((n={})[Jo.RGBA]=t.RGBA8,n[Jo.RGB]=t.RGB8,n[Jo.RG]=t.RG8,n[Jo.RED]=t.R8,n[Jo.RGBA_INTEGER]=t.RGBA8UI,n[Jo.RGB_INTEGER]=t.RGB8UI,n[Jo.RG_INTEGER]=t.RG8UI,n[Jo.RED_INTEGER]=t.R8UI,n[Jo.ALPHA]=t.ALPHA,n[Jo.LUMINANCE]=t.LUMINANCE,n[Jo.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,n),e[ea.BYTE]=((i={})[Jo.RGBA]=t.RGBA8_SNORM,i[Jo.RGB]=t.RGB8_SNORM,i[Jo.RG]=t.RG8_SNORM,i[Jo.RED]=t.R8_SNORM,i[Jo.RGBA_INTEGER]=t.RGBA8I,i[Jo.RGB_INTEGER]=t.RGB8I,i[Jo.RG_INTEGER]=t.RG8I,i[Jo.RED_INTEGER]=t.R8I,i),e[ea.UNSIGNED_SHORT]=((r={})[Jo.RGBA_INTEGER]=t.RGBA16UI,r[Jo.RGB_INTEGER]=t.RGB16UI,r[Jo.RG_INTEGER]=t.RG16UI,r[Jo.RED_INTEGER]=t.R16UI,r[Jo.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,r),e[ea.SHORT]=((s={})[Jo.RGBA_INTEGER]=t.RGBA16I,s[Jo.RGB_INTEGER]=t.RGB16I,s[Jo.RG_INTEGER]=t.RG16I,s[Jo.RED_INTEGER]=t.R16I,s),e[ea.UNSIGNED_INT]=((o={})[Jo.RGBA_INTEGER]=t.RGBA32UI,o[Jo.RGB_INTEGER]=t.RGB32UI,o[Jo.RG_INTEGER]=t.RG32UI,o[Jo.RED_INTEGER]=t.R32UI,o[Jo.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,o),e[ea.INT]=((a={})[Jo.RGBA_INTEGER]=t.RGBA32I,a[Jo.RGB_INTEGER]=t.RGB32I,a[Jo.RG_INTEGER]=t.RG32I,a[Jo.RED_INTEGER]=t.R32I,a),e[ea.FLOAT]=((h={})[Jo.RGBA]=t.RGBA32F,h[Jo.RGB]=t.RGB32F,h[Jo.RG]=t.RG32F,h[Jo.RED]=t.R32F,h[Jo.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,h),e[ea.HALF_FLOAT]=((u={})[Jo.RGBA]=t.RGBA16F,u[Jo.RGB]=t.RGB16F,u[Jo.RG]=t.RG16F,u[Jo.RED]=t.R16F,u),e[ea.UNSIGNED_SHORT_5_6_5]=((l={})[Jo.RGB]=t.RGB565,l),e[ea.UNSIGNED_SHORT_4_4_4_4]=((c={})[Jo.RGBA]=t.RGBA4,c),e[ea.UNSIGNED_SHORT_5_5_5_1]=((d={})[Jo.RGBA]=t.RGB5_A1,d),e[ea.UNSIGNED_INT_2_10_10_10_REV]=((p={})[Jo.RGBA]=t.RGB10_A2,p[Jo.RGBA_INTEGER]=t.RGB10_A2UI,p),e[ea.UNSIGNED_INT_10F_11F_11F_REV]=((f={})[Jo.RGB]=t.R11F_G11F_B10F,f),e[ea.UNSIGNED_INT_5_9_9_9_REV]=((_={})[Jo.RGB]=t.RGB9_E5,_),e[ea.UNSIGNED_INT_24_8]=((m={})[Jo.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,m),e[ea.FLOAT_32_UNSIGNED_INT_24_8_REV]=((g={})[Jo.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,g),x=e):((v={})[ea.UNSIGNED_BYTE]=((y={})[Jo.RGBA]=t.RGBA,y[Jo.RGB]=t.RGB,y[Jo.ALPHA]=t.ALPHA,y[Jo.LUMINANCE]=t.LUMINANCE,y[Jo.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,y),v[ea.UNSIGNED_SHORT_5_6_5]=((T={})[Jo.RGB]=t.RGB,T),v[ea.UNSIGNED_SHORT_4_4_4_4]=((E={})[Jo.RGBA]=t.RGBA,E),v[ea.UNSIGNED_SHORT_5_5_5_1]=((b={})[Jo.RGBA]=t.RGBA,b),x=v),x;}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var i=new Wl(t.createTexture());for(t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Wl(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture),n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);for(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),n=0;n<this.boundTextures.length;n++)this.bind(null,n);},t.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if((t=null==t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t;}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null;},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture;},t.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i);}for(i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null);},t.prototype.ensureSamplerType=function(t){var e=this,n=e.boundTextures,i=e.hasIntegerTextures,r=e.CONTEXT_UID;if(i)for(var s=t-1;s>=0;--s){var o=n[s];o&&o._glTextures[r].samplerType!==na.FLOAT&&this.renderer.texture.unbind(o);}},t.prototype.initTexture=function(t){var e=new Wl(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e;},t.prototype.initTextureType=function(t,e){var n,i;e.internalFormat=null!==(i=null===(n=this.internalFormats[t.type])||void 0===n?void 0:n[t.format])&&void 0!==i?i:t.format,2===this.webGLVersion&&t.type===ea.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type;},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e))e.samplerType!==na.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,r=t.realHeight,s=n.gl;(e.width!==i||e.height!==r||e.dirtyId<0)&&(e.width=i,e.height=r,s.texImage2D(t.target,0,e.internalFormat,i,r,0,t.format,e.type,null));}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId;}},t.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Da(this.managedTextures,i,1);}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==sa.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=ra.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId);},t.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&t.mipmap!==sa.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===ia.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===ia.LINEAR){var r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r);}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===ia.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===ia.LINEAR?n.LINEAR:n.NEAREST);},t.prototype.destroy=function(){this.renderer=null;},t;}(),ql={__proto__:null,FilterSystem:Hu,BatchSystem:Yu,ContextSystem:zu,FramebufferSystem:Ku,GeometrySystem:Qu,MaskSystem:Il,ScissorSystem:Nl,StencilSystem:Ml,ProjectionSystem:Pl,RenderTextureSystem:Fl,ShaderSystem:Hl,StateSystem:jl,TextureGCSystem:Yl,TextureSystem:zl},Zl=new rh(),Kl=function(t){function e(e,n){void 0===e&&(e=Zo.UNKNOWN);var i=t.call(this)||this;return n=Object.assign({},pa.RENDER_OPTIONS,n),i.options=n,i.type=e,i.screen=new Qa(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||pa.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,void 0!==n.transparent&&(Ga("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i;}return iu(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this);},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height;},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var n=this.view.width/this.resolution,i=this.view.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=i+"px"),this.emit("resize",n,i);},e.prototype.generateTexture=function(t,e,n,i){void 0===e&&(e={}),"number"==typeof e&&(Ga("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:i});var r=e.region,s=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]]);}return n;}(e,["region"]);0===(i=r||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var o=Ou.create(ru({width:i.width,height:i.height},s));return Zl.tx=-i.x,Zl.ty=-i.y,this.render(t,{renderTexture:o,clear:!1,transform:Zl,skipUpdateTransform:!!t.parent}),o;},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=Zo.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null;},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor;},set:function(t){this._backgroundColor=t,this._backgroundColorString=Aa(t),xa(t,this._backgroundColorRgba);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3];},set:function(t){this._backgroundColorRgba[3]=t;},enumerable:!1,configurable:!0}),e;}(_a()),$l=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0;},Ql=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={};}return t.prototype.destroy=function(){this.renderer=null;},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID;},t.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer);},t.prototype.bindBufferBase=function(t,e){var n=this.gl,i=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var r=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer);}},t.prototype.bindBufferRange=function(t,e,n){var i=this.gl,r=this.CONTEXT_UID;n=n||0;var s=t._glBuffers[r]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,s.buffer,256*n,256);},t.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n];if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r);}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID]);}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t);},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new $l(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e];},t;}(),Jl=function(t){function e(n){var i=t.call(this,Zo.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new Jh("destroy"),contextChange:new Jh("contextChange"),reset:new Jh("reset"),update:new Jh("update"),postrender:new Jh("postrender"),prerender:new Jh("prerender"),resize:new Jh("resize")},i.runners.contextChange.add(i),i.globalUniforms=new Gu({projectionMatrix:new rh()},!0),i.addSystem(Il,"mask").addSystem(zu,"context").addSystem(jl,"state").addSystem(Hl,"shader").addSystem(zl,"texture").addSystem(Ql,"buffer").addSystem(Qu,"geometry").addSystem(Ku,"framebuffer").addSystem(Nl,"scissor").addSystem(Ml,"stencil").addSystem(Pl,"projection").addSystem(Yl,"textureGC").addSystem(Hu,"filter").addSystem(Fl,"renderTexture").addSystem(Yu,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:n.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,function(t){var e;if(!Ea){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 6.4.2 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,n);}else globalThis.console&&globalThis.console.log("PixiJS 6.4.2 - "+t+" - http://www.pixijs.com/");Ea=!0;}}(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i;}return iu(e,t),e.create=function(t){if(void 0===Ta&&(Ta=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:pa.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!globalThis.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var r=n.getExtension("WEBGL_lose_context");r&&r.loseContext();}return n=null,i;}catch(t){return!1;}}()),Ta)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.');},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n);}else n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n);t>=ca.HIGH?this.multisample=ca.HIGH:t>=ca.MEDIUM?this.multisample=ca.MEDIUM:t>=ca.LOW?this.multisample=ca.LOW:this.multisample=ca.NONE;},e.prototype.addSystem=function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=n,this.runners)this.runners[i].add(n);return this;},e.prototype.render=function(t,e){var n,i,r,s;if(e&&(e instanceof Ou?(Ga("6.0.0","Renderer#render arguments changed, use options instead."),n=e,i=arguments[2],r=arguments[3],s=arguments[4]):(n=e.renderTexture,i=e.clear,r=e.transform,s=e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(n||(this._lastObjectRendered=t),!s){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o);}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender");}},e.prototype.generateTexture=function(e,n,i,r){void 0===n&&(n={});var s=t.prototype.generateTexture.call(this,e,n,i,r);return this.framebuffer.blit(),s;},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(this.screen.height,this.screen.width);},e.prototype.reset=function(){return this.runners.reset.emit(),this;},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear();},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null;},Object.defineProperty(e.prototype,"extract",{get:function(){return Ga("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract;},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n;},e;}(Kl),tc="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",ec=function(){this.texArray=null,this.blend=0,this.type=Qo.TRIANGLES,this.start=0,this.size=0,this.data=null;},nc=function(){function t(){this.elements=[],this.ids=[],this.count=0;}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0;},t;}(),ic=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData);}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View;},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"];},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null;},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type");}},t;}(),rc=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=xl.for2d(),n.size=4*pa.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n;}return iu(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;pa.PREFER_ENV===qo.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),pa.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var i=gl.replace(/%forloop%/gi,vl(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0;}return t;}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass();this.initFlushBuffers();},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new ec());for(;n.length<r;)n.push(new nc());for(var s=0;s<this.MAX_TEXTURES;s++)this._tempBoundTextures[s]=null;},e.prototype.onPrerender=function(){this._flushId=0;},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t);},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,r=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++hu._globalBatch,h=0,u=i[0],l=0;r.copyBoundTextures(s,n);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==a&&(u.count>=n&&(r.boundArray(u,s,a,n),this.buildDrawCalls(u,l,c),l=c,u=i[++h],++a),d._batchEnabled=a,d.touched=o,u.elements[u.count++]=d);}for(u.count>0&&(r.boundArray(u,s,a,n),this.buildDrawCalls(u,l,this._bufferSize),++h,++a),c=0;c<s.length;c++)s[c]=null;hu._globalBatch=a;},e.prototype.buildDrawCalls=function(t,n,i){var r=this,s=r._bufferedElements,o=r._attributeBuffer,a=r._indexBuffer,h=r.vertexSize,u=e._drawCallPool,l=this._dcIndex,c=this._aIndex,d=this._iIndex,p=u[l];p.start=this._iIndex,p.texArray=t;for(var f=n;f<i;++f){var _=s[f],m=_._texture.baseTexture,g=Oa[m.alphaMode?1:0][_.blendMode];s[f]=null,n<f&&p.blend!==g&&(p.size=d-p.start,n=f,(p=u[++l]).texArray=t,p.start=d),this.packInterleavedGeometry(_,o,a,c,d),c+=_.vertexData.length/2*h,d+=_.indices.length,p.blend=g;}n<i&&(p.size=d-p.start,++l),this._dcIndex=l,this._aIndex=c,this._iIndex=d;},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0;},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,i=t._indexBuffer;pa.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass()),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++);},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,r=n.state,s=e._drawCallPool,o=null,a=0;a<t;a++){var h=s[a],u=h.texArray,l=h.type,c=h.size,d=h.start,p=h.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,r.set(this.state),i.drawElements(l,c,i.UNSIGNED_SHORT,2*d);}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0);},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),pa.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId]);},e.prototype.stop=function(){this.flush();},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this);},e.prototype.getAttributeBuffer=function(t){var e=Na(Math.ceil(t/8)),n=Pa(e),i=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new ic(i*this.vertexSize*4)),r;},e.prototype.getIndexBuffer=function(t){var e=Na(Math.ceil(t/12)),n=Pa(e),i=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._iBuffers[n];return r||(this._iBuffers[n]=r=new Uint16Array(i)),r;},e.prototype.packInterleavedGeometry=function(t,e,n,i,r){for(var s=e.uint32View,o=e.float32View,a=i/this.vertexSize,h=t.uvs,u=t.indices,l=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),p=d<1&&t._texture.baseTexture.alphaMode?Ia(t._tintRGB,d):t._tintRGB+(255*d<<24),f=0;f<l.length;f+=2)o[i++]=l[f],o[i++]=l[f+1],o[i++]=h[f],o[i++]=h[f+1],s[i++]=p,o[i++]=c;for(f=0;f<u.length;f++)n[r++]=a+u[f];},e._drawCallPool=[],e._textureArrayPool=[],e;}(ju),sc=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".');}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=Gu.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new El(this.vertexSrc,i);}var r={tint:new Float32Array([1,1,1,1]),translationMatrix:new rh(),default:this.defaultGroupCache[t]};return new bl(this.programCache[t],r);},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return(e+="\n")+"\n";},t;}(),oc=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new Cu(null,e,!1),n._indexBuffer=new Cu(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,ea.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,ea.FLOAT).addAttribute("aColor",n._buffer,4,!0,ea.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,ea.FLOAT).addIndex(n._indexBuffer),n;}return iu(e,t),e;}(Lu),ac="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",hc="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",uc=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:ac,fragment:hc,geometryClass:oc,vertexSize:6},t),n=e.vertex,i=e.fragment,r=e.vertexSize,s=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new sc(n,i),o.geometryClass=s,o.vertexSize=r,o;}return iu(e,t),e;}(rc);},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return ac;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return hc;},enumerable:!1,configurable:!0}),t;}(),lc=uc.create(),cc={},dc=function(t){Object.defineProperty(cc,t,{get:function(){return Ga("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),vu[t];}});};for(var pc in vu)dc(pc);var fc={},_c=function(t){Object.defineProperty(fc,t,{get:function(){return Ga("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),ql[t];}});};for(var pc in ql)_c(pc);var mc=function(){function t(e){var n=this;this.stage=new Gh(),e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return Jl.create(t);}(e),t._plugins.forEach(function(t){t.init.call(n,e);});}return t.registerPlugin=function(e){t._plugins.push(e);},t.prototype.render=function(){this.renderer.render(this.stage);},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view;},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen;},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,n){var i=this,r=t._plugins.slice(0);r.reverse(),r.forEach(function(t){t.destroy.call(i);}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null;},t._plugins=[],t;}(),gc=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize());},get:function(){return this._resizeTo;}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize();}));},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null);},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,n=i.clientHeight;}e.renderer.resize(t,n);}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null;},t.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null;},t;}();mc.registerPlugin(gc);var vc,yc,Tc,Ec,bc,xc,Ac,Rc,Oc,Sc,Ic,wc,Cc,Nc,Mc,Pc,Dc,Lc,Fc,Uc=/iPhone/i,Bc=/iPod/i,Gc=/iPad/i,kc=/\biOS-universal(?:.+)Mac\b/i,Xc=/\bAndroid(?:.+)Mobile\b/i,Vc=/Android/i,Hc=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,jc=/Silk/i,Yc=/Windows Phone/i,Wc=/\bWindows(?:.+)ARM\b/i,zc=/BlackBerry/i,qc=/BB10/i,Zc=/Opera Mini/i,Kc=/\b(CriOS|Chrome)(?:.+)Mobile/i,$c=/Mobile(?:.+)Firefox\b/i,Qc=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream;},Jc=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,i=n.split("[FBAN");void 0!==i[1]&&(n=i[0]),void 0!==(i=n.split("Twitter"))[1]&&(n=i[0]);var r=function(t){return function(e){return e.test(t);};}(n),s={apple:{phone:r(Uc)&&!r(Yc),ipod:r(Bc),tablet:!r(Uc)&&(r(Gc)||Qc(e))&&!r(Yc),universal:r(kc),device:(r(Uc)||r(Bc)||r(Gc)||r(kc)||Qc(e))&&!r(Yc)},amazon:{phone:r(Hc),tablet:!r(Hc)&&r(jc),device:r(Hc)||r(jc)},android:{phone:!r(Yc)&&r(Hc)||!r(Yc)&&r(Xc),tablet:!r(Yc)&&!r(Hc)&&!r(Xc)&&(r(jc)||r(Vc)),device:!r(Yc)&&(r(Hc)||r(jc)||r(Xc)||r(Vc))||r(/\bokhttp\b/i)},windows:{phone:r(Yc),tablet:r(Wc),device:r(Yc)||r(Wc)},other:{blackberry:r(zc),blackberry10:r(qc),opera:r(Zc),firefox:r($c),chrome:r(Kc),device:r(zc)||r(qc)||r(Zc)||r($c)||r(Kc)},any:!1,phone:!1,tablet:!1};return s.any=s.apple.device||s.android.device||s.windows.device||s.other.device,s.phone=s.apple.phone||s.android.phone||s.windows.phone,s.tablet=s.apple.tablet||s.android.tablet||s.windows.tablet,s;}(globalThis.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(vc||(vc={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(yc||(yc={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(Tc||(Tc={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(Ec||(Ec={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(bc||(bc={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(xc||(xc={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(Ac||(Ac={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(Rc||(Rc={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(Oc||(Oc={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(Sc||(Sc={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(Ic||(Ic={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(wc||(wc={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(Cc||(Cc={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(Nc||(Nc={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(Mc||(Mc={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(Pc||(Pc={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(Dc||(Dc={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(Lc||(Lc={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(Fc||(Fc={}));wc.POW2,Lc.NONE,function(t){var e,n=!0;(Jc.tablet||Jc.phone)&&(Jc.apple.device&&(e=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(e[1],10)<11&&(n=!1),Jc.android.device&&(e=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(e[1],10)<7&&(n=!1));}(),Mc.AUTO,Ic.CLAMP,Sc.LINEAR,Pc.HIGH,Jc.apple.device?Pc.HIGH:Pc.MEDIUM,Jc.apple.device;var td=!1,ed=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1;}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY;},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0;},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Qa.EMPTY:((t=t||new Qa(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t);},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y);},t.prototype.addPointMatrix=function(t,e){var n=t.a,i=t.b,r=t.c,s=t.d,o=t.tx,a=t.ty,h=n*e.x+r*e.y+o,u=i*e.x+s*e.y+a;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u);},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,n=o<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[2])<e?s:e,n=(o=t[3])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[4])<e?s:e,n=(o=t[5])<n?o:n,i=s>i?s:i,r=o>r?o:r,e=(s=t[6])<e?s:e,n=(o=t[7])<n?o:n,i=s>i?s:i,r=o>r?o:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r;},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r);},t.prototype.addFrameMatrix=function(t,e,n,i,r){var s=t.a,o=t.b,a=t.c,h=t.d,u=t.tx,l=t.ty,c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,_=s*e+a*n+u,m=o*e+h*n+l;c=_<c?_:c,d=m<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*i+a*n+u)<c?_:c,d=(m=o*i+h*n+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*e+a*r+u)<c?_:c,d=(m=o*e+h*r+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,c=(_=s*i+a*r+u)<c?_:c,d=(m=o*i+h*r+l)<d?m:d,p=_>p?_:p,f=m>f?m:f,this.minX=c,this.minY=d,this.maxX=p,this.maxY=f;},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<n;a+=2){var h=t[a],u=t[a+1];i=h<i?h:i,r=u<r?u:r,s=h>s?h:s,o=u>o?u:o;}this.minX=i,this.minY=r,this.maxX=s,this.maxY=o;},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i);},t.prototype.addVerticesMatrix=function(t,e,n,i,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,u=t.d,l=t.tx,c=t.ty,d=this.minX,p=this.minY,f=this.maxX,_=this.maxY,m=n;m<i;m+=2){var g=e[m],v=e[m+1],y=o*g+h*v+l,T=u*v+a*g+c;d=Math.min(d,y-r),f=Math.max(f,y+r),p=Math.min(p,T-s),_=Math.max(_,T+s);}this.minX=d,this.minY=p,this.maxX=f,this.maxY=_;},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r;},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u;}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY);},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=s){var o=this.minX,a=this.minY,h=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<a?i:a,this.maxX=r>h?r:h,this.maxY=s>u?s:u;}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e);},t.prototype.addFramePad=function(t,e,n,i,r,s){t-=r,e-=s,n+=r,i+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i;},t;}(),nd=function(t,e){return nd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},nd(t,e);};function id(t,e){function n(){this.constructor=t;}nd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var rd,sd,od,ad,hd,ud,ld,cd,dd,pd,fd,_d,md,gd,vd,yd,Td,Ed,bd,xd=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new ph(),e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new ed(),e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e;}return id(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r));}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed;},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform);},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Qa()),e=this._boundsRect),this._bounds.getRectangle(e);},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Qa()),t=this._localBoundsRect),this._localBounds||(this._localBounds=new ed());var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,s;},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e);},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n);},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t;},e.prototype.setTransform=function(t,e,n,i,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this;},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners();},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Ad()),this.tempDisplayObjectParent;},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t;},e.prototype.disableTempParent=function(t){this.parent=t;},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x;},set:function(t){this.transform.position.x=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y;},set:function(t){this.transform.position.y=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position;},set:function(t){this.transform.position.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale;},set:function(t){this.transform.scale.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot;},set:function(t){this.transform.pivot.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew;},set:function(t){this.transform.skew.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation;},set:function(t){this.transform.rotation=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*qa;},set:function(t){this.transform.rotation=t*Za;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex;},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent;}while(t);return!0;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask;},set:function(t){var e;this._mask!==t&&(this._mask&&((e=this._mask.maskObject||this._mask)._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1)),this._mask=t,this._mask&&(0===(e=this._mask.maskObject||this._mask)._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++));},enumerable:!1,configurable:!0}),e;}(_a()),Ad=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e;}return id(e,t),e;}(xd);function Rd(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex;}xd.prototype.displayObjectUpdateTransform=xd.prototype.updateTransform,function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(rd||(rd={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(sd||(sd={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(od||(od={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(ad||(ad={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(hd||(hd={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(ud||(ud={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(ld||(ld={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(cd||(cd={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(dd||(dd={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(pd||(pd={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(fd||(fd={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(_d||(_d={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(md||(md={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(gd||(gd={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(vd||(vd={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(yd||(yd={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(Td||(Td={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(Ed||(Ed={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(bd||(bd={}));var Od=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=td,e.sortDirty=!1,e;}return id(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this);}return e[0];},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t;},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i);}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e;},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Da(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e);},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t];},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],s=this.children.indexOf(r);if(-1===s)return null;r.parent=null,r.transform._parentID=-1,Da(this.children,s,1),this._boundsID++,this.onChildrenChange(s),r.emit("removed",this),this.emit("childRemoved",r,this,s);}return e[0];},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Da(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e;},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var s=0;s<n.length;++s)n[s].parent=null,n[s].transform&&(n[s].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),s=0;s<n.length;++s)n[s].emit("removed",this),this.emit("childRemoved",n[s],this,s);return n;}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.");},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0);}t&&this.children.length>1&&this.children.sort(Rd),this.sortDirty=!1;},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform();}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds);}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds);}this._bounds.updateID=this._boundsID;},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform();}return i;},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var n=t.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var i,r;if(this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&n.intersects(i,r))this._render(t);else if(this.cullArea)return;for(var s=0,o=this.children.length;s<o;++s){var a=this.children[s],h=a.cullable;a.cullable=h||!this.cullArea,a.render(t),a.cullable=h;}}},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t);}},e.prototype.renderAdvanced=function(t){var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i]);}var r=e&&this._enabledFilters&&this._enabledFilters.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Td.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t),i=0;for(var s=this.children.length;i<s;++i)this.children[i].render(t);}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop();},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e);},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width;},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height;},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t;},enumerable:!1,configurable:!0}),e;}(xd);Od.prototype.containerUpdateTransform=Od.prototype.updateTransform;var Sd=new Qa(),Id=function(){function t(t){this.renderer=t;}return t.prototype.image=function(t,e,n){var i=new Image();return i.src=this.base64(t,e,n),i;},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n);},t.prototype.canvas=function(e){var n,i,r,s=this.renderer,o=!1,a=!1;e&&(e instanceof Ou?r=e:(r=this.renderer.generateTexture(e),a=!0)),r?(n=r.baseTexture.resolution,i=r.frame,o=!1,s.renderTexture.bind(r)):(n=this.renderer.resolution,o=!0,(i=Sd).width=this.renderer.width,i.height=this.renderer.height,s.renderTexture.bind(null));var h=Math.floor(i.width*n+1e-4),u=Math.floor(i.height*n+1e-4),l=new ja(h,u,1),c=new Uint8Array(4*h*u),d=s.gl;d.readPixels(i.x*n,i.y*n,h,u,d.RGBA,d.UNSIGNED_BYTE,c);var p=l.context.getImageData(0,0,h,u);if(t.arrayPostDivide(c,p.data),l.context.putImageData(p,0,0),o){var f=new ja(l.width,l.height,1);f.context.scale(1,-1),f.context.drawImage(l.canvas,0,-u),l.destroy(),l=f;}return a&&r.destroy(!0),l.canvas;},t.prototype.pixels=function(e,n){var i,r,s,o=this.renderer,a=!1;e&&(e instanceof Ou?s=e:e instanceof xd&&(s=this.renderer.generateTexture(e),a=!0)),s?n?(i=n.resolution,r=s.frame,o.renderTexture.bind(s)):(i=s.baseTexture.resolution,r=s.frame,o.renderTexture.bind(s)):n?(i=n.resolution,(r=Sd).width=n.width,r.height=n.height,o.renderTexture.bind(null)):(i=o.resolution,(r=Sd).width=o.width,r.height=o.height,o.renderTexture.bind(null));var h=r.width*i,u=r.height*i,l=new Uint8Array(4*h*u),c=o.gl;return c.readPixels(r.x*i,r.y*i,h,u,c.RGBA,c.UNSIGNED_BYTE,l),a&&s.destroy(!0),t.arrayPostDivide(l,l),l;},t.prototype.destroy=function(){this.renderer=null;},t.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var i=e[n+3]=t[n+3];0!==i?(e[n]=Math.round(Math.min(255*t[n]/i,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/i,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/i,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2]);}},t;}(),wd=function(){function t(t,e,n){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null;}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0);},t;}();function Cd(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e;}var Nd,Md=function(){function t(){this._head=this._tail=void 0;}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n;},t.prototype.has=function(t){if(!(t instanceof wd))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this;},t.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0;},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return Cd(this,new wd(t,!1,e));},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!=typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return Cd(this,new wd(t,!0,e));},t.prototype.detach=function(t){if(!(t instanceof wd))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this;},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this;},t;}();function Pd(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),r={},s=14;s--;)r[n.key[s]]=i[s]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,function(t,e,i){e&&(r[n.q.name][e]=i);}),r;}var Dd=null;function Ld(){}function Fd(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n);}function Ud(t){return t.toString().replace("object ","");}var Bd=function(){function t(e,n,i){if(this._dequeue=Ld,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!=typeof e||"string"!=typeof n)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Ld,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Md(),this.onProgress=new Md(),this.onComplete=new Md(),this.onAfterMiddleware=new Md();}return t.setExtensionLoadType=function(e,n){Fd(t._loadTypeMap,e,n);},t.setExtensionXhrType=function(e,n){Fd(t._xhrTypeMap,e,n);},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING);},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish();},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish();}},t.prototype.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout(function(){return e(n);},1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:void 0===Nd&&(Nd=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest())),Nd&&this.crossOrigin?this._loadXdr():this._loadXhr();}},t.prototype._hasFlag=function(t){return 0!=(this._flags&t);},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t;},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null));},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this);},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==globalThis.Image?this.data=new Image():this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout));},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==globalThis.Audio?this.data=new Audio():this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else e=this.metadata.mimeType,this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e));this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout));}else this.abort("Unsupported element: "+t);},t.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest();"use-credentials"===this.crossOrigin&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send();},t.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest();t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send();},1);},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=n,i;},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName);},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total);},t.prototype._onTimeout=function(){this.abort("Load timed out.");},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Ud(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"');},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Ud(t)+" Request timed out.");},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Ud(t)+" Request was aborted by the user.");},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",i=void 0===e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&void 0!==e.responseType||(n=e.responseText),0===i&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2==(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON;}catch(t){return void this.abort("Error trying to parse loaded json: "+t);}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser();this.data=r.parseFromString(n,"text/xml");}else{var s=document.createElement("div");s.innerHTML=n,this.data=s;}this.type=t.TYPE.XML;}catch(t){return void this.abort("Error trying to parse loaded xml: "+t);}else this.data=e.response||n;this.complete();}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL);},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Dd||(Dd=document.createElement("a")),Dd.href=t;var n=Pd(Dd.href,{strictMode:!0}),i=!n.port&&""===e.port||n.port===e.port,r=n.protocol?n.protocol+":":"";return n.host===e.hostname&&i&&r===e.protocol?"":"anonymous";},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT;},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR;},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n));}else{var i=t.indexOf("?"),r=t.indexOf("#"),s=Math.min(i>-1?i:t.length,r>-1?r:t.length);e=(t=t.substring(0,s)).substring(t.lastIndexOf(".")+1);}return e.toLowerCase();},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain";}},t;}();function Gd(){}function kd(t){return function(){for(var e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,n);};}!function(t){var e,n,i,r;(e=t.STATUS_FLAGS||(t.STATUS_FLAGS={}))[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING",(n=t.TYPE||(t.TYPE={}))[n.UNKNOWN=0]="UNKNOWN",n[n.JSON=1]="JSON",n[n.XML=2]="XML",n[n.IMAGE=3]="IMAGE",n[n.AUDIO=4]="AUDIO",n[n.VIDEO=5]="VIDEO",n[n.TEXT=6]="TEXT",(i=t.LOAD_TYPE||(t.LOAD_TYPE={}))[i.XHR=1]="XHR",i[i.IMAGE=2]="IMAGE",i[i.AUDIO=3]="AUDIO",i[i.VIDEO=4]="VIDEO",(r=t.XHR_RESPONSE_TYPE||(t.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",t._loadTypeMap={gif:t.LOAD_TYPE.IMAGE,png:t.LOAD_TYPE.IMAGE,bmp:t.LOAD_TYPE.IMAGE,jpg:t.LOAD_TYPE.IMAGE,jpeg:t.LOAD_TYPE.IMAGE,tif:t.LOAD_TYPE.IMAGE,tiff:t.LOAD_TYPE.IMAGE,webp:t.LOAD_TYPE.IMAGE,tga:t.LOAD_TYPE.IMAGE,svg:t.LOAD_TYPE.IMAGE,"svg+xml":t.LOAD_TYPE.IMAGE,mp3:t.LOAD_TYPE.AUDIO,ogg:t.LOAD_TYPE.AUDIO,wav:t.LOAD_TYPE.AUDIO,mp4:t.LOAD_TYPE.VIDEO,webm:t.LOAD_TYPE.VIDEO},t._xhrTypeMap={xhtml:t.XHR_RESPONSE_TYPE.DOCUMENT,html:t.XHR_RESPONSE_TYPE.DOCUMENT,htm:t.XHR_RESPONSE_TYPE.DOCUMENT,xml:t.XHR_RESPONSE_TYPE.DOCUMENT,tmx:t.XHR_RESPONSE_TYPE.DOCUMENT,svg:t.XHR_RESPONSE_TYPE.DOCUMENT,tsx:t.XHR_RESPONSE_TYPE.DOCUMENT,gif:t.XHR_RESPONSE_TYPE.BLOB,png:t.XHR_RESPONSE_TYPE.BLOB,bmp:t.XHR_RESPONSE_TYPE.BLOB,jpg:t.XHR_RESPONSE_TYPE.BLOB,jpeg:t.XHR_RESPONSE_TYPE.BLOB,tif:t.XHR_RESPONSE_TYPE.BLOB,tiff:t.XHR_RESPONSE_TYPE.BLOB,webp:t.XHR_RESPONSE_TYPE.BLOB,tga:t.XHR_RESPONSE_TYPE.BLOB,json:t.XHR_RESPONSE_TYPE.JSON,text:t.XHR_RESPONSE_TYPE.TEXT,txt:t.XHR_RESPONSE_TYPE.TEXT,ttf:t.XHR_RESPONSE_TYPE.BUFFER,otf:t.XHR_RESPONSE_TYPE.BUFFER},t.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";}(Bd||(Bd={}));var Xd=function(t,e){this.data=t,this.callback=e;},Vd=function(){function t(t,e){var n=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=Gd,this.unsaturated=Gd,this.empty=Gd,this.drain=Gd,this.error=Gd,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,i){if(i&&"function"!=typeof i)throw new Error("task callback must be a function");if(n.started=!0,null==t&&n.idle())setTimeout(function(){return n.drain();},1);else{var r=new Xd(t,"function"==typeof i?i:Gd);e?n._tasks.unshift(r):n._tasks.push(r),setTimeout(n.process,1);}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(t.data,kd(n._next(t)));}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4;}return t.prototype._next=function(t){var e=this;return function(){for(var n=arguments,i=[],r=0;r<arguments.length;r++)i[r]=n[r];e.workers-=1,t.callback.apply(t,i),null!=i[0]&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process();};},t.prototype.push=function(t,e){this._insert(t,!1,e);},t.prototype.kill=function(){this.workers=0,this.drain=Gd,this.started=!1,this._tasks=[];},t.prototype.unshift=function(t,e){this._insert(t,!0,e);},t.prototype.length=function(){return this._tasks.length;},t.prototype.running=function(){return this.workers;},t.prototype.idle=function(){return this._tasks.length+this.workers===0;},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0);},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process();}},t.eachSeries=function(t,e,n,i){var r=0,s=t.length;!function o(a){a||r===s?n&&n(a):i?setTimeout(function(){e(t[r++],o);},1):e(t[r++],o);}();},t.queue=function(e,n){return new t(e,n);},t;}(),Hd=/(#[\w-]+)?$/,jd=function(){function t(e,n){var i=this;void 0===e&&(e=""),void 0===n&&(n=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e);},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e);},this._queue=Vd.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new Md(),this.onError=new Md(),this.onLoad=new Md(),this.onStart=new Md(),this.onComplete=new Md();for(var r=0;r<t._plugins.length;++r){var s=t._plugins[r],o=s.pre,a=s.use;o&&this.pre(o),a&&this.use(a);}this._protected=!1;}return t.prototype._add=function(t,e,n,i){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new Bd(t,e,n),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var r=n.parentResource,s=[],o=0;o<r.children.length;++o)r.children[o].isComplete||s.push(r.children[o]);var a=r.progressChunk*(s.length+1)/(s.length+2);for(r.children.push(this.resources[t]),r.progressChunk=a,o=0;o<s.length;++o)s[o].progressChunk=a;this.resources[t].progressChunk=a;}return this._queue.push(this.resources[t]),this;},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this;},t.prototype.use=function(t){return this._afterMiddleware.push(t),this;},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset");}return this.resources={},this;},t.prototype.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume();}return this;},Object.defineProperty(t.prototype,"concurrency",{get:function(){return this._queue.concurrency;},set:function(t){this._queue.concurrency=t;},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,n=Pd(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=Hd.exec(e)[0];-1!==(e=e.slice(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i;}return e;},t.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,Vd.eachSeries(this._beforeMiddleware,function(e,i){e.call(n,t,function(){i(t.isComplete?{}:null);});},function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load());},!0);},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this);},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources);},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),Vd.eachSeries(this._afterMiddleware,function(n,i){n.call(e,t,i);},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete();},!0);},t.prototype.destroy=function(){this._protected||this.reset();},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t())._protected=!0,t._shared=e),e;},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return t._plugins.push(e),e.add&&e.add(),t;},t._plugins=[],t;}();jd.prototype.add=function(t,e,n,i){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this;}if("object"==typeof t&&(n=t,i=e||n.callback||n.onComplete,e=n.url,t=n.name||n.key||n.url),"string"!=typeof e&&(i=n,n=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");return"function"==typeof n&&(i=n,n=null),this._add(t,e,n,i);};var Yd,Wd,zd=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?jd.shared:new jd();},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null);},t;}(),qd=function(){function t(){}return t.add=function(){Bd.setExtensionLoadType("svg",Bd.LOAD_TYPE.XHR),Bd.setExtensionXhrType("svg",Bd.XHR_RESPONSE_TYPE.TEXT);},t.use=function(t,e){if(!t.data||t.type!==Bd.TYPE.IMAGE&&"svg"!==t.extension)e();else{var n=t.data,i=t.url,r=t.name,s=t.metadata;Ru.fromLoader(n,i,r,s).then(function(n){t.texture=n,e();}).catch(e);}},t;}();jd.registerPlugin({use:function(t,e){if(t.data){if(t.xhr&&t.xhrType===Bd.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var n=globalThis.URL||globalThis.webkitURL,i=n.createObjectURL(t.data);return t.blob=t.data,t.data=new Image(),t.data.src=i,t.type=Bd.TYPE.IMAGE,void(t.data.onload=function(){n.revokeObjectURL(i),t.data.onload=null,e();});}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image(),t.data.src="data:"+r+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var i=[0,0,0],r=[0,0,0,0],s=0;s<i.length;++s)n<t.length?i[s]=255&t.charCodeAt(n++):i[s]=0;switch(r[0]=i[0]>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|i[2]>>6,r[3]=63&i[2],n-(t.length-1)){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64;}for(s=0;s<r.length;++s)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r[s]);}return e;}(t.xhr.responseText),t.type=Bd.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e();});}e();}else e();}}),jd.registerPlugin(qd),function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL";}(Wd||(Wd={}));var Zd=((Yd={})[Wd.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,Yd[Wd.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,Yd[Wd.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,Yd[Wd.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,Yd[Wd.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,Yd[Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,Yd[Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,Yd[Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,Yd[Wd.COMPRESSED_R11_EAC]=.5,Yd[Wd.COMPRESSED_SIGNED_R11_EAC]=.5,Yd[Wd.COMPRESSED_RG11_EAC]=1,Yd[Wd.COMPRESSED_SIGNED_RG11_EAC]=1,Yd[Wd.COMPRESSED_RGB8_ETC2]=.5,Yd[Wd.COMPRESSED_RGBA8_ETC2_EAC]=1,Yd[Wd.COMPRESSED_SRGB8_ETC2]=.5,Yd[Wd.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,Yd[Wd.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Yd[Wd.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,Yd[Wd.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,Yd[Wd.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,Yd[Wd.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,Yd[Wd.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,Yd[Wd.COMPRESSED_RGB_ETC1_WEBGL]=.5,Yd[Wd.COMPRESSED_RGB_ATC_WEBGL]=.5,Yd[Wd.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,Yd[Wd.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,Yd),Kd=function(t,e){return Kd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Kd(t,e);};function $d(t,e){function n(){this.constructor=t;}Kd(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var Qd,Jd,tp=function(t){function e(e,n){void 0===n&&(n={width:1,height:1,autoLoad:!0});var i,r,s=this;return"string"==typeof e?(i=e,r=new Uint8Array()):(i=null,r=e),(s=t.call(this,r,n)||this).origin=i,s.buffer=r?new ic(r):null,s.origin&&!1!==n.autoLoad&&s.load(),r&&r.length&&(s.loaded=!0,s.onBlobLoaded(s.buffer.rawBinaryData)),s;}return $d(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return t=this,void 0,n=function(){var t;return function(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1];},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this;}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue;}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break;}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break;}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break;}r[2]&&o.ops.pop(),o.trys.pop();continue;}s=e.call(t,o);}catch(t){s=[6,t],i=0;}finally{n=r=0;}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0};}([s,a]);};}}(this,function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new ic(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this];}});},new((e=Promise)||(e=Promise))(function(i,r){function s(t){try{a(n.next(t));}catch(t){r(t);}}function o(t){try{a(n.throw(t));}catch(t){r(t);}}function a(t){t.done?i(t.value):new e(function(e){e(t.value);}).then(s,o);}a((n=n.apply(t,[])).next());});var t,e,n;},e;}(ou),ep=function(t){function e(n,i){var r=t.call(this,n,i)||this;return r.format=i.format,r.levels=i.levels||1,r._width=i.width,r._height=i.height,r._extension=e._formatToExtension(r.format),(i.levelBuffers||r.buffer)&&(r._levelBuffers=i.levelBuffers||e._createLevelBuffers(n instanceof Uint8Array?n:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r;}return $d(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var r=0,s=this.levels;r<s;r++){var o=this._levelBuffers[r],a=o.levelID,h=o.levelWidth,u=o.levelHeight,l=o.levelBuffer;i.compressedTexImage2D(i.TEXTURE_2D,a,this.format,h,u,0,l);}return!0;},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height);},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!");},e._createLevelBuffers=function(t,e,n,i,r,s,o){for(var a=new Array(n),h=t.byteOffset,u=s,l=o,c=u+i-1&~(i-1),d=l+r-1&~(r-1),p=c*d*Zd[e],f=0;f<n;f++)a[f]={levelID:f,levelWidth:n>1?u:c,levelHeight:n>1?l:d,levelBuffer:new Uint8Array(t.buffer,h,p)},h+=p,p=(c=(u=u>>1||1)+i-1&~(i-1))*(d=(l=l>>1||1)+r-1&~(r-1))*Zd[e];return a;},e;}(tp),np=function(){function t(){}return t.use=function(e,n){var i=e.data;if(e.type===Bd.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var r=i.textures,s=void 0,o=void 0,a=0,h=r.length;a<h;a++){var u=r[a],l=u.src,c=u.format;if(c||(o=l),t.textureFormats[c]){s=l;break;}}if(!(s=s||o))return void n(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(s===e.url)return void n(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},p=ya.resolve(e.url.replace(this.baseUrl,""),s),f=i.cacheID;this.add(f,p,d,function(t){if(t.error)n(t.error);else{var i=t.texture,r=void 0===i?null:i,s=t.textures,o=void 0===s?{}:s;Object.assign(e,{texture:r,textures:o}),n();}});}else n();},Object.defineProperty(t,"textureExtensions",{get:function(){if(!t._textureExtensions){var e=document.createElement("canvas").getContext("webgl");if(!e)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var n={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};t._textureExtensions=n;}return t._textureExtensions;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"textureFormats",{get:function(){if(!t._textureFormats){var e=t.textureExtensions;for(var n in t._textureFormats={},e){var i=e[n];i&&Object.assign(t._textureFormats,Object.getPrototypeOf(i));}}return t._textureFormats;},enumerable:!1,configurable:!0}),t;}();function ip(t,e,n){var i={textures:{},texture:null};return e?(e.map(function(t){return new Ru(new hu(t,Object.assign({mipmap:sa.OFF,alphaMode:oa.NO_PREMULTIPLIED_ALPHA},n)));}).forEach(function(e,n){var r=e.baseTexture,s=t+"-"+(n+1);hu.addToCache(r,s),Ru.addToCache(e,s),0===n&&(hu.addToCache(r,t),Ru.addToCache(e,t),i.texture=e),i.textures[s]=e;}),i):i;}Bd.setExtensionXhrType("dds",Bd.XHR_RESPONSE_TYPE.BUFFER);var rp,sp;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT";}(rp||(rp={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D";}(sp||(sp={}));var op,ap,hp,up=((Qd={})[827611204]=Wd.COMPRESSED_RGBA_S3TC_DXT1_EXT,Qd[861165636]=Wd.COMPRESSED_RGBA_S3TC_DXT3_EXT,Qd[894720068]=Wd.COMPRESSED_RGBA_S3TC_DXT5_EXT,Qd),lp=((Jd={})[rp.DXGI_FORMAT_BC1_TYPELESS]=Wd.COMPRESSED_RGBA_S3TC_DXT1_EXT,Jd[rp.DXGI_FORMAT_BC1_UNORM]=Wd.COMPRESSED_RGBA_S3TC_DXT1_EXT,Jd[rp.DXGI_FORMAT_BC2_TYPELESS]=Wd.COMPRESSED_RGBA_S3TC_DXT3_EXT,Jd[rp.DXGI_FORMAT_BC2_UNORM]=Wd.COMPRESSED_RGBA_S3TC_DXT3_EXT,Jd[rp.DXGI_FORMAT_BC3_TYPELESS]=Wd.COMPRESSED_RGBA_S3TC_DXT5_EXT,Jd[rp.DXGI_FORMAT_BC3_UNORM]=Wd.COMPRESSED_RGBA_S3TC_DXT5_EXT,Jd[rp.DXGI_FORMAT_BC1_UNORM_SRGB]=Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,Jd[rp.DXGI_FORMAT_BC2_UNORM_SRGB]=Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,Jd[rp.DXGI_FORMAT_BC3_UNORM_SRGB]=Wd.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,Jd),cp=function(){function t(){}return t.use=function(e,n){if("dds"===e.extension&&e.data)try{Object.assign(e,ip(e.name||e.url,t.parse(e.data),e.metadata));}catch(t){return void n(t);}n();},t.parse=function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,124/Uint32Array.BYTES_PER_ELEMENT),i=n[3],r=n[4],s=n[7],o=new Uint32Array(t,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){var h=o[2];if(808540228!==h){var u=up[h],l=new Uint8Array(t,128);return[new ep(l,{format:u,width:r,height:i,levels:s})];}var c=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),d=c[0],p=c[1],f=c[2],_=c[3],m=lp[d];if(void 0===m)throw new Error("DDSLoader cannot parse texture data with DXGI format "+d);if(4===f)throw new Error("DDSLoader does not support cubemap textures");if(p===sp.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSLoader does not supported 3D texture data");var g=new Array();if(1===_)g.push(new Uint8Array(t,148));else{for(var v=Zd[m],y=0,T=r,E=i,b=0;b<s;b++)y+=Math.max(1,T+3&-4)*Math.max(1,E+3&-4)*v,T>>>=1,E>>>=1;var x=148;for(b=0;b<_;b++)g.push(new Uint8Array(t,x,y)),x+=y;}return g.map(function(t){return new ep(t,{format:m,width:r,height:i,levels:s});});}if(64&a)throw new Error("DDSLoader does not support uncompressed texture data.");if(512&a)throw new Error("DDSLoader does not supported YUV uncompressed texture data.");if(131072&a)throw new Error("DDSLoader does not support single-channel (lumninance) texture data!");if(2&a)throw new Error("DDSLoader does not support single-channel (alpha) texture data!");throw new Error("DDSLoader failed to load a texture file due to an unknown reason!");},t;}();Bd.setExtensionXhrType("ktx",Bd.XHR_RESPONSE_TYPE.BUFFER);var dp=[171,75,84,88,32,49,49,187,13,10,26,10],pp=((op={})[ea.UNSIGNED_BYTE]=1,op[ea.UNSIGNED_SHORT]=2,op[ea.INT]=4,op[ea.UNSIGNED_INT]=4,op[ea.FLOAT]=4,op[ea.HALF_FLOAT]=8,op),fp=((ap={})[Jo.RGBA]=4,ap[Jo.RGB]=3,ap[Jo.RG]=2,ap[Jo.RED]=1,ap[Jo.LUMINANCE]=1,ap[Jo.LUMINANCE_ALPHA]=2,ap[Jo.ALPHA]=1,ap),_p=((hp={})[ea.UNSIGNED_SHORT_4_4_4_4]=2,hp[ea.UNSIGNED_SHORT_5_5_5_1]=2,hp[ea.UNSIGNED_SHORT_5_6_5]=2,hp),mp=function(){function t(){}return t.use=function(e,n){if("ktx"===e.extension&&e.data)try{var i=e.name||e.url,r=t.parse(i,e.data),s=r.compressed,o=r.uncompressed,a=r.kvData;if(s){var h=ip(i,s,e.metadata);if(a&&h.textures)for(var u in h.textures)h.textures[u].baseTexture.ktxKeyValueData=a;Object.assign(e,h);}else if(o){var l={};o.forEach(function(t,e){var n=new Ru(new hu(t.resource,{mipmap:sa.OFF,alphaMode:oa.NO_PREMULTIPLIED_ALPHA,type:t.type,format:t.format})),r=i+"-"+(e+1);a&&(n.baseTexture.ktxKeyValueData=a),hu.addToCache(n.baseTexture,r),Ru.addToCache(n,r),0===e&&(l[i]=n,hu.addToCache(n.baseTexture,i),Ru.addToCache(n,i)),l[r]=n;}),Object.assign(e,{textures:l});}}catch(t){return void n(t);}n();},t.parse=function(e,n){var i=new DataView(n);if(!t.validate(e,i))return null;var r=67305985===i.getUint32(12,!0),s=i.getUint32(16,r),o=i.getUint32(24,r),a=i.getUint32(28,r),h=i.getUint32(36,r),u=i.getUint32(40,r)||1,l=i.getUint32(44,r)||1,c=i.getUint32(48,r)||1,d=i.getUint32(52,r),p=i.getUint32(56,r),f=i.getUint32(60,r);if(0===u||1!==l)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");var _,m=h+3&-4,g=u+3&-4,v=new Array(c),y=h*u;if(0===s&&(y=m*g),void 0===(_=0!==s?pp[s]?pp[s]*fp[o]:_p[s]:Zd[a]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var T=t.loadKeyValueData?t.parseKvData(i,f,r):null,E=y*_,b=h,x=u,A=m,R=g,O=64+f,S=0;S<p;S++){for(var I=i.getUint32(O,r),w=O+4,C=0;C<c;C++){var N=v[C];N||(N=v[C]=new Array(p)),N[S]={levelID:S,levelWidth:p>1||0!==s?b:A,levelHeight:p>1||0!==s?x:R,levelBuffer:new Uint8Array(n,w,E)},w+=E;}O=(O+=I+4)%4!=0?O+4-O%4:O,E=(A=(b=b>>1||1)+4-1&-4)*(R=(x=x>>1||1)+4-1&-4)*_;}return 0!==s?{uncompressed:v.map(function(e){var n=e[0].levelBuffer,i=!1;return s===ea.FLOAT?n=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):s===ea.UNSIGNED_INT?(i=!0,n=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):s===ea.INT&&(i=!0,n=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new ou(n,{width:e[0].levelWidth,height:e[0].levelHeight}),type:s,format:i?t.convertFormatToInteger(o):o};}),kvData:T}:{compressed:v.map(function(t){return new ep(null,{format:a,width:h,height:u,levels:p,levelBuffers:t});}),kvData:T};},t.validate=function(t,e){for(var n=0;n<dp.length;n++)if(e.getUint8(n)!==dp[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0;},t.convertFormatToInteger=function(t){switch(t){case Jo.RGBA:return Jo.RGBA_INTEGER;case Jo.RGB:return Jo.RGB_INTEGER;case Jo.RG:return Jo.RG_INTEGER;case Jo.RED:return Jo.RED_INTEGER;default:return t;}},t.parseKvData=function(t,e,n){for(var i=new Map(),r=0;r<e;){var s=t.getUint32(64+r,n),o=64+r+4,a=3-(s+3)%4;if(0===s||s>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break;}for(var h=0;h<s&&0!==t.getUint8(o+h);h++);if(-1===h){console.error("KTXLoader: Failed to find null byte terminating kvData key");break;}var u=new TextDecoder().decode(new Uint8Array(t.buffer,o,h)),l=new DataView(t.buffer,o+h+1,s-h-1);i.set(u,l),r+=4+s+a;}return i;},t.loadKeyValueData=!1,t;}(),gp=function(t,e){return gp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},gp(t,e);};function vp(t,e){function n(){this.constructor=t;}gp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}!function(t){function e(e,n,i,r){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===r&&(r=!1);var s=t.call(this)||this;return i>16384&&(i=16384),s._properties=[!1,!0,!1,!1,!1],s._maxSize=e,s._batchSize=i,s._buffers=null,s._bufferUpdateIDs=[],s._updateID=0,s.interactiveChildren=!1,s.blendMode=$o.NORMAL,s.autoResize=r,s.roundPixels=!0,s.baseTexture=null,s.setProperties(n),s._tint=0,s.tintRgb=new Float32Array(4),s.tint=16777215,s;}vp(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4]);},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform();},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint;},set:function(t){this._tint=t,xa(t,this.tintRgb);},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return e.onChildrenChange(0);})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this));},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID;},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null;}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null;};}(Gh);var yp,Tp,Ep=function(){function t(t,e,n){this.geometry=new Lu(),this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var r=t[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||ea.FLOAT,offset:r.offset},e[i]?this.dynamicProperties.push(r):this.staticProperties.push(r);}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers();}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new Cu(function(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var i=0,r=0;i<n;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e;}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n)(o=this.dynamicProperties[n]).offset=e,e+=o.size,this.dynamicStride+=o.size;var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Cu(this.dynamicData,!1,!1);var r=0;for(this.staticStride=0,n=0;n<this.staticProperties.length;++n)(o=this.staticProperties[n]).offset=r,r+=o.size,this.staticStride+=o.size;var s=new ArrayBuffer(this.size*this.staticStride*4*4);for(this.staticData=new Float32Array(s),this.staticDataUint32=new Uint32Array(s),this.staticBuffer=new Cu(this.staticData,!0,!1),n=0;n<this.dynamicProperties.length;++n){var o=this.dynamicProperties[n];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===ea.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset);}for(n=0;n<this.staticProperties.length;++n)o=this.staticProperties[n],t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===ea.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset);},t.prototype.uploadDynamic=function(t,e,n){for(var i=0;i<this.dynamicProperties.length;i++){var r=this.dynamicProperties[i];r.uploadFunction(t,e,n,r.type===ea.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset);}this.dynamicBuffer._updateID++;},t.prototype.uploadStatic=function(t,e,n){for(var i=0;i<this.staticProperties.length;i++){var r=this.staticProperties[i];r.uploadFunction(t,e,n,r.type===ea.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset);}this.staticBuffer._updateID++;},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy();},t;}(),bp=function(t){function e(e){var n=t.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new rh(),n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:ea.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=bl.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=xl.for2d(),n;}return vp(e,t),e.prototype.render=function(t){var e=t.children,n=t._maxSize,i=t._batchSize,r=this.renderer,s=e.length;if(0!==s){s>n&&!t.autoResize&&(s=n);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var a=e[0]._texture.baseTexture;this.state.blendMode=Sa(t.blendMode,a.alphaMode),r.state.set(this.state);var h,u,l,c,d=r.gl,p=t.worldTransform.copyTo(this.tempMatrix);p.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=(h=t.tintRgb,u=t.worldAlpha,l=this.shader.uniforms.uColor,c=a.alphaMode,l=l||new Float32Array(4),c||void 0===c?(l[0]=h[0]*u,l[1]=h[1]*u,l[2]=h[2]*u):(l[0]=h[0],l[1]=h[1],l[2]=h[2]),l[3]=u,l),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);for(var f=!1,_=0,m=0;_<s;_+=i,m+=1){var g=s-_;g>i&&(g=i),m>=o.length&&o.push(this._generateOneMoreBuffer(t));var v=o[m];v.uploadDynamic(e,_,g);var y=t._bufferUpdateIDs[m]||0;(f=f||v._updateID<y)&&(v._updateID=t._updateID,v.uploadStatic(e,_,g)),r.geometry.bind(v.geometry),d.drawElements(d.TRIANGLES,6*g,d.UNSIGNED_SHORT,0);}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,i=t._batchSize,r=t._properties,s=0;s<n;s+=i)e.push(new Ep(this.properties,r,i));return e;},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new Ep(this.properties,n,e);},e.prototype.uploadVertices=function(t,e,n,i,r,s){for(var o=0,a=0,h=0,u=0,l=0;l<n;++l){var c=t[e+l],d=c._texture,p=c.scale.x,f=c.scale.y,_=d.trim,m=d.orig;_?(o=(a=_.x-c.anchor.x*m.width)+_.width,h=(u=_.y-c.anchor.y*m.height)+_.height):(o=m.width*(1-c.anchor.x),a=m.width*-c.anchor.x,h=m.height*(1-c.anchor.y),u=m.height*-c.anchor.y),i[s]=a*p,i[s+1]=u*f,i[s+r]=o*p,i[s+r+1]=u*f,i[s+2*r]=o*p,i[s+2*r+1]=h*f,i[s+3*r]=a*p,i[s+3*r+1]=h*f,s+=4*r;}},e.prototype.uploadPosition=function(t,e,n,i,r,s){for(var o=0;o<n;o++){var a=t[e+o].position;i[s]=a.x,i[s+1]=a.y,i[s+r]=a.x,i[s+r+1]=a.y,i[s+2*r]=a.x,i[s+2*r+1]=a.y,i[s+3*r]=a.x,i[s+3*r+1]=a.y,s+=4*r;}},e.prototype.uploadRotation=function(t,e,n,i,r,s){for(var o=0;o<n;o++){var a=t[e+o].rotation;i[s]=a,i[s+r]=a,i[s+2*r]=a,i[s+3*r]=a,s+=4*r;}},e.prototype.uploadUvs=function(t,e,n,i,r,s){for(var o=0;o<n;++o){var a=t[e+o]._texture._uvs;a?(i[s]=a.x0,i[s+1]=a.y0,i[s+r]=a.x1,i[s+r+1]=a.y1,i[s+2*r]=a.x2,i[s+2*r+1]=a.y2,i[s+3*r]=a.x3,i[s+3*r+1]=a.y3,s+=4*r):(i[s]=0,i[s+1]=0,i[s+r]=0,i[s+r+1]=0,i[s+2*r]=0,i[s+2*r+1]=0,i[s+3*r]=0,i[s+3*r+1]=0,s+=4*r);}},e.prototype.uploadTint=function(t,e,n,i,r,s){for(var o=0;o<n;++o){var a=t[e+o],h=a._texture.baseTexture.alphaMode>0,u=a.alpha,l=u<1&&h?Ia(a._tintRGB,u):a._tintRGB+(255*u<<24);i[s]=l,i[s+r]=l,i[s+2*r]=l,i[s+3*r]=l,s+=4*r;}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null;},e;}(ju);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round";}(yp||(yp={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square";}(Tp||(Tp={}));var xp={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n;}},Ap=function(){function t(){this.color=16777215,this.alpha=1,this.texture=Ru.WHITE,this.matrix=null,this.visible=!1,this.reset();}return t.prototype.clone=function(){var e=new t();return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e;},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Ru.WHITE,this.matrix=null,this.visible=!1;},t.prototype.destroy=function(){this.texture=null,this.matrix=null;},t;}(),Rp=function(t,e){return Rp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Rp(t,e);};function Op(t,e){function n(){this.constructor=t;}Rp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}function Sp(t,e){var n,i;void 0===e&&(e=!1);var r=t.length;if(!(r<6)){for(var s=0,o=0,a=t[r-2],h=t[r-1];o<r;o+=2){var u=t[o],l=t[o+1];s+=(u-a)*(l+h),a=u,h=l;}if(!e&&s>0||e&&s<=0){var c=r/2;for(o=c+c%2;o<r;o+=2){var d=r-o-2,p=r-o-1,f=o,_=o+1;n=[t[f],t[d]],t[d]=n[0],t[f]=n[1],i=[t[_],t[p]],t[p]=i[0],t[_]=i[1];}}}}var Ip={build:function(t){t.points=t.shape.points.slice();},triangulate:function(t,e){var n=t.points,i=t.holes,r=e.points,s=e.indices;if(n.length>=6){Sp(n,!1);for(var o=[],a=0;a<i.length;a++){var h=i[a];Sp(h.points,!0),o.push(n.length/2),n=n.concat(h.points);}var u=ga()(n,o,2);if(!u)return;var l=r.length/2;for(a=0;a<u.length;a+=3)s.push(u[a]+l),s.push(u[a+1]+l),s.push(u[a+2]+l);for(a=0;a<n.length;a++)r.push(n[a]);}}},wp={build:function(t){var e,n,i,r,s,o,a=t.points;if(t.type===Wa.CIRC){var h=t.shape;e=h.x,n=h.y,s=o=h.radius,i=r=0;}else if(t.type===Wa.ELIP){var u=t.shape;e=u.x,n=u.y,s=u.width,o=u.height,i=r=0;}else{var l=t.shape,c=l.width/2,d=l.height/2;e=l.x+c,n=l.y+d,i=c-(s=o=Math.max(0,Math.min(l.radius,Math.min(c,d)))),r=d-o;}if(s>=0&&o>=0&&i>=0&&r>=0){var p=Math.ceil(2.3*Math.sqrt(s+o)),f=8*p+(i?4:0)+(r?4:0);if(a.length=f,0!==f){if(0===p)return a.length=8,a[0]=a[6]=e+i,a[1]=a[3]=n+r,a[2]=a[4]=e-i,void(a[5]=a[7]=n-r);var _,m,g=0,v=4*p+(i?2:0)+2,y=v,T=f,E=e+(_=i+s),b=e-_,x=n+(m=r);if(a[g++]=E,a[g++]=x,a[--v]=x,a[--v]=b,r){var A=n-m;a[y++]=b,a[y++]=A,a[--T]=A,a[--T]=E;}for(var R=1;R<p;R++){var O=Math.PI/2*(R/p);E=e+(_=i+Math.cos(O)*s),b=e-_,x=n+(m=r+Math.sin(O)*o),A=n-m,a[g++]=E,a[g++]=x,a[--v]=x,a[--v]=b,a[y++]=b,a[y++]=A,a[--T]=A,a[--T]=E;}E=e+(_=i),b=e-_,x=n+(m=r+o),A=n-m,a[g++]=E,a[g++]=x,a[--T]=A,a[--T]=E,i&&(a[g++]=b,a[g++]=x,a[--T]=A,a[--T]=b);}}else a.length=0;},triangulate:function(t,e){var n,i,r=t.points,s=e.points,o=e.indices,a=s.length/2,h=a;if(t.type!==Wa.RREC){var u=t.shape;n=u.x,i=u.y;}else{var l=t.shape;n=l.x+l.width/2,i=l.y+l.height/2;}var c=t.matrix;s.push(t.matrix?c.a*n+c.c*i+c.tx:n,t.matrix?c.b*n+c.d*i+c.ty:i),a++,s.push(r[0],r[1]);for(var d=2;d<r.length;d+=2)s.push(r[d],r[d+1]),o.push(a++,h,a);o.push(h+1,h,a);}};function Cp(t,e,n){return t+(e-t)*n;}function Np(t,e,n,i,r,s,o){void 0===o&&(o=[]);for(var a=o,h=0,u=0,l=0,c=0,d=0,p=0,f=0,_=0;f<=20;++f)h=Cp(t,n,_=f/20),u=Cp(e,i,_),l=Cp(n,r,_),c=Cp(i,s,_),d=Cp(h,l,_),p=Cp(u,c,_),0===f&&a[a.length-2]===d&&a[a.length-1]===p||a.push(d,p);return a;}var Mp={build:function(t){if(Qp.nextRoundedRectBehavior)wp.build(t);else{var e=t.shape,n=t.points,i=e.x,r=e.y,s=e.width,o=e.height,a=Math.max(0,Math.min(e.radius,Math.min(s,o)/2));n.length=0,a?(Np(i,r+a,i,r,i+a,r,n),Np(i+s-a,r,i+s,r,i+s,r+a,n),Np(i+s,r+o-a,i+s,r+o,i+s-a,r+o,n),Np(i+a,r+o,i,r+o,i,r+o-a,n)):n.push(i,r,i+s,r,i+s,r+o,i,r+o);}},triangulate:function(t,e){if(Qp.nextRoundedRectBehavior)wp.triangulate(t,e);else{for(var n=t.points,i=e.points,r=e.indices,s=i.length/2,o=ga()(n,null,2),a=0,h=o.length;a<h;a+=3)r.push(o[a]+s),r.push(o[a+1]+s),r.push(o[a+2]+s);for(a=0,h=n.length;a<h;a++)i.push(n[a],n[++a]);}}};function Pp(t,e,n,i,r,s,o,a){var h,u;o?(h=i,u=-n):(h=-i,u=n);var l=t-n*r+h,c=e-i*r+u,d=t+n*s+h,p=e+i*s+u;return a.push(l,c),a.push(d,p),2;}function Dp(t,e,n,i,r,s,o,a){var h=n-t,u=i-e,l=Math.atan2(h,u),c=Math.atan2(r-t,s-e);a&&l<c?l+=2*Math.PI:!a&&l>c&&(c+=2*Math.PI);var d=l,p=c-l,f=Math.abs(p),_=Math.sqrt(h*h+u*u),m=1+(15*f*Math.sqrt(_)/Math.PI>>0),g=p/m;if(d+=g,a){o.push(t,e),o.push(n,i);for(var v=1,y=d;v<m;v++,y+=g)o.push(t,e),o.push(t+Math.sin(y)*_,e+Math.cos(y)*_);o.push(t,e),o.push(r,s);}else{for(o.push(n,i),o.push(t,e),v=1,y=d;v<m;v++,y+=g)o.push(t+Math.sin(y)*_,e+Math.cos(y)*_),o.push(t,e);o.push(r,s),o.push(t,e);}return 2*m;}function Lp(t,e){t.lineStyle.native?function(t,e){var n=0,i=t.shape,r=t.points||i.points,s=i.type!==Wa.POLY||i.closeStroke;if(0!==r.length){var o=e.points,a=e.indices,h=r.length/2,u=o.length/2,l=u;for(o.push(r[0],r[1]),n=1;n<h;n++)o.push(r[2*n],r[2*n+1]),a.push(l,l+1),l++;s&&a.push(l,u);}}(t,e):function(t,e){var n=t.shape,i=t.points||n.points.slice(),r=e.closePointEps;if(0!==i.length){var s=t.lineStyle,o=new Ka(i[0],i[1]),a=new Ka(i[i.length-2],i[i.length-1]),h=n.type!==Wa.POLY||n.closeStroke,u=Math.abs(o.x-a.x)<r&&Math.abs(o.y-a.y)<r;if(h){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var l=.5*(o.x+a.x),c=.5*(a.y+o.y);i.unshift(l,c),i.push(l,c);}var d=e.points,p=i.length/2,f=i.length,_=d.length/2,m=s.width/2,g=m*m,v=s.miterLimit*s.miterLimit,y=i[0],T=i[1],E=i[2],b=i[3],x=0,A=0,R=-(T-b),O=y-E,S=0,I=0,w=Math.sqrt(R*R+O*O);R/=w,O/=w,R*=m,O*=m;var C=s.alignment,N=2*(1-C),M=2*C;h||(s.cap===Tp.ROUND?f+=Dp(y-R*(N-M)*.5,T-O*(N-M)*.5,y-R*N,T-O*N,y+R*M,T+O*M,d,!0)+2:s.cap===Tp.SQUARE&&(f+=Pp(y,T,R,O,N,M,!0,d))),d.push(y-R*N,T-O*N),d.push(y+R*M,T+O*M);for(var P=1;P<p-1;++P){y=i[2*(P-1)],T=i[2*(P-1)+1],E=i[2*P],b=i[2*P+1],x=i[2*(P+1)],A=i[2*(P+1)+1],R=-(T-b),O=y-E,R/=w=Math.sqrt(R*R+O*O),O/=w,R*=m,O*=m,S=-(b-A),I=E-x,S/=w=Math.sqrt(S*S+I*I),I/=w,S*=m,I*=m;var D=E-y,L=T-b,F=E-x,U=A-b,B=L*F-U*D,G=B<0;if(Math.abs(B)<.1)d.push(E-R*N,b-O*N),d.push(E+R*M,b+O*M);else{var k=(-R+y)*(-O+b)-(-R+E)*(-O+T),X=(-S+x)*(-I+b)-(-S+E)*(-I+A),V=(D*X-F*k)/B,H=(U*k-L*X)/B,j=(V-E)*(V-E)+(H-b)*(H-b),Y=E+(V-E)*N,W=b+(H-b)*N,z=E-(V-E)*M,q=b-(H-b)*M,Z=G?N:M;j<=Math.min(D*D+L*L,F*F+U*U)+Z*Z*g?s.join===yp.BEVEL||j/g>v?(G?(d.push(Y,W),d.push(E+R*M,b+O*M),d.push(Y,W),d.push(E+S*M,b+I*M)):(d.push(E-R*N,b-O*N),d.push(z,q),d.push(E-S*N,b-I*N),d.push(z,q)),f+=2):s.join===yp.ROUND?G?(d.push(Y,W),d.push(E+R*M,b+O*M),f+=Dp(E,b,E+R*M,b+O*M,E+S*M,b+I*M,d,!0)+4,d.push(Y,W),d.push(E+S*M,b+I*M)):(d.push(E-R*N,b-O*N),d.push(z,q),f+=Dp(E,b,E-R*N,b-O*N,E-S*N,b-I*N,d,!1)+4,d.push(E-S*N,b-I*N),d.push(z,q)):(d.push(Y,W),d.push(z,q)):(d.push(E-R*N,b-O*N),d.push(E+R*M,b+O*M),s.join===yp.ROUND?f+=G?Dp(E,b,E+R*M,b+O*M,E+S*M,b+I*M,d,!0)+2:Dp(E,b,E-R*N,b-O*N,E-S*N,b-I*N,d,!1)+2:s.join===yp.MITER&&j/g<=v&&(G?(d.push(z,q),d.push(z,q)):(d.push(Y,W),d.push(Y,W)),f+=2),d.push(E-S*N,b-I*N),d.push(E+S*M,b+I*M),f+=2);}}y=i[2*(p-2)],T=i[2*(p-2)+1],E=i[2*(p-1)],R=-(T-(b=i[2*(p-1)+1])),O=y-E,R/=w=Math.sqrt(R*R+O*O),O/=w,R*=m,O*=m,d.push(E-R*N,b-O*N),d.push(E+R*M,b+O*M),h||(s.cap===Tp.ROUND?f+=Dp(E-R*(N-M)*.5,b-O*(N-M)*.5,E-R*N,b-O*N,E+R*M,b+O*M,d,!1)+2:s.cap===Tp.SQUARE&&(f+=Pp(E,b,R,O,N,M,!1,d)));var K=e.indices,$=xp.epsilon*xp.epsilon;for(P=_;P<f+_-2;++P)y=d[2*P],T=d[2*P+1],E=d[2*(P+1)],b=d[2*(P+1)+1],x=d[2*(P+2)],A=d[2*(P+2)+1],Math.abs(y*(b-A)+E*(A-T)+x*(T-b))<$||K.push(P,P+1,P+2);}}(t,e);}var Fp,Up,Bp=function(){function t(){}return t.curveTo=function(t,e,n,i,r,s){var o=s[s.length-2],a=s[s.length-1]-e,h=o-t,u=i-e,l=n-t,c=Math.abs(a*l-h*u);if(c<1e-8||0===r)return s[s.length-2]===t&&s[s.length-1]===e||s.push(t,e),null;var d=a*a+h*h,p=u*u+l*l,f=a*u+h*l,_=r*Math.sqrt(d)/c,m=r*Math.sqrt(p)/c,g=_*f/d,v=m*f/p,y=_*l+m*h,T=_*u+m*a,E=h*(m+g),b=a*(m+g),x=l*(_+v),A=u*(_+v);return{cx:y+t,cy:T+e,radius:r,startAngle:Math.atan2(b-T,E-y),endAngle:Math.atan2(A-T,x-y),anticlockwise:h*u>l*a};},t.arc=function(t,e,n,i,r,s,o,a,h){for(var u=o-s,l=xp._segmentsCount(Math.abs(u)*r,40*Math.ceil(Math.abs(u)/za)),c=u/(2*l),d=2*c,p=Math.cos(c),f=Math.sin(c),_=l-1,m=_%1/_,g=0;g<=_;++g){var v=c+s+d*(g+m*g),y=Math.cos(v),T=-Math.sin(v);h.push((p*y+f*T)*r+n,(p*-T+f*y)*r+i);}},t;}(),Gp=function(){function t(){}return t.curveLength=function(t,e,n,i,r,s,o,a){for(var h=0,u=0,l=0,c=0,d=0,p=0,f=0,_=0,m=0,g=0,v=0,y=t,T=e,E=1;E<=10;++E)g=y-(_=(f=(p=(d=1-(u=E/10))*d)*d)*t+3*p*u*n+3*d*(l=u*u)*r+(c=l*u)*o),v=T-(m=f*e+3*p*u*i+3*d*l*s+c*a),y=_,T=m,h+=Math.sqrt(g*g+v*v);return h;},t.curveTo=function(e,n,i,r,s,o,a){var h=a[a.length-2],u=a[a.length-1];a.length-=2;var l=xp._segmentsCount(t.curveLength(h,u,e,n,i,r,s,o)),c=0,d=0,p=0,f=0,_=0;a.push(h,u);for(var m=1,g=0;m<=l;++m)p=(d=(c=1-(g=m/l))*c)*c,_=(f=g*g)*g,a.push(p*h+3*d*g*e+3*c*f*i+_*s,p*u+3*d*g*n+3*c*f*r+_*o);},t;}(),kp=function(){function t(){}return t.curveLength=function(t,e,n,i,r,s){var o=t-2*n+r,a=e-2*i+s,h=2*n-2*t,u=2*i-2*e,l=4*(o*o+a*a),c=4*(o*h+a*u),d=h*h+u*u,p=2*Math.sqrt(l+c+d),f=Math.sqrt(l),_=2*l*f,m=2*Math.sqrt(d),g=c/f;return(_*p+f*c*(p-m)+(4*d*l-c*c)*Math.log((2*f+g+p)/(g+m)))/(4*_);},t.curveTo=function(e,n,i,r,s){for(var o=s[s.length-2],a=s[s.length-1],h=xp._segmentsCount(t.curveLength(o,a,e,n,i,r)),u=0,l=0,c=1;c<=h;++c){var d=c/h;u=o+(e-o)*d,l=a+(n-a)*d,s.push(u+(e+(i-e)*d-u)*d,l+(n+(r-n)*d-l)*d);}},t;}(),Xp=function(){function t(){this.reset();}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n;},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start;},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0;},t;}(),Vp=((Fp={})[Wa.POLY]=Ip,Fp[Wa.CIRC]=wp,Fp[Wa.ELIP]=wp,Fp[Wa.RECT]={build:function(t){var e=t.shape,n=e.x,i=e.y,r=e.width,s=e.height,o=t.points;o.length=0,o.push(n,i,n+r,i,n+r,i+s,n,i+s);},triangulate:function(t,e){var n=t.points,i=e.points,r=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3);}},Fp[Wa.RREC]=Mp,Fp),Hp=[],jp=[],Yp=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type;}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix);},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null;},t;}(),Wp=new Ka(),zp=new fh(),qp=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new fh(),e.boundsDirty=-1,e;}return Op(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds;},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),jp.push(this.drawCalls[t]);for(this.drawCalls.length=0,t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Hp.push(e);}this.batches.length=0;},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this;},e.prototype.drawShape=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null);var r=new Yp(t,e,n,i);return this.graphicsData.push(r),this.dirty++,this;},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new Yp(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this;},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null;},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var i=e[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,Wp):Wp.copyFrom(t),i.shape.contains(Wp.x,Wp.y))){var r=!1;if(i.holes)for(var s=0;s<i.holes.length;s++)if(i.holes[s].shape.contains(Wp.x,Wp.y)){r=!0;break;}if(!r)return!0;}}return!1;},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,i=null,r=null;this.batches.length>0&&(r=(i=this.batches[this.batches.length-1]).style);for(var s=this.shapeIndex;s<n.length;s++){this.shapeIndex++;var o=n[s],a=o.fillStyle,h=o.lineStyle;Vp[o.type].build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(a.visible||h.visible)&&this.processHoles(o.holes);for(var u=0;u<2;u++){var l=0===u?a:h;if(l.visible){var c=l.texture.baseTexture,d=this.indices.length,p=this.points.length/2;c.wrapMode=ra.REPEAT,0===u?this.processFill(o):this.processLine(o);var f=this.points.length/2-p;0!==f&&(i&&!this._compareStyles(r,l)&&(i.end(d,p),i=null),i||((i=Hp.pop()||new Xp()).begin(l,d,p),this.batches.push(i),r=l),this.addUvs(this.points,e,l.texture,p,f,l.matrix));}}}var _=this.indices.length,m=this.points.length/2;if(i&&i.end(_,m),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=m>65535&&t;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices);}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls();}else this.batchable=!0;}}else this.batchable=!0;},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native;},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],i=n.fillStyle,r=n.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1;}return!0;},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var i=t[e],r=0;r<i.size;r++){var s=i.start+r;this.indicesUint16[s]=this.indicesUint16[s]-i.attribStart;}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE;},e.prototype.buildDrawCalls=function(){for(var t=++hu._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),jp.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,i=this.textureIds,r=jp.pop();r||((r=new ec()).texArray=new nc()),r.texArray.count=0,r.start=0,r.size=0,r.type=Qo.TRIANGLES;var s=0,o=null,a=0,h=!1,u=Qo.TRIANGLES,l=0;for(this.drawCalls.push(r),e=0;e<this.batches.length;e++){var c=this.batches[e],d=c.style,p=d.texture.baseTexture;h!==!!d.native&&(u=(h=!!d.native)?Qo.LINES:Qo.TRIANGLES,o=null,s=8,t++),o!==p&&(o=p,p._batchEnabled!==t&&(8===s&&(t++,s=0,r.size>0&&((r=jp.pop())||((r=new ec()).texArray=new nc()),this.drawCalls.push(r)),r.start=l,r.size=0,r.texArray.count=0,r.type=u),p.touched=1,p._batchEnabled=t,p._batchLocation=s,p.wrapMode=ra.REPEAT,r.texArray.elements[r.texArray.count++]=p,s++)),r.size+=c.size,l+=c.size,a=p._batchLocation,this.addColors(n,d.color,d.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,a,c.attribSize,c.attribStart);}hu._globalBatch=t,this.packAttributes();},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,i=this.textureIds,r=new ArrayBuffer(3*t.length*4),s=new Float32Array(r),o=new Uint32Array(r),a=0,h=0;h<t.length/2;h++)s[a++]=t[2*h],s[a++]=t[2*h+1],s[a++]=e[2*h],s[a++]=e[2*h+1],o[a++]=n[h],s[a++]=i[h];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16);},e.prototype.processFill=function(t){t.holes.length?Ip.triangulate(t,this):Vp[t.type].triangulate(t,this);},e.prototype.processLine=function(t){Lp(t,this);for(var e=0;e<t.holes.length;e++)Lp(t.holes[e],this);},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];Vp[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix);}},e.prototype.calculateBounds=function(){var t=this._bounds,e=zp,n=rh.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var r=this.graphicsData[i],s=r.shape,o=r.type,a=r.lineStyle,h=r.matrix||rh.IDENTITY,u=0;if(a&&a.visible&&(u=a.width,o!==Wa.POLY||r.fillStyle.visible?u*=Math.max(0,a.alignment):u*=Math.max(a.alignment,1-a.alignment)),n!==h&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=h),o===Wa.RECT||o===Wa.RREC){var l=s;e.addFramePad(l.x,l.y,l.x+l.width,l.y+l.height,u,u);}else if(o===Wa.CIRC){var c=s;e.addFramePad(c.x,c.y,c.x,c.y,c.radius+u,c.radius+u);}else if(o===Wa.ELIP){var d=s;e.addFramePad(d.x,d.y,d.x,d.y,d.width+u,d.height+u);}else{var p=s;t.addVerticesMatrix(n,p.points,0,p.points.length,u,u);}}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding);},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var i=t[2*n],r=t[2*n+1];t[2*n]=e.a*i+e.c*r+e.tx,t[2*n+1]=e.b*i+e.d*r+e.ty;}},e.prototype.addColors=function(t,e,n,i,r){void 0===r&&(r=0);var s=Ia((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,r+i);for(var o=0;o<i;o++)t[r+o]=s;},e.prototype.addTextureIds=function(t,e,n,i){void 0===i&&(i=0),t.length=Math.max(t.length,i+n);for(var r=0;r<n;r++)t[i+r]=e;},e.prototype.addUvs=function(t,e,n,i,r,s){void 0===s&&(s=null);for(var o=0,a=e.length,h=n.frame;o<r;){var u=t[2*(i+o)],l=t[2*(i+o)+1];if(s){var c=s.a*u+s.c*l+s.tx;l=s.b*u+s.d*l+s.ty,u=c;}o++,e.push(u/h.width,l/h.height);}var d=n.baseTexture;(h.width<d.width||h.height<d.height)&&this.adjustUvs(e,n,a,r);},e.prototype.adjustUvs=function(t,e,n,i){for(var r=e.baseTexture,s=1e-6,o=n+2*i,a=e.frame,h=a.width/r.width,u=a.height/r.height,l=a.x/a.width,c=a.y/a.height,d=Math.floor(t[n]+s),p=Math.floor(t[n+1]+s),f=n+2;f<o;f+=2)d=Math.min(d,Math.floor(t[f]+s)),p=Math.min(p,Math.floor(t[f+1]+s));for(l-=d,c-=p,f=n;f<o;f+=2)t[f]=(t[f]+l)*h,t[f+1]=(t[f+1]+c)*u;},e.BATCHABLE_SIZE=100,e;}(oc),Zp=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Tp.BUTT,e.join=yp.MITER,e.miterLimit=10,e;}return Op(e,t),e.prototype.clone=function(){var t=new e();return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t;},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1;},e;}(Ap),Kp=new Float32Array(3),$p={},Qp=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new Ap(),n._lineStyle=new Zp(),n._matrix=null,n._holeMode=!1,n.state=xl.for2d(),n._geometry=e||new qp(),n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=$o.NORMAL,n;}return Op(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry;},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry);},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode;},set:function(t){this.state.blendMode=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint;},set:function(t){this._tint=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle;},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,n,i,r){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=.5),void 0===r&&(r=!1),"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:i,native:r}),this.lineTextureStyle(t);},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Ru.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Tp.BUTT,join:yp.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this;},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new eh(),this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]));}else this.currentPath=new eh(),this.currentPath.closeStroke=!1;},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0);},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this;},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,i=n[n.length-2],r=n[n.length-1];return i===t&&r===e||n.push(t,e),this;},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e);},e.prototype.quadraticCurveTo=function(t,e,n,i){this._initCurve();var r=this.currentPath.points;return 0===r.length&&this.moveTo(0,0),kp.curveTo(t,e,n,i,r),this;},e.prototype.bezierCurveTo=function(t,e,n,i,r,s){return this._initCurve(),Gp.curveTo(t,e,n,i,r,s,this.currentPath.points),this;},e.prototype.arcTo=function(t,e,n,i,r){this._initCurve(t,e);var s=this.currentPath.points,o=Bp.curveTo(t,e,n,i,r,s);if(o){var a=o.cx,h=o.cy,u=o.radius,l=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(a,h,u,l,c,d);}return this;},e.prototype.arc=function(t,e,n,i,r,s){if(void 0===s&&(s=!1),i===r)return this;if(!s&&r<=i?r+=za:s&&i<=r&&(i+=za),0==r-i)return this;var o=t+Math.cos(i)*n,a=e+Math.sin(i)*n,h=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var l=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-a);l<h&&c<h||u.push(o,a);}else this.moveTo(o,a),u=this.currentPath.points;return Bp.arc(o,a,t,e,n,i,r,s,u),this;},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:Ru.WHITE,color:t,alpha:e});},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Ru.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this;},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this;},e.prototype.drawRect=function(t,e,n,i){return this.drawShape(new Qa(t,e,n,i));},e.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new nh(t,e,n,i,r));},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new Ja(t,e,n));},e.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new th(t,e,n,i));},e.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];var r=!0,s=n[0];s.points?(r=s.closeStroke,t=s.points):t=Array.isArray(n[0])?n[0]:n;var o=new eh(t);return o.closeStroke=r,this.drawShape(o),this;},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this;},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this;},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==Wa.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width);},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t));},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var i=0;i<n;i++){var r=t.batches[i],s=r.style.color,o=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),h={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*r.start,r.size),uvs:a,_batchRGB:xa(s),_tintRGB:s,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=h;}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i);}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,i=this.tint,r=this.worldAlpha,s=e.uniforms,o=n.drawCalls;s.translationMatrix=this.transform.worldTransform,s.tint[0]=(i>>16&255)/255*r,s.tint[1]=(i>>8&255)/255*r,s.tint[2]=(255&i)/255*r,s.tint[3]=r,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,h=o.length;a<h;a++)this._renderDrawCallDirect(t,n.drawCalls[a]);},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,i=e.type,r=e.size,s=e.start,o=n.count,a=0;a<o;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(i,r,s);},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!$p[n]){for(var i=t.plugins[n].MAX_TEXTURES,r=new Int32Array(i),s=0;s<i;s++)r[s]=s;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new rh(),default:Gu.from({uSamplers:r},!0)},a=t.plugins[n]._shader.program;$p[n]=new bl(a,o);}e=$p[n];}return e;},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,i=e.minY,r=e.maxX,s=e.maxY;this._bounds.addFrame(this.transform,n,i,r,s);}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT);},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=xa(this.tint,Kp),e=0;e<this.batches.length;e++){var n=this.batches[e],i=n._batchRGB,r=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);n._tintRGB=(r>>16)+(65280&r)+((255&r)<<16);}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,s=e.d,o=e.tx,a=e.ty,h=this._geometry.points,u=this.vertexData,l=0,c=0;c<h.length;c+=2){var d=h[c],p=h[c+1];u[l++]=n*d+r*p+o,u[l++]=s*p+i*d+a;}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this;},e.prototype.setMatrix=function(t){return this._matrix=t,this;},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this;},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this;},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e);},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new Ka(),e;}(Gh),Jp=function(t,e){return Jp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Jp(t,e);},tf=new Ka(),ef=new Uint16Array([0,1,2,0,2,3]),nf=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new ih(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=$o.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||Ru.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=ef,n.pluginName="batch",n.isSprite=!0,n._roundPixels=pa.ROUND_PIXELS,n;}return function(t,e){function n(){this.constructor=t;}Jp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=La(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=La(this.scale.y)*this._height/this._texture.orig.height);},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1;},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,s=e.d,o=e.tx,a=e.ty,h=this.vertexData,u=t.trim,l=t.orig,c=this._anchor,d=0,p=0,f=0,_=0;if(u?(d=(p=u.x-c._x*l.width)+u.width,f=(_=u.y-c._y*l.height)+u.height):(d=(p=-c._x*l.width)+l.width,f=(_=-c._y*l.height)+l.height),h[0]=n*p+r*_+o,h[1]=s*_+i*p+a,h[2]=n*d+r*_+o,h[3]=s*_+i*d+a,h[4]=n*d+r*f+o,h[5]=s*f+i*d+a,h[6]=n*p+r*f+o,h[7]=s*f+i*p+a,this._roundPixels)for(var m=pa.RESOLUTION,g=0;g<h.length;++g)h[g]=Math.round((h[g]*m|0)/m);}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,s=r.a,o=r.b,a=r.c,h=r.d,u=r.tx,l=r.ty,c=-i._x*n.width,d=c+n.width,p=-i._y*n.height,f=p+n.height;e[0]=s*c+a*p+u,e[1]=h*p+o*c+l,e[2]=s*d+a*p+u,e[3]=h*p+o*d+l,e[4]=s*d+a*f+u,e[5]=h*f+o*d+l,e[6]=s*c+a*f+u,e[7]=h*f+o*c+l;},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this);},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData));},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new fh()),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Qa()),e=this._localBoundsRect),this._localBounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e);},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,tf);var e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x,r=0;return tf.x>=i&&tf.x<i+e&&(r=-n*this.anchor.y,tf.y>=r&&tf.y<r+n);},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n);}this._texture=null;},e.from=function(t,n){return new e(t instanceof Ru?t:Ru.from(t,n));},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels;},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width;},set:function(t){var e=La(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height;},set:function(t){var e=La(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor;},set:function(t){this._anchor.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint;},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture;},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Ru.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)));},enumerable:!1,configurable:!0}),e;}(Gh),rf=function(t,e){return rf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},rf(t,e);};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL";}(Up||(Up={}));var sf={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Up.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},of=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],af=function(){function t(t){this.styleID=0,this.reset(),lf(this,t,t);}return t.prototype.clone=function(){var e={};return lf(e,this,sf),new t(e);},t.prototype.reset=function(){lf(this,sf,sf);},Object.defineProperty(t.prototype,"align",{get:function(){return this._align;},set:function(t){this._align!==t&&(this._align=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords;},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow;},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha;},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle;},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur;},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor;},set:function(t){var e=uf(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance;},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill;},set:function(t){var e=uf(t);this._fill!==e&&(this._fill=e,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType;},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops;},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0;})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily;},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize;},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle;},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant;},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight;},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing;},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight;},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading;},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin;},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit;},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding;},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke;},set:function(t){var e=uf(t);this._stroke!==e&&(this._stroke=e,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness;},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline;},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim;},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace;},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap;},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++);},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth;},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++);},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&of.indexOf(i)<0&&(i='"'+i+'"'),e[n]=i;}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",");},t;}();function hf(t){return"number"==typeof t?Aa(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t);}function uf(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=hf(t[e]);return t;}return hf(t);}function lf(t,e,n){for(var i in n)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i];}var cf=function(){function t(t,e,n,i,r,s,o,a,h){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h;}return t.measureText=function(e,n,i,r){void 0===r&&(r=t._canvas),i=null==i?n.wordWrap:i;var s=n.toFontString(),o=t.measureFont(s);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);var a=r.getContext("2d");a.font=s;for(var h=(i?t.wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(h.length),l=0,c=0;c<h.length;c++){var d=a.measureText(h[c]).width+(h[c].length-1)*n.letterSpacing;u[c]=d,l=Math.max(l,d);}var p=l+n.strokeThickness;n.dropShadow&&(p+=n.dropShadowDistance);var f=n.lineHeight||o.fontSize+n.strokeThickness,_=Math.max(f,o.fontSize+n.strokeThickness)+(h.length-1)*(f+n.leading);return n.dropShadow&&(_+=n.dropShadowDistance),new t(e,n,p,_,h,u,f+n.leading,l,o);},t.wordWrap=function(e,n,i){void 0===i&&(i=t._canvas);for(var r=i.getContext("2d"),s=0,o="",a="",h=Object.create(null),u=n.letterSpacing,l=n.whiteSpace,c=t.collapseSpaces(l),d=t.collapseNewlines(l),p=!c,f=n.wordWrapWidth+u,_=t.tokenize(e),m=0;m<_.length;m++){var g=_[m];if(t.isNewline(g)){if(!d){a+=t.addLine(o),p=!c,o="",s=0;continue;}g=" ";}if(c){var v=t.isBreakingSpace(g),y=t.isBreakingSpace(o[o.length-1]);if(v&&y)continue;}var T=t.getFromCache(g,u,h,r);if(T>f){if(""!==o&&(a+=t.addLine(o),o="",s=0),t.canBreakWords(g,n.breakWords))for(var E=t.wordWrapSplit(g),b=0;b<E.length;b++){for(var x=E[b],A=1;E[b+A];){var R=E[b+A],O=x[x.length-1];if(t.canBreakChars(O,R,g,b,n.breakWords))break;x+=R,A++;}b+=x.length-1;var S=t.getFromCache(x,u,h,r);S+s>f&&(a+=t.addLine(o),p=!1,o="",s=0),o+=x,s+=S;}else{o.length>0&&(a+=t.addLine(o),o="",s=0);var I=m===_.length-1;a+=t.addLine(g,!I),p=!1,o="",s=0;}}else T+s>f&&(p=!1,a+=t.addLine(o),o="",s=0),(o.length>0||!t.isBreakingSpace(g)||p)&&(o+=g,s+=T);}return a+t.addLine(o,!1);},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),n?e+"\n":e;},t.getFromCache=function(t,e,n,i){var r=n[t];if("number"!=typeof r){var s=t.length*e;r=i.measureText(t).width+s,n[t]=r;}return r;},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t;},t.collapseNewlines=function(t){return"normal"===t;},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var i=e[n];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1);}return e;},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0;},t.isBreakingSpace=function(e,n){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0;},t.tokenize=function(e){var n=[],i="";if("string"!=typeof e)return n;for(var r=0;r<e.length;r++){var s=e[r],o=e[r+1];t.isBreakingSpace(s,o)||t.isNewline(s)?(""!==i&&(n.push(i),i=""),n.push(s)):i+=s;}return""!==i&&n.push(i),n;},t.canBreakWords=function(t,e){return e;},t.canBreakChars=function(t,e,n,i,r){return!0;},t.wordWrapSplit=function(t){return t.split("");},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},i=t._canvas,r=t._context;r.font=e;var s=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(r.measureText(s).width),a=Math.ceil(r.measureText(t.BASELINE_SYMBOL).width),h=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,i.width=o,i.height=h,r.fillStyle="#f00",r.fillRect(0,0,o,h),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,a);var u=r.getImageData(0,0,o,h).data,l=u.length,c=4*o,d=0,p=0,f=!1;for(d=0;d<a;++d){for(var _=0;_<c;_+=4)if(255!==u[p+_]){f=!0;break;}if(f)break;p+=c;}for(n.ascent=a-d,p=l-c,f=!1,d=h;d>a;--d){for(_=0;_<c;_+=4)if(255!==u[p+_]){f=!0;break;}if(f)break;p-=c;}return n.descent=d-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n;},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={};},Object.defineProperty(t,"_canvas",{get:function(){if(!t.__canvas){var e=void 0;try{var n=new OffscreenCanvas(0,0),i=n.getContext("2d");if(i&&i.measureText)return t.__canvas=n,n;e=document.createElement("canvas");}catch(t){e=document.createElement("canvas");}e.width=e.height=10,t.__canvas=e;}return t.__canvas;},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_context",{get:function(){return t.__context||(t.__context=t._canvas.getContext("2d")),t.__context;},enumerable:!1,configurable:!0}),t;}();cf._fonts={},cf.METRICS_STRING="|ÉqÅ",cf.BASELINE_SYMBOL="M",cf.BASELINE_MULTIPLIER=1.4,cf.HEIGHT_MULTIPLIER=2,cf._newlines=[10,13],cf._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var df={texture:!0,children:!1,baseTexture:!0},pf=function(t){function e(e,n,i){var r=this,s=!1;i||(i=document.createElement("canvas"),s=!0),i.width=3,i.height=3;var o=Ru.from(i);return o.orig=new Qa(),o.trim=new Qa(),(r=t.call(this,o)||this)._ownCanvas=s,r.canvas=i,r.context=r.canvas.getContext("2d"),r._resolution=pa.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=e,r.style=n,r.localStyleID=-1,r;}return function(t,e){function n(){this.constructor=t;}rf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,s=this.context,o=cf.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=o.width,h=o.height,u=o.lines,l=o.lineHeight,c=o.lineWidths,d=o.maxLineWidth,p=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,h)+2*n.padding)*this._resolution),s.scale(this._resolution,this._resolution),s.clearRect(0,0,this.canvas.width,this.canvas.height),s.font=this._font,s.lineWidth=n.strokeThickness,s.textBaseline=n.textBaseline,s.lineJoin=n.lineJoin,s.miterLimit=n.miterLimit;for(var f=n.dropShadow?2:1,_=0;_<f;++_){var m=n.dropShadow&&0===_,g=m?Math.ceil(Math.max(1,h)+2*n.padding):0,v=g*this._resolution;if(m){s.fillStyle="black",s.strokeStyle="black";var y=n.dropShadowColor,T=xa("number"==typeof y?y:Ra(y)),E=n.dropShadowBlur*this._resolution,b=n.dropShadowDistance*this._resolution;s.shadowColor="rgba("+255*T[0]+","+255*T[1]+","+255*T[2]+","+n.dropShadowAlpha+")",s.shadowBlur=E,s.shadowOffsetX=Math.cos(n.dropShadowAngle)*b,s.shadowOffsetY=Math.sin(n.dropShadowAngle)*b+v;}else s.fillStyle=this._generateFillStyle(n,u,o),s.strokeStyle=n.stroke,s.shadowColor="black",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0;var x=(l-p.fontSize)/2;(!e.nextLineHeightBehavior||l-p.fontSize<0)&&(x=0);for(var A=0;A<u.length;A++)i=n.strokeThickness/2,r=n.strokeThickness/2+A*l+p.ascent+x,"right"===n.align?i+=d-c[A]:"center"===n.align&&(i+=(d-c[A])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[A],i+n.padding,r+n.padding-g,!0),n.fill&&this.drawLetterSpacing(u[A],i+n.padding,r+n.padding-g);}this.updateTexture();}},e.prototype.drawLetterSpacing=function(t,n,i,r){void 0===r&&(r=!1);var s=this._style.letterSpacing,o=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===s||o)return o&&(this.context.letterSpacing=s,this.context.textLetterSpacing=s),void(r?this.context.strokeText(t,n,i):this.context.fillText(t,n,i));for(var a=n,h=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,l=0,c=0;c<h.length;++c){var d=h[c];r?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);for(var p="",f=c+1;f<h.length;++f)p+=h[f];a+=u-(l=this.context.measureText(p).width)+s,u=l;}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,n,i,r=t.width,s=t.height,o=t.getContext("2d"),a=o.getImageData(0,0,r,s).data,h=a.length,u={top:null,left:null,right:null,bottom:null},l=null;for(e=0;e<h;e+=4)0!==a[e+3]&&(n=e/4%r,i=~~(e/4/r),null===u.top&&(u.top=i),(null===u.left||n<u.left)&&(u.left=n),(null===u.right||u.right<n)&&(u.right=n+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(r=u.right-u.left,s=u.bottom-u.top+1,l=o.getImageData(u.left,u.top,r,s)),{height:s,width:r,data:l};}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0));}var n=this._texture,i=this._style,r=i.trim?0:i.padding,s=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-r,n.trim.y=-r,n.orig.width=n._frame.width-2*r,n.orig.height=n._frame.height-2*r,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this.dirty=!1;},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e);},e.prototype.updateTransform=function(){this.updateText(!0),t.prototype.updateTransform.call(this);},e.prototype.getBounds=function(e,n){return this.updateText(!0),-1===this._textureID&&(e=!1),t.prototype.getBounds.call(this,e,n);},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e);},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData);},e.prototype._generateFillStyle=function(t,e,n){var i,r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];var s=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,a=this.canvas.width/this._resolution-s-2*o,h=this.canvas.height/this._resolution-s-2*o,u=r.slice(),l=t.fillGradientStops.slice();if(!l.length)for(var c=u.length+1,d=1;d<c;++d)l.push(d/c);if(u.unshift(r[0]),l.unshift(0),u.push(r[r.length-1]),l.push(1),t.fillGradientType===Up.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,h+o);var p=n.fontProperties.fontSize+t.strokeThickness;for(d=0;d<e.length;d++){var f=n.lineHeight*(d-1)+p,_=n.lineHeight*d,m=_;d>0&&f>_&&(m=(_+f)/2);var g=_+p,v=n.lineHeight*(d+1),y=g;d+1<e.length&&v<g&&(y=(g+v)/2);for(var T=(y-m)/h,E=0;E<u.length;E++){var b;b="number"==typeof l[E]?l[E]:E/u.length;var x=Math.min(1,Math.max(0,m/h+b*T));x=Number(x.toFixed(5)),i.addColorStop(x,u[E]);}}}else{i=this.context.createLinearGradient(o,h/2,a+o,h/2);var A=u.length+1,R=1;for(d=0;d<u.length;d++){var O;O="number"==typeof l[d]?l[d]:R/A,i.addColorStop(O,u[d]),R++;}}return i;},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},df,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null;},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width;},set:function(t){this.updateText(!0);var e=La(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height;},set:function(t){this.updateText(!0);var e=La(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style;},set:function(t){t=t||{},this._style=t instanceof af?t:new af(t),this.localStyleID=-1,this.dirty=!0;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text;},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution;},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0);},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e;}(nf);pa.UPLOADS_PER_FRAME=4;var ff=function(t,e){return ff=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},ff(t,e);},_f=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0;}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame;},t.prototype.allowedToUpload=function(){return this.itemsLeft-->0;},t;}();function mf(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Ru){var r=t._textures[i].baseTexture;-1===e.indexOf(r)&&(e.push(r),n=!0);}return n;}function gf(t,e){if(t.baseTexture instanceof hu){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0;}return!1;}function vf(t,e){if(t._texture&&t._texture instanceof Ru){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0;}return!1;}function yf(t,e){return e instanceof pf&&(e.updateText(!0),!0);}function Tf(t,e){if(e instanceof af){var n=e.toFontString();return cf.measureFont(n),!0;}return!1;}function Ef(t,e){if(t instanceof pf){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0;}return!1;}function bf(t,e){return t instanceof af&&(-1===e.indexOf(t)&&e.push(t),!0);}function xf(t,e){return e instanceof hu&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0);}function Af(t,e){if(!(e instanceof Qp))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var i=n.batches,r=0;r<i.length;r++){var s=i[r].style.texture;s&&xf(t,s.baseTexture);}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0;}function Rf(t,e){return t instanceof Qp&&(e.push(t),!0);}var Of=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(Rf),n.registerUploadHook(xf),n.registerUploadHook(Af),n;}return function(t,e){function n(){this.constructor=t;}ff(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e;}(function(){function t(t){var e=this;this.limiter=new _f(pa.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems();},this.registerFindHook(Ef),this.registerFindHook(bf),this.registerFindHook(mf),this.registerFindHook(gf),this.registerFindHook(vf),this.registerUploadHook(yf),this.registerUploadHook(Tf);}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,Hh.system.addOnce(this.tick,this,kh.UTILITY))):e&&e();},t.prototype.tick=function(){setTimeout(this.delayedTick,0);},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break;}e||this.queue.shift();}if(this.queue.length)Hh.system.addOnce(this.tick,this,kh.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);for(this.completes.length=0,n=0,i=r.length;n<i;n++)r[n]();}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this;},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this;},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof Gh)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this;},t.prototype.destroy=function(){this.ticking&&Hh.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null;},t;}()),Sf=(function(){function t(t){this.maxMilliseconds=t,this.frameStart=0;}t.prototype.beginFrame=function(){this.frameStart=Date.now();},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds;};}(),function(){function t(t,e,n){void 0===n&&(n=null),this._texture=t instanceof Ru?t:null,this.baseTexture=t instanceof hu?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(n||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null;}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=Ya(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n;},t.prototype.parse=function(e){this._batchIndex=0,this._callback=e,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch();},t.prototype._processFrames=function(e){for(var n=e,i=t.BATCH_SIZE;n-e<i&&n<this._frameKeys.length;){var r=this._frameKeys[n],s=this._frames[r],o=s.frame;if(o){var a,h=null,u=!1!==s.trimmed&&s.sourceSize?s.sourceSize:s.frame,l=new Qa(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);a=s.rotated?new Qa(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new Qa(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==s.trimmed&&s.spriteSourceSize&&(h=new Qa(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new Ru(this.baseTexture,a,l,h,s.rotated?2:0,s.anchor),Ru.addToCache(this.textures[r],r);}n++;}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var i=t[e][n];this.animations[e].push(this.textures[i]);}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures);},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete());},0);},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null;},t.BATCH_SIZE=1e3,t;}()),If=function(){function t(){}return t.use=function(e,n){var i,r,s=this,o=e.name+"_image";if(e.data&&e.type===Bd.TYPE.JSON&&e.data.frames&&!s.resources[o]){var a=null===(r=null===(i=e.data)||void 0===i?void 0:i.meta)||void 0===r?void 0:r.related_multi_packs;if(Array.isArray(a))for(var h=function(t){if("string"!=typeof t)return"continue";var n=t.replace(".json",""),i=ya.resolve(e.url.replace(s.baseUrl,""),t);if(s.resources[n]||Object.values(s.resources).some(function(t){return ya.format(ya.parse(t.url))===i;}))return"continue";var r={crossOrigin:e.crossOrigin,loadType:Bd.LOAD_TYPE.XHR,xhrType:Bd.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};s.add(n,i,r);},u=0,l=a;u<l.length;u++)h(l[u]);var c={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},d=t.getResourcePath(e,s.baseUrl);s.add(o,d,c,function(t){if(t.error)n(t.error);else{var i=new Sf(t.texture,e.data,e.url);i.parse(function(){e.spritesheet=i,e.textures=i.textures,n();});}});}else n();},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:ya.resolve(t.url.replace(e,""),t.data.meta.image);},t;}(),wf=function(t,e){return wf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},wf(t,e);};function Cf(t,e){function n(){this.constructor=t;}wf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var Nf=new Ka(),Mf=(function(t){function e(e,n,i){void 0===n&&(n=100),void 0===i&&(i=100);var r=t.call(this,e)||this;return r.tileTransform=new ph(),r._width=n,r._height=i,r.uvMatrix=r.texture.uvMatrix||new Ol(e),r.pluginName="tilingSprite",r.uvRespectAnchor=!1,r;}Cf(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin;},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale;},set:function(t){this.tileTransform.scale.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position;},set:function(t){this.tileTransform.position.copyFrom(t);},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215;},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this));},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,i);},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Qa()),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e);},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,Nf);var e=this._width,n=this._height,i=-e*this.anchor._x;if(Nf.x>=i&&Nf.x<i+e){var r=-n*this.anchor._y;if(Nf.y>=r&&Nf.y<r+n)return!0;}return!1;},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null;},e.from=function(t,n){return new e(t instanceof Ru?t:Ru.from(t,n),n.width,n.height);},Object.defineProperty(e.prototype,"width",{get:function(){return this._width;},set:function(t){this._width=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height;},set:function(t){this._height=t;},enumerable:!1,configurable:!0});}(nf),"#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"),Pf=new rh(),Df=function(t){function e(e){var n=t.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new Uu(),n.state=xl.for2d(),n;}return Cf(e,t),e.prototype.contextChange=function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=bl.from(Mf,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?bl.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):bl.from(Mf,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e);},e.prototype.render=function(t){var e=this.renderer,n=this.quad,i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);var r=t.uvRespectAnchor?t.anchor.x:0,s=t.uvRespectAnchor?t.anchor.y:0;(i=n.uvs)[0]=i[6]=-r,i[1]=i[3]=-s,i[2]=i[4]=1-r,i[5]=i[7]=1-s,n.invalidate();var o=t._texture,a=o.baseTexture,h=t.tileTransform.localTransform,u=t.uvMatrix,l=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;l&&(a._glTextures[e.CONTEXT_UID]?l=a.wrapMode!==ra.CLAMP:a.wrapMode===ra.CLAMP&&(a.wrapMode=ra.REPEAT));var c=l?this.simpleShader:this.shader,d=o.width,p=o.height,f=t._width,_=t._height;Pf.set(h.a*d/f,h.b*d/_,h.c*p/f,h.d*p/_,h.tx/f,h.ty/_),Pf.invert(),l?Pf.prepend(u.mapCoord):(c.uniforms.uMapCoord=u.mapCoord.toArray(!0),c.uniforms.uClampFrame=u.uClampFrame,c.uniforms.uClampOffset=u.uClampOffset),c.uniforms.uTransform=Pf.toArray(!0),c.uniforms.uColor=wa(t.tint,t.worldAlpha,c.uniforms.uColor,a.alphaMode),c.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),c.uniforms.uSampler=o,e.shader.bind(c),e.geometry.bind(n),this.state.blendMode=Sa(t.blendMode,a.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0);},e;}(ju),Lf=function(t,e){return Lf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Lf(t,e);};function Ff(t,e){function n(){this.constructor=t;}Lf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var Uf=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0;}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++;}},t;}(),Bf=new Ka(),Gf=new eh(),kf=function(t){function e(e,n,i,r){void 0===r&&(r=Qo.TRIANGLES);var s=t.call(this)||this;return s.geometry=e,s.shader=n,s.state=i||xl.for2d(),s.drawMode=r,s.start=0,s.size=0,s.uvs=null,s.indices=null,s.vertexData=new Float32Array(1),s.vertexDirty=-1,s._transformID=-1,s._roundPixels=pa.ROUND_PIXELS,s.batchUvs=null,s;}return Ff(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry;},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1];},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0];},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader;},set:function(t){this.shader=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode;},set:function(t){this.state.blendMode=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels;},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null;},set:function(t){this.shader.tint=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null;},set:function(t){this.shader.texture=t;},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Qo.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t);},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount);},e.prototype._renderToBatch=function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this);},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,s=i.b,o=i.c,a=i.d,h=i.tx,u=i.ty,l=this.vertexData,c=0;c<l.length/2;c++){var d=e[2*c],p=e[2*c+1];l[2*c]=r*d+o*p+h,l[2*c+1]=s*d+a*p+u;}if(this._roundPixels){var f=pa.RESOLUTION;for(c=0;c<l.length;++c)l[c]=Math.round((l[c]*f|0)/f);}this.vertexDirty=n;}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new Uf(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data);},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length);},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,Bf);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=Gf.points,i=this.geometry.getIndex().data,r=i.length,s=4===this.drawMode?3:1,o=0;o+2<r;o+=s){var a=2*i[o],h=2*i[o+1],u=2*i[o+2];if(n[0]=e[a],n[1]=e[a+1],n[2]=e[h],n[3]=e[h+1],n[4]=e[u],n[5]=e[u+1],Gf.contains(Bf.x,Bf.y))return!0;}return!1;},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null;},e.BATCHABLE_SIZE=100,e;}(Gh),Xf=function(t){function e(e,n){var i=this,r={uSampler:e,alpha:1,uTextureMatrix:rh.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),(i=t.call(this,n.program||El.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r)||this)._colorDirty=!1,i.uvMatrix=new Ol(e),i.batchable=void 0===n.program,i.pluginName=n.pluginName,i.tint=n.tint,i.alpha=n.alpha,i;}return Ff(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler;},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha;},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint;},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0);},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;wa(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode);}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord);},e;}(bl),Vf=function(t){function e(e,n,i){var r=t.call(this)||this,s=new Cu(e),o=new Cu(n,!0),a=new Cu(i,!0,!0);return r.addAttribute("aVertexPosition",s,2,!1,ea.FLOAT).addAttribute("aTextureCoord",o,2,!1,ea.FLOAT).addIndex(a),r._updateId=-1,r;}return Ff(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID;},enumerable:!1,configurable:!0}),e;}(Lu),Hf=function(t,e){return Hf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Hf(t,e);},jf=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[];},Yf=function(){function t(){}return t.test=function(t){return"string"==typeof t&&0===t.indexOf("info face=");},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in e){var r=e[i].match(/^[a-z]+/gm)[0],s=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var a in s){var h=s[a].split("="),u=h[0],l=h[1].replace(/"/gm,""),c=parseFloat(l),d=isNaN(c)?l:c;o[u]=d;}n[r].push(o);}var p=new jf();return n.info.forEach(function(t){return p.info.push({face:t.face,size:parseInt(t.size,10)});}),n.common.forEach(function(t){return p.common.push({lineHeight:parseInt(t.lineHeight,10)});}),n.page.forEach(function(t){return p.page.push({id:parseInt(t.id,10),file:t.file});}),n.char.forEach(function(t){return p.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)});}),n.kerning.forEach(function(t){return p.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)});}),n.distanceField.forEach(function(t){return p.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType});}),p;},t;}(),Wf=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face");},t.parse=function(t){for(var e=new jf(),n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),s=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),a=t.getElementsByTagName("distanceField"),h=0;h<n.length;h++)e.info.push({face:n[h].getAttribute("face"),size:parseInt(n[h].getAttribute("size"),10)});for(h=0;h<i.length;h++)e.common.push({lineHeight:parseInt(i[h].getAttribute("lineHeight"),10)});for(h=0;h<r.length;h++)e.page.push({id:parseInt(r[h].getAttribute("id"),10)||0,file:r[h].getAttribute("file")});for(h=0;h<s.length;h++){var u=s[h];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)});}for(h=0;h<o.length;h++)e.kerning.push({first:parseInt(o[h].getAttribute("first"),10),second:parseInt(o[h].getAttribute("second"),10),amount:parseInt(o[h].getAttribute("amount"),10)});for(h=0;h<a.length;h++)e.distanceField.push({fieldType:a[h].getAttribute("fieldType"),distanceRange:parseInt(a[h].getAttribute("distanceRange"),10)});return e;},t;}(),zf=function(){function t(){}return t.test=function(t){if("string"==typeof t&&t.indexOf("<font>")>-1){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return Wf.test(e);}return!1;},t.parse=function(t){var e=new globalThis.DOMParser().parseFromString(t,"text/xml");return Wf.parse(e);},t;}(),qf=[Yf,Wf,zf];function Zf(t){for(var e=0;e<qf.length;e++)if(qf[e].test(t))return qf[e];return null;}function Kf(t,e,n,i,r,s,o){var a=n.text,h=n.fontProperties;e.translate(i,r),e.scale(s,s);var u=o.strokeThickness/2,l=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,n,i,r,s){var o,a=n.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];var h=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,l=t.width/i-h-2*u,c=t.height/i-h-2*u,d=a.slice(),p=n.fillGradientStops.slice();if(!p.length)for(var f=d.length+1,_=1;_<f;++_)p.push(_/f);if(d.unshift(a[0]),p.unshift(0),d.push(a[a.length-1]),p.push(1),n.fillGradientType===Up.LINEAR_VERTICAL){o=e.createLinearGradient(l/2,u,l/2,c+u);var m=0,g=(s.fontProperties.fontSize+n.strokeThickness)/c;for(_=0;_<r.length;_++)for(var v=s.lineHeight*_,y=0;y<d.length;y++){var T=v/c+("number"==typeof p[y]?p[y]:y/d.length)*g,E=Math.max(m,T);E=Math.min(E,1),o.addColorStop(E,d[y]),m=E;}}else{o=e.createLinearGradient(u,c/2,l+u,c/2);var b=d.length+1,x=1;for(_=0;_<d.length;_++){var A;A="number"==typeof p[_]?p[_]:x/b,o.addColorStop(A,d[_]),x++;}}return o;}(t,e,o,s,[a],n),e.strokeStyle=o.stroke,o.dropShadow){var c=o.dropShadowColor,d=xa("number"==typeof c?c:Ra(c)),p=o.dropShadowBlur*s,f=o.dropShadowDistance*s;e.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+o.dropShadowAlpha+")",e.shadowBlur=p,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*f;}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(a,u,l+n.lineHeight-h.descent),o.fill&&e.fillText(a,u,l+n.lineHeight-h.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)";}function $f(t){return Array.from?Array.from(t):t.split("");}function Qf(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0);}var Jf=function(){function t(t,e,n){var i,r,s=t.info[0],o=t.common[0],a=t.page[0],h=t.distanceField[0],u=Ya(a.file),l={};this._ownsTextures=n,this.font=s.face,this.size=s.size,this.lineHeight=o.lineHeight/u,this.chars={},this.pageTextures=l;for(var c=0;c<t.page.length;c++){var d=t.page[c],p=d.id,f=d.file;l[p]=e instanceof Array?e[c]:e[f],(null==h?void 0:h.fieldType)&&"none"!==h.fieldType&&(l[p].baseTexture.alphaMode=oa.NO_PREMULTIPLIED_ALPHA);}for(c=0;c<t.char.length;c++){var _=t.char[c],m=(p=_.id,_.page),g=t.char[c],v=g.x,y=g.y,T=g.width,E=g.height,b=g.xoffset,x=g.yoffset,A=g.xadvance;y/=u,T/=u,E/=u,b/=u,x/=u,A/=u;var R=new Qa((v/=u)+l[m].frame.x/u,y+l[m].frame.y/u,T,E);this.chars[p]={xOffset:b,yOffset:x,xAdvance:A,kerning:{},texture:new Ru(l[m].baseTexture,R),page:m};}for(c=0;c<t.kerning.length;c++){var O=t.kerning[c],S=O.first,I=O.second,w=O.amount;S/=u,I/=u,w/=u,this.chars[I]&&(this.chars[I].kerning[S]=w);}this.distanceFieldRange=null==h?void 0:h.distanceRange,this.distanceFieldType=null!==(r=null===(i=null==h?void 0:h.fieldType)||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"none";}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null;},t.install=function(e,n,i){var r;if(e instanceof jf)r=e;else{var s=Zf(e);if(!s)throw new Error("Unrecognized data format for font.");r=s.parse(e);}n instanceof Ru&&(n=[n]);var o=new t(r,n,i);return t.available[o.font]=o,o;},t.uninstall=function(e){var n=t.available[e];if(!n)throw new Error("No font found named '"+e+"'");n.destroy(),delete t.available[e];},t.from=function(e,n,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},t.defaultOptions,i),s=r.chars,o=r.padding,a=r.resolution,h=r.textureWidth,u=r.textureHeight,l=function(t){"string"==typeof t&&(t=[t]);for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var s=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<s)throw new Error("[BitmapFont]: Invalid character range.");for(var a=s,h=o;a<=h;a++)e.push(String.fromCharCode(a));}else e.push.apply(e,$f(r));}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e;}(s),c=n instanceof af?n:new af(n),d=h,p=new jf();p.info[0]={face:c.fontFamily,size:c.fontSize},p.common[0]={lineHeight:c.fontSize};for(var f,_,m,g=0,v=0,y=0,T=[],E=0;E<l.length;E++){f||((f=document.createElement("canvas")).width=h,f.height=u,_=f.getContext("2d"),m=new hu(f,{resolution:a}),T.push(new Ru(m)),p.page.push({id:T.length-1,file:""}));var b=cf.measureText(l[E],c,!1,f),x=b.width,A=Math.ceil(b.height),R=Math.ceil(("italic"===c.fontStyle?2:1)*x);if(v>=u-A*a){if(0===v)throw new Error("[BitmapFont] textureHeight "+u+"px is too small for "+c.fontSize+"px fonts");--E,f=null,_=null,m=null,v=0,g=0,y=0;}else if(y=Math.max(A+b.fontProperties.descent,y),R*a+g>=d)--E,v+=y*a,v=Math.ceil(v),g=0,y=0;else{Kf(f,_,b,g,v,a,c);var O=Qf(b.text);p.char.push({id:O,page:T.length-1,x:g/a,y:v/a,width:R,height:A,xoffset:0,yoffset:0,xadvance:Math.ceil(x-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),g+=(R+2*o)*a,g=Math.ceil(g);}}E=0;for(var S=l.length;E<S;E++)for(var I=l[E],w=0;w<S;w++){var C=l[w],N=_.measureText(I).width,M=_.measureText(C).width,P=_.measureText(I+C).width-(N+M);P&&p.kerning.push({first:Qf(I),second:Qf(C),amount:P});}var D=new t(p,T,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=D,D;},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t;}(),t_=[],e_=[],n_=[],i_=(function(t){function e(n,i){void 0===i&&(i={});var r=t.call(this)||this;r._tint=16777215;var s=Object.assign({},e.styleDefaults,i),o=s.align,a=s.tint,h=s.maxWidth,u=s.letterSpacing,l=s.fontName,c=s.fontSize;if(!Jf.available[l])throw new Error('Missing BitmapFont "'+l+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=o,r._tint=a,r._fontName=l,r._fontSize=c||Jf.available[l].size,r.text=n,r._maxWidth=h,r._maxLineHeight=0,r._letterSpacing=u,r._anchor=new ih(function(){r.dirty=!0;},r,0,0),r._roundPixels=pa.ROUND_PIXELS,r.dirty=!0,r._resolution=pa.RESOLUTION,r._autoResolution=!0,r._textureCache={},r;}(function(t,e){function n(){this.constructor=t;}Hf(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());})(e,t),e.prototype.updateText=function(){for(var t,e=Jf.available[this._fontName],n=this._fontSize/e.size,i=new Ka(),r=[],s=[],o=[],a=$f(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),h=this._maxWidth*e.size/this._fontSize,u="none"===e.distanceFieldType?t_:e_,l=null,c=0,d=0,p=0,f=-1,_=0,m=0,g=0,v=0,y=0;y<a.length;y++){var T=Qf(k=a[y]);if(/(?:\s)/.test(k)&&(f=y,_=c,v++),"\r"!==k&&"\n"!==k){var E=e.chars[T];if(E){l&&E.kerning[l]&&(i.x+=E.kerning[l]);var b=n_.pop()||{texture:Ru.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ka()};b.texture=E.texture,b.line=p,b.charCode=T,b.position.x=i.x+E.xOffset+this._letterSpacing/2,b.position.y=i.y+E.yOffset,b.prevSpaces=v,r.push(b),c=b.position.x+Math.max(E.xAdvance,E.texture.orig.width),i.x+=E.xAdvance+this._letterSpacing,g=Math.max(g,E.yOffset+E.texture.height),l=T,-1!==f&&h>0&&i.x>h&&(Da(r,1+f-++m,1+y-f),y=f,f=-1,s.push(_),o.push(r.length>0?r[r.length-1].prevSpaces:0),d=Math.max(d,_),p++,i.x=0,i.y+=e.lineHeight,l=null,v=0);}}else s.push(c),o.push(-1),d=Math.max(d,c),++p,++m,i.x=0,i.y+=e.lineHeight,l=null,v=0;}var x=a[a.length-1];"\r"!==x&&"\n"!==x&&(/(?:\s)/.test(x)&&(c=_),s.push(c),d=Math.max(d,c),o.push(-1));var A=[];for(y=0;y<=p;y++){var R=0;"right"===this._align?R=d-s[y]:"center"===this._align?R=(d-s[y])/2:"justify"===this._align&&(R=o[y]<0?0:(d-s[y])/o[y]),A.push(R);}var O=r.length,S={},I=[],w=this._activePagesMeshData;for(y=0;y<w.length;y++)u.push(w[y]);for(y=0;y<O;y++){var C=(V=r[y].texture).baseTexture.uid;if(!S[C]){if(!(Z=u.pop())){var N=new Vf(),M=void 0,P=void 0;"none"===e.distanceFieldType?(M=new Xf(Ru.EMPTY),P=$o.NORMAL):(M=new Xf(Ru.EMPTY,{program:El.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),P=$o.NORMAL_NPM);var D=new kf(N,M);D.blendMode=P,Z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:D,vertices:null,uvs:null,indices:null};}Z.index=0,Z.indexCount=0,Z.vertexCount=0,Z.uvsCount=0,Z.total=0;var L=this._textureCache;L[C]=L[C]||new Ru(V.baseTexture),Z.mesh.texture=L[C],Z.mesh.tint=this._tint,I.push(Z),S[C]=Z;}S[C].total++;}for(y=0;y<w.length;y++)-1===I.indexOf(w[y])&&this.removeChild(w[y].mesh);for(y=0;y<I.length;y++)I[y].mesh.parent!==this&&this.addChild(I[y].mesh);for(var y in this._activePagesMeshData=I,S){var F=(Z=S[y]).total;if(!((null===(t=Z.indices)||void 0===t?void 0:t.length)>6*F)||Z.vertices.length<2*kf.BATCHABLE_SIZE)Z.vertices=new Float32Array(8*F),Z.uvs=new Float32Array(8*F),Z.indices=new Uint16Array(6*F);else for(var U=Z.total,B=Z.vertices,G=4*U*2;G<B.length;G++)B[G]=0;Z.mesh.size=6*F;}for(y=0;y<O;y++){var k,X=(k=r[y]).position.x+A[k.line]*("justify"===this._align?k.prevSpaces:1);this._roundPixels&&(X=Math.round(X));var V,H=X*n,j=k.position.y*n,Y=S[(V=k.texture).baseTexture.uid],W=V.frame,z=V._uvs,q=Y.index++;Y.indices[6*q+0]=0+4*q,Y.indices[6*q+1]=1+4*q,Y.indices[6*q+2]=2+4*q,Y.indices[6*q+3]=0+4*q,Y.indices[6*q+4]=2+4*q,Y.indices[6*q+5]=3+4*q,Y.vertices[8*q+0]=H,Y.vertices[8*q+1]=j,Y.vertices[8*q+2]=H+W.width*n,Y.vertices[8*q+3]=j,Y.vertices[8*q+4]=H+W.width*n,Y.vertices[8*q+5]=j+W.height*n,Y.vertices[8*q+6]=H,Y.vertices[8*q+7]=j+W.height*n,Y.uvs[8*q+0]=z.x0,Y.uvs[8*q+1]=z.y0,Y.uvs[8*q+2]=z.x1,Y.uvs[8*q+3]=z.y1,Y.uvs[8*q+4]=z.x2,Y.uvs[8*q+5]=z.y2,Y.uvs[8*q+6]=z.x3,Y.uvs[8*q+7]=z.y3;}for(var y in this._textWidth=d*n,this._textHeight=(i.y+e.lineHeight)*n,S){var Z=S[y];if(0!==this.anchor.x||0!==this.anchor.y)for(var K=0,$=this._textWidth*this.anchor.x,Q=this._textHeight*this.anchor.y,J=0;J<Z.total;J++)Z.vertices[K++]-=$,Z.vertices[K++]-=Q,Z.vertices[K++]-=$,Z.vertices[K++]-=Q,Z.vertices[K++]-=$,Z.vertices[K++]-=Q,Z.vertices[K++]-=$,Z.vertices[K++]-=Q;this._maxLineHeight=g*n;var tt=Z.mesh.geometry.getBuffer("aVertexPosition"),et=Z.mesh.geometry.getBuffer("aTextureCoord"),nt=Z.mesh.geometry.getIndex();tt.data=Z.vertices,et.data=Z.uvs,nt.data=Z.indices,tt.update(),et.update(),nt.update();}for(y=0;y<r.length;y++)n_.push(r[y]);},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform();},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=Jf.available[this._fontName],i=n.distanceFieldRange,r=n.distanceFieldType,s=n.size;if("none"!==r)for(var o=this.worldTransform,a=o.a,h=o.b,u=o.c,l=o.d,c=Math.sqrt(a*a+h*h),d=Math.sqrt(u*u+l*l),p=(Math.abs(c)+Math.abs(d))/2,f=this._fontSize/s,_=0,m=this._activePagesMeshData;_<m.length;_++)m[_].mesh.shader.uniforms.uFWidth=p*i*f*this._resolution;t.prototype._render.call(this,e);},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this);},e.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1);},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint;},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t;}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align;},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName;},set:function(t){if(!Jf.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize;},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor;},set:function(t){"number"==typeof t?this._anchor.set(t):this._anchor.copyFrom(t);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text;},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth;},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing;},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels;},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0);},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution;},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0);},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var n=this._textureCache;for(var i in n)n[i].destroy(),delete n[i];this._textureCache=null,t.prototype.destroy.call(this,e);},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};}(Gh),function(){function t(){}return t.add=function(){Bd.setExtensionXhrType("fnt",Bd.XHR_RESPONSE_TYPE.TEXT);},t.use=function(e,n){var i=Zf(e.data);if(i)for(var r=t.getBaseUrl(this,e),s=i.parse(e.data),o={},a=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===s.page.length&&(e.bitmapFont=Jf.install(s,o,!0),n());},h=0;h<s.page.length;++h){var u=s.page[h].file,l=r+u,c=!1;for(var d in this.resources){var p=this.resources[d];if(p.url===l){p.metadata.pageFile=u,p.texture?a(p):p.onAfterMiddleware.add(a),c=!0;break;}}if(!c){var f={crossOrigin:e.crossOrigin,loadType:Bd.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(l,f,a);}}else n();},t.getBaseUrl=function(e,n){var i=n.isDataUrl?"":t.dirname(n.url);return n.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i;},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e;},t;}()),r_=function(t,e){return r_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},r_(t,e);},s_=function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n;}return function(t,e){function n(){this.constructor=t;}r_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha;},set:function(t){this.uniforms.uAlpha=t;},enumerable:!1,configurable:!0}),e;}(Al),o_=function(t,e){return o_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},o_(t,e);};function a_(t,e){function n(){this.constructor=t;}o_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var h_,u_,l_,c_,d_,p_,f_,__,m_,g_,v_,y_,T_,E_,b_,x_,A_,R_,O_,S_={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},I_=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(h_||(h_={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(u_||(u_={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(l_||(l_={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(c_||(c_={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(d_||(d_={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(p_||(p_={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(f_||(f_={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(__||(__={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(m_||(m_={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(g_||(g_={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(v_||(v_={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(y_||(y_={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(T_||(T_={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(E_||(E_={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(b_||(b_={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(x_||(x_={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(A_||(A_={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(R_||(R_={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}(O_||(O_={}));var w_=function(t){function e(e,n,i,r,s){void 0===n&&(n=8),void 0===i&&(i=4),void 0===r&&(r=pa.FILTER_RESOLUTION),void 0===s&&(s=5);var o=this,a=function(t,e){var n,i=Math.ceil(t/2),r="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",s="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var a=n.replace("%index%",o.toString());s+=a=a.replace("%sampleIndex%",o-(i-1)+".0"),s+="\n";}return(r=r.replace("%blur%",s)).replace("%size%",t.toString());}(s,e),h=function(t){for(var e,n=S_[t],i=n.length,r=I_,s="",o=0;o<t;o++){var a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());e=o,o>=i&&(e=t-o-1),s+=a=a.replace("%value%",n[e].toString()),s+="\n";}return(r=r.replace("%blur%",s)).replace("%size%",t.toString());}(s);return(o=t.call(this,a,h)||this).horizontal=e,o.resolution=r,o._quality=0,o.quality=i,o.blur=n,o;}return a_(e,t),e.prototype.apply=function(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,i);else{var r=t.getFilterTexture(),s=t.renderer,o=e,a=r;this.state.blend=!1,t.applyFilter(this,o,a,E_.CLEAR);for(var h=1;h<this.passes-1;h++){t.bindAndClear(o,E_.BLIT),this.uniforms.uSampler=a;var u=a;a=o,o=u,s.shader.bind(this),s.geometry.draw(5);}this.state.blend=!0,t.applyFilter(this,a,n,i),t.returnFilterTexture(r);}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength;},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality;},set:function(t){this._quality=t,this.passes=t;},enumerable:!1,configurable:!0}),e;}(Al),C_=function(t){function e(e,n,i,r){void 0===e&&(e=8),void 0===n&&(n=4),void 0===i&&(i=pa.FILTER_RESOLUTION),void 0===r&&(r=5);var s=t.call(this)||this;return s.blurXFilter=new w_(!0,e,n,i,r),s.blurYFilter=new w_(!1,e,n,i,r),s.resolution=i,s.quality=n,s.blur=e,s.repeatEdgePixels=!1,s;}return a_(e,t),e.prototype.apply=function(t,e,n,i){var r=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(r&&s){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,E_.CLEAR),this.blurYFilter.apply(t,o,n,i),t.returnFilterTexture(o);}else s?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i);},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength));},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur;},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality;},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur;},set:function(t){this.blurXFilter.blur=t,this.updatePadding();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur;},set:function(t){this.blurYFilter.blur=t,this.updatePadding();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode;},set:function(t){this.blurYFilter.blendMode=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels;},set:function(t){this._repeatEdgePixels=t,this.updatePadding();},enumerable:!1,configurable:!0}),e;}(Al),N_=function(t,e){return N_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},N_(t,e);},M_=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,tc,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e;}return function(t,e){function n(){this.constructor=t;}N_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n;},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t;},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e;},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e);},e.prototype.tint=function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e);},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e);},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t);},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=1/3,s=(0,Math.sqrt)(r),o=[n+(1-n)*r,r*(1-n)-s*i,r*(1-n)+s*i,0,0,r*(1-n)+s*i,n+r*(1-n),r*(1-n)-s*i,0,0,r*(1-n)-s*i,r*(1-n)+s*i,n+r*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e);},e.prototype.contrast=function(t,e){var n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e);},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,i=-.5*(n-1),r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e);},e.prototype.desaturate=function(){this.saturate(-1);},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t);},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t);},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t);},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t);},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t);},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t);},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t);},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t);},e.prototype.colorTone=function(t,e,n,i,r){var s=((n=n||16770432)>>16&255)/255,o=(n>>8&255)/255,a=(255&n)/255,h=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,l=(255&i)/255,c=[.3,.59,.11,0,0,s,o,a,t=t||.2,0,h,u,l,e=e||.15,0,s-h,o-u,a-l,0,0];this._loadMatrix(c,r);},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e);},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e);},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t);},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1);},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m;},set:function(t){this.uniforms.m=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha;},set:function(t){this.uniforms.uAlpha=t;},enumerable:!1,configurable:!0}),e;}(Al);M_.prototype.grayscale=M_.prototype.greyscale;var P_,D_,L_,F_,U_,B_,G_,k_,X_,V_,H_,j_,Y_,W_,z_,q_,Z_,K_,$_,Q_=function(t,e){return Q_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},Q_(t,e);},J_=function(t){function e(e,n){var i=this,r=new rh();return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=r,null==n&&(n=20),i.scale=new Ka(n,n),i;}return function(t,e){function n(){this.constructor=t;}Q_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e.prototype.apply=function(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var r=this.maskSprite.worldTransform,s=Math.sqrt(r.a*r.a+r.b*r.b),o=Math.sqrt(r.c*r.c+r.d*r.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=r.a/s,this.uniforms.rotation[1]=r.b/s,this.uniforms.rotation[2]=r.c/o,this.uniforms.rotation[3]=r.d/o),t.applyFilter(this,e,n,i);},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler;},set:function(t){this.uniforms.mapSampler=t;},enumerable:!1,configurable:!0}),e;}(Al),tm=function(t,e){return tm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},tm(t,e);},em=function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this;}return function(t,e){function n(){this.constructor=t;}tm(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),e;}(Al),nm=function(t,e){return nm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},nm(t,e);},im=function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var i=t.call(this,tc,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=n,i;}return function(t,e){function n(){this.constructor=t;}nm(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise;},set:function(t){this.uniforms.uNoise=t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed;},set:function(t){this.uniforms.uSeed=t;},enumerable:!1,configurable:!0}),e;}(Al);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2";}(P_||(P_={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS";}(D_||(D_={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL";}(L_||(L_={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR";}(F_||(F_={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN";}(U_||(U_={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL";}(B_||(B_={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z";}(G_||(G_={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT";}(k_||(k_={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT";}(X_||(X_={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR";}(V_||(V_={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT";}(H_||(H_={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL";}(j_||(j_={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA";}(Y_||(Y_={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT";}(W_||(W_={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL";}(z_||(z_={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp";}(q_||(q_={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE";}(Z_||(Z_={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH";}(K_||(K_={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER";}($_||($_={}));var rm=new rh();Fh.prototype._cacheAsBitmap=!1,Fh.prototype._cacheData=null,Fh.prototype._cacheAsBitmapResolution=null,Fh.prototype._cacheAsBitmapMultisample=K_.NONE;var sm=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null;};Object.defineProperties(Fh.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution;},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0));}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample;},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0));}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap;},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new sm()),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea));}}}),Fh.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t));},Fh.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;i.pad(r);}i.ceil(pa.RESOLUTION);var s=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),a=t.renderTexture.destinationFrame.clone(),h=t.projection.transform,u=Ou.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),l="cacheAsBitmap_"+Ua();this._cacheData.textureCacheId=l,hu.addToCache(u.baseTexture,l),Ru.addToCache(u,l);var c=this.transform.localTransform.copyTo(rm).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=h,t.renderTexture.bind(s,o,a),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var d=new nf(u);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-i.x/i.width,d.anchor.y=-i.y/i.height,d.alpha=n,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d);}},Fh.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t));},Fh.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var i=t.context,r=t._projTransform;e.ceil(pa.RESOLUTION);var s=Ou.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+Ua();this._cacheData.textureCacheId=o,hu.addToCache(s.baseTexture,o),Ru.addToCache(s,o);var a=rm;this.transform.localTransform.copyTo(a),a.invert(),a.tx-=e.x,a.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:s,clear:!0,transform:a,skipUpdateTransform:!1}),t.context=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var h=new nf(s);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-e.x/e.width,h.anchor.y=-e.y/e.height,h.alpha=n,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h);}},Fh.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID;},Fh.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null);},Fh.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,hu.removeFromCache(this._cacheData.textureCacheId),Ru.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null;},Fh.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t);},Fh.prototype.name=null,Gh.prototype.getChildByName=function(t,e){for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,i=this.children.length;n<i;n++)if(this.children[n].getChildByName){var r=this.children[n].getChildByName(t,!0);if(r)return r;}return null;},Fh.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Ka()),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t;};var om=function(t,e){return om=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},om(t,e);};function am(t,e){function n(){this.constructor=t;}om(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());}var hm=function(t){function e(e,n,i,r){void 0===e&&(e=100),void 0===n&&(n=100),void 0===i&&(i=10),void 0===r&&(r=10);var s=t.call(this)||this;return s.segWidth=i,s.segHeight=r,s.width=e,s.height=n,s.build(),s;}return am(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],i=[],r=this.segWidth-1,s=this.segHeight-1,o=this.width/r,a=this.height/s,h=0;h<t;h++){var u=h%this.segWidth,l=h/this.segWidth|0;e.push(u*o,l*a),n.push(u/r,l/s);}var c=r*s;for(h=0;h<c;h++){var d=h%r,p=h/r|0,f=p*this.segWidth+d,_=p*this.segWidth+d+1,m=(p+1)*this.segWidth+d,g=(p+1)*this.segWidth+d+1;i.push(f,_,m,_,g,m);}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update();},e;}(Vf),um=function(t){function e(e,n,i){void 0===e&&(e=200),void 0===i&&(i=0);var r=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return r.points=n,r._width=e,r.textureScale=i,r.build(),r;}return am(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width;},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var r=n.data,s=i.data;r[0]=0,r[1]=0,r[2]=0,r[3]=1;for(var o=0,a=t[0],h=this._width*this.textureScale,u=t.length,l=0;l<u;l++){var c=4*l;if(this.textureScale>0){var d=a.x-t[l].x,p=a.y-t[l].y,f=Math.sqrt(d*d+p*p);a=t[l],o+=f/h;}else o=l/(u-1);r[c]=o,r[c+1]=0,r[c+2]=o,r[c+3]=1;}var _=0;for(l=0;l<u-1;l++)c=2*l,s[_++]=c,s[_++]=c+1,s[_++]=c+2,s[_++]=c+2,s[_++]=c+1,s[_++]=c+3;n.update(),i.update(),this.updateVertices();}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],i=0,r=0,s=this.buffers[0].data,o=t.length,a=0;a<o;a++){var h=t[a],u=4*a;r=-((e=a<t.length-1?t[a+1]:h).x-n.x),i=e.y-n.y;var l=Math.sqrt(i*i+r*r),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=l,r/=l,i*=c,r*=c,s[u]=h.x+i,s[u+1]=h.y+r,s[u+2]=h.x-i,s[u+3]=h.y-r,n=h;}this.buffers[0].update();}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices();},e;}(Vf),lm=(function(t){function e(e,n,i){void 0===i&&(i=0);var r=this,s=new um(e.height,n,i),o=new Xf(e);return i>0&&(e.baseTexture.wrapMode=ra.REPEAT),(r=t.call(this,s,o)||this).autoUpdate=!0,r;}am(e,t),e.prototype._render=function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),t.prototype._render.call(this,e);};}(kf),function(t){function e(e,n,i){var r=this,s=new hm(e.width,e.height,n,i),o=new Xf(Ru.WHITE);return(r=t.call(this,s,o)||this).texture=e,r.autoResize=!0,r;}return am(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,i=e.height;!this.autoResize||t.width===n&&t.height===i||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build());},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture;},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this));},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e);},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e);},e;}(kf)),cm=(function(t){function e(e,n,i,r,s){void 0===e&&(e=Ru.EMPTY);var o=this,a=new Vf(n,i,r);a.getBuffer("aVertexPosition").static=!1;var h=new Xf(e);return(o=t.call(this,a,h,null,s)||this).autoUpdate=!0,o;}am(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data;},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t;},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e);};}(kf),function(t){function e(e,n,i,r,s){void 0===n&&(n=10),void 0===i&&(i=10),void 0===r&&(r=10),void 0===s&&(s=10);var o=t.call(this,Ru.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=n,o._rightWidth=r,o._topHeight=i,o._bottomHeight=s,o.texture=e,o;}am(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh();},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data;},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t;},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height;},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width;},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,i=this._height>n?1:this._height/n;return Math.min(e,i);},Object.defineProperty(e.prototype,"width",{get:function(){return this._width;},set:function(t){this._width=t,this._refresh();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height;},set:function(t){this._height=t,this._refresh();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth;},set:function(t){this._leftWidth=t,this._refresh();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth;},set:function(t){this._rightWidth=t,this._refresh();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight;},set:function(t){this._topHeight=t,this._refresh();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight;},set:function(t){this._bottomHeight=t,this._refresh();},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update();};}(lm),function(t,e){return cm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e;}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);},cm(t,e);});!function(t){function e(e,n){void 0===n&&(n=!0);var i=t.call(this,e[0]instanceof Ru?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=n,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i;}(function(t,e){function n(){this.constructor=t;}cm(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n());})(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(Hh.shared.remove(this.update,this),this._isConnectedToTicker=!1));},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(Hh.shared.add(this.update,this,kh.HIGH),this._isConnectedToTicker=!0));},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture();},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play();},e.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame];}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture());}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame));},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null;},e.fromFrames=function(t){for(var n=[],i=0;i<t.length;++i)n.push(Ru.from(t[i]));return new e(n);},e.fromImages=function(t){for(var n=[],i=0;i<t.length;++i)n.push(Ru.from(t[i]));return new e(n);},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures;},set:function(t){if(t[0]instanceof Ru)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time);}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture();},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing;},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate;},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Hh.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(Hh.shared.add(this.update,this),this._isConnectedToTicker=!0));},enumerable:!1,configurable:!0});}(nf),Jl.registerPlugin("accessibility",Xh),Jl.registerPlugin("extract",Id),Jl.registerPlugin("interaction",Qh),Jl.registerPlugin("particle",bp),Jl.registerPlugin("prepare",Of),Jl.registerPlugin("batch",lc),Jl.registerPlugin("tilingSprite",Df),jd.registerPlugin(i_),jd.registerPlugin(np),jd.registerPlugin(cp),jd.registerPlugin(mp),jd.registerPlugin(If),mc.registerPlugin(jh),mc.registerPlugin(zd);var dm={AlphaFilter:s_,BlurFilter:C_,BlurFilterPass:w_,ColorMatrixFilter:M_,DisplacementFilter:J_,FXAAFilter:em,NoiseFilter:im},pm=n(994),fm=n.n(pm),_m=n(795),mm=n.n(_m),gm=n(569),vm=n.n(gm),ym=n(565),Tm=n.n(ym),Em=n(216),bm=n.n(Em),xm=n(589),Am=n.n(xm),Rm=n(150),Om={};Om.styleTagTransform=Am(),Om.setAttributes=Tm(),Om.insert=vm().bind(null,"head"),Om.domAPI=mm(),Om.insertStyleElement=bm(),fm()(Rm.Z,Om),Rm.Z&&Rm.Z.locals&&Rm.Z.locals;let Sm,Im,wm,Cm=!1;!function(){const t=new mc({antialias:!0,resizeTo:window});document.body.appendChild(t.view),t.stage.interactive=!0;const e=new Qp();t.stage.addChild(e);let n=0;const i=new dm.BlurFilter();e.filters=[i];const r=new dm.ColorMatrixFilter();t.stage.filters=[r],window.app=t;let s=0;t.ticker.add(()=>{if(!0===Cm){n+=.2;const t=Math.cos(n);i.blur=Math.abs(Sm.getValue())*t,e.clear(),e.lineStyle(10*Math.abs(Sm.getValue()),16711680,1),e.beginFill(16776960,Math.abs(Sm.getValue())),e.moveTo(20*Math.sin(n)-120,20*Math.cos(n)-100),e.lineTo(120+20*Math.cos(n),20*Math.sin(n)-100),e.lineTo(120+20*Math.sin(n),100+20*Math.cos(n)),e.lineTo(20*Math.cos(n)-120,100+20*Math.sin(n)),e.lineTo(20*Math.sin(n)-120,20*Math.cos(n)-100),e.closePath(),e.rotation=n*(.001*Sm.getValue());const{matrix:o}=r;Im.getValue()>-24&&(e.x=.5*window.innerWidth+.1*Math.abs(Im.getValue()),e.y=.5*window.innerHeight+.1*Math.abs(Im.getValue()),s+=.1,o[1]=3*Math.sin(s),o[2]=Math.cos(s),o[3]=1.5*Math.cos(s),o[4]=2*Math.sin(s/3),o[5]=Math.sin(s/2),o[6]=Math.sin(s/4));}});}(),document.addEventListener("pointerdown",async()=>{!1===Cm&&(await Tr.resume(),console.log("audio is ready"),function(){const t=new Ms(500,"lowpass");Sm=new Vs(),wm=new as(),t.connect(Sm);const e=new Ms(5e3,"highpass");Im=new Vs(),e.connect(Im),new As("/media/lisene.mp3").connect(e).connect(t).toDestination().autostart=!0;}(),Cm=!0);});})();})();